# Password Manager Environment Variables
# Copy this file to .env and fill in your values

# =============================================================================
# Django Settings
# =============================================================================
# IMPORTANT: Set DEBUG=True for local development to:
#   - Disable HTTPS/SSL redirects (prevents redirect loops)
#   - Enable lenient rate limiting (30 auth requests/min vs 3/min in production)
#   - Show detailed error messages
#   - Use WSGI server instead of ASGI/Daphne
# Set DEBUG=False ONLY in production!
DEBUG=True

SECRET_KEY=your-secret-key-here-change-in-production
ALLOWED_HOSTS=localhost,127.0.0.1

# Database (PostgreSQL)
DB_NAME=password_manager
DB_USER=postgres
DB_PASSWORD=your-db-password
DB_HOST=localhost
DB_PORT=5432

# Redis (for Celery)
REDIS_URL=redis://localhost:6379/0

# Celery Configuration
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Email Settings (for notifications)
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-email-password
DEFAULT_FROM_EMAIL=noreply@yourpasswordmanager.com

# OAuth 2.0 Providers
GOOGLE_OAUTH_CLIENT_ID=your-google-client-id
GOOGLE_OAUTH_CLIENT_SECRET=your-google-client-secret
APPLE_OAUTH_CLIENT_ID=your-apple-client-id
APPLE_OAUTH_CLIENT_SECRET=your-apple-client-secret
APPLE_OAUTH_KEY_ID=your-apple-key-id
APPLE_OAUTH_TEAM_ID=your-apple-team-id
APPLE_OAUTH_PRIVATE_KEY=your-apple-private-key
GITHUB_OAUTH_CLIENT_ID=your-github-client-id
GITHUB_OAUTH_CLIENT_SECRET=your-github-client-secret

# =============================================================================
# OpenID Connect (OIDC) Enterprise SSO Providers
# =============================================================================
# Enable/disable OIDC features
OIDC_ENABLED=True

# Microsoft Azure AD / Entra ID (Enterprise SSO)
MICROSOFT_OAUTH_CLIENT_ID=your-microsoft-client-id
MICROSOFT_OAUTH_CLIENT_SECRET=your-microsoft-client-secret
MICROSOFT_TENANT_ID=common
# Use 'common' for multi-tenant, or your specific tenant ID for single-tenant

# Okta (Enterprise SSO)
OKTA_OAUTH_CLIENT_ID=your-okta-client-id
OKTA_OAUTH_CLIENT_SECRET=your-okta-client-secret
OKTA_DOMAIN=your-domain.okta.com

# Auth0 (Identity Platform)
AUTH0_CLIENT_ID=your-auth0-client-id
AUTH0_CLIENT_SECRET=your-auth0-client-secret
AUTH0_DOMAIN=your-domain.auth0.com

# Generic OIDC Provider (for custom enterprise SSO)
OIDC_CLIENT_ID=your-oidc-client-id
OIDC_CLIENT_SECRET=your-oidc-client-secret
OIDC_DISCOVERY_URL=https://your-idp.com/.well-known/openid-configuration
OIDC_SCOPES=openid profile email

# OIDC Security Settings
OIDC_NONCE_TTL=600
OIDC_STATE_TTL=600
OIDC_JWKS_CACHE_TTL=3600
OIDC_VERIFY_SSL=True
OIDC_CLOCK_SKEW_SECONDS=120
OIDC_CREATE_USER=True
OIDC_UPDATE_USER=True

# Authy (for MFA)
AUTHY_API_KEY=your-authy-api-key

# Push Notifications
FCM_API_KEY=your-fcm-api-key
GCM_API_KEY=your-gcm-api-key

# Firebase
FIREBASE_PROJECT_ID=your-firebase-project-id
FIREBASE_PRIVATE_KEY_ID=your-firebase-private-key-id
FIREBASE_PRIVATE_KEY=your-firebase-private-key
FIREBASE_CLIENT_EMAIL=your-firebase-client-email
FIREBASE_CLIENT_ID=your-firebase-client-id
FIREBASE_CLIENT_CERT_URL=your-firebase-client-cert-url
FIREBASE_DATABASE_URL=https://your-project-id.firebaseio.com

# GeoIP
GEOIP_PATH=/path/to/geoip/databases

# Security Settings
MAX_FAILED_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=30
SUSPICIOUS_THRESHOLD=3

# IP Whitelisting (Enterprise Feature)
IP_WHITELISTING_ENABLED=False
ALLOWED_IP_RANGES=192.168.1.0/24,10.0.0.0/8

# Rate Limiting
RATE_LIMIT_ANON=10/minute
RATE_LIMIT_USER=60/minute
RATE_LIMIT_AUTH=3/minute

# Performance Monitoring
STORE_PERFORMANCE_METRICS=True
STORE_API_METRICS=True
SLOW_REQUEST_THRESHOLD=1.0
QUERY_COUNT_THRESHOLD=50
CPU_WARNING_THRESHOLD=80
MEMORY_WARNING_THRESHOLD=80
DISK_WARNING_THRESHOLD=80
ERROR_RATE_THRESHOLD=5
PERFORMANCE_METRIC_RETENTION_DAYS=30
ERROR_LOG_RETENTION_DAYS=90
SYSTEM_METRIC_RETENTION_DAYS=7
ML_MODEL_TRAINING_INTERVAL=24
SYSTEM_MONITORING_INTERVAL=60

# ==============================================================================
# FIDO2/WebAuthn Passkey Configuration
# ==============================================================================

PASSKEY_RP_ID=localhost
PASSKEY_RP_NAME=Password Manager
PASSKEY_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# ==============================================================================
# Behavioral Recovery Settings (Phase 1)
# ==============================================================================

# Enable behavioral biometric recovery
BEHAVIORAL_RECOVERY_ENABLED=True

# Similarity threshold for behavioral matching (0-1)
# Default: 0.87 (87% similarity required)
BEHAVIORAL_SIMILARITY_THRESHOLD=0.87

# Recovery timeline in days (how long the recovery process takes)
# Default: 5 days
BEHAVIORAL_RECOVERY_DAYS=5

# Minimum samples required per challenge
BEHAVIORAL_MIN_SAMPLES_PER_CHALLENGE=50

# Differential privacy epsilon (privacy budget)
# Lower = more private, Higher = more accurate
# Default: 0.5
BEHAVIORAL_DIFFERENTIAL_PRIVACY_EPSILON=0.5

# ==============================================================================
# Post-Quantum Cryptography (Phase 2A)
# ==============================================================================

# Enable quantum-resistant encryption for behavioral commitments
QUANTUM_CRYPTO_ENABLED=True

# Quantum algorithm to use (Kyber768 recommended)
# Options: Kyber512, Kyber768, Kyber1024
QUANTUM_ALGORITHM=Kyber768

# Allow fallback to classical encryption if quantum unavailable
QUANTUM_FALLBACK_ENABLED=True

# ==============================================================================
# Blockchain Anchoring (Phase 2B.1)
# ==============================================================================

# Enable blockchain anchoring of behavioral commitments
# Set to True after deploying smart contract
BLOCKCHAIN_ENABLED=False

# Network selection: 'testnet' (Arbitrum Sepolia) or 'mainnet' (Arbitrum One)
BLOCKCHAIN_NETWORK=testnet

# Arbitrum RPC URLs
# Testnet (Arbitrum Sepolia)
ARBITRUM_TESTNET_RPC_URL=https://sepolia-rollup.arbitrum.io/rpc

# Mainnet (Arbitrum One)
ARBITRUM_MAINNET_RPC_URL=https://arb1.arbitrum.io/rpc

# Smart Contract Addresses (set after deployment)
# Deploy contract first using: cd contracts && npx hardhat run scripts/deploy.js --network arbitrumSepolia
COMMITMENT_REGISTRY_ADDRESS_TESTNET=0x...
COMMITMENT_REGISTRY_ADDRESS_MAINNET=0x...

# Deployer Wallet Private Key (KEEP SECRET! Use secure vault in production)
# Generate with: npx hardhat node (use one of the test accounts)
# Or create new: npx hardhat console -> (await ethers.Wallet.createRandom()).privateKey
BLOCKCHAIN_PRIVATE_KEY=0x...

# Batching Configuration
# Number of commitments per batch (optimal for gas costs)
BLOCKCHAIN_BATCH_SIZE=1000

# Auto-anchor interval (hours)
# How often to automatically anchor pending commitments
BLOCKCHAIN_BATCH_INTERVAL_HOURS=24

# Arbiscan API Key (for contract verification on block explorer)
# Get from: https://arbiscan.io/apis (testnet: https://sepolia.arbiscan.io/apis)
ARBISCAN_API_KEY=...

# ==============================================================================
# CELERY CONFIGURATION (Phase 2B.1)
# ==============================================================================
# Celery broker (Redis recommended for production, use RabbitMQ for enterprise)
# Install Redis: https://redis.io/download
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0
