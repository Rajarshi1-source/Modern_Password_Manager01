# ğŸ” SecureVault Password Manager

<div align="center">

**A Modern, Cross-Platform Password Manager with Advanced Security & AI-Powered Features**

![Version](https://img.shields.io/badge/version-2.4.0-blue.svg)
![Python](https://img.shields.io/badge/python-3.13-blue.svg)
![React](https://img.shields.io/badge/react-18.2.0-blue.svg)
![Django](https://img.shields.io/badge/django-4.2.26-green.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Build](https://img.shields.io/badge/build-passing-brightgreen.svg)
![Coverage](https://img.shields.io/badge/coverage-85%25-green.svg)

[Features](#-key-features) â€¢ [Architecture](#-system-architecture) â€¢ [Setup](#-quick-start) â€¢ [API](#-api-documentation) â€¢ [Security](#-security-features) â€¢ [Deployment](#-deployment)

</div>

---

## ğŸ“‹ Table of Contents

- [Overview](#-overview)
- [Key Features](#-key-features)
- [System Architecture](#-system-architecture)
- [Complete System Architecture Diagram](#-complete-system-architecture-diagram)
- [Authentication Flow Diagrams](#-authentication-flow-diagrams)
- [Data Flow Diagrams](#-data-flow-diagrams)
- [Entity Relationship Diagrams](#-entity-relationship-diagrams)
- [Zero-Knowledge Security Architecture](#-zero-knowledge-security-architecture)
- [Technology Stack](#-technology-stack)
- [Project Structure](#-project-structure)
- [Detailed Project Files Structure](#-detailed-project-files-structure)
- [Quick Start](#-quick-start)
- [Encryption & Decryption](#-encryption--decryption-mechanisms)
- [Client-Side Encryption](#-client-side-encryption)
- [CRYSTALS-Kyber Optimizations](#-crystals-kyber-optimizations)
- [Fully Homomorphic Encryption (FHE)](#-fully-homomorphic-encryption-fhe)
- [Backend Optimizations](#-backend-optimizations)
- [Authentication & Authorization](#-authentication--authorization)
- [Passkey Recovery System](#-passkey-recovery-system)
- [Master Password Recovery](#-master-password-recovery)
- [API Documentation](#-api-documentation)
- [Deployment](#-deployment)
- [File Descriptions](#-file-descriptions)
- [Contributing](#-contributing)
- [License](#-license)

---

## ğŸ¯ Overview

SecureVault is a **next-generation password manager** that combines cutting-edge security practices with artificial intelligence to provide unparalleled protection for your digital credentials. Built with a **zero-knowledge architecture**, your data is encrypted client-side, ensuring that even we cannot access your passwords.

### What Makes SecureVault Different?

| Feature | Description |
|---------|-------------|
| ğŸ§  **AI-Powered Security** | ML models for password strength prediction, anomaly detection, and threat analysis |
| ğŸ”’ **Zero-Knowledge** | Client-side encryption with WebCrypto API; server never sees plaintext data |
| ğŸš€ **Cross-Platform** | Web, Desktop (Windows/Mac/Linux), Mobile (iOS/Android), Browser Extensions |
| ğŸ”‘ **WebAuthn/Passkeys** | Modern passwordless authentication with biometric support |
| ğŸ›¡ï¸ **Post-Quantum Ready** | Optimized Kyber-768 with NTT acceleration (6-8x faster) |
| ğŸ” **FHE Encryption** | Fully Homomorphic Encryption for server-side computation on encrypted data |
| ğŸ”„ **Advanced Recovery** | Primary recovery key + Social mesh fallback with behavioral biometrics |
| â›“ï¸ **Blockchain Anchoring** | Immutable audit trail on Arbitrum Sepolia |
| âš¡ **Performance Optimized** | Multi-level caching, Gzip/Brotli compression, async operations |
| ğŸ” **Adaptive Security** | Device-aware Argon2id parameters (32-128MB based on capability) |
| ğŸ”— **OpenID Connect (OIDC)** | Enterprise SSO with Okta, Azure AD, Auth0, Google support |
| ğŸ¢ **Enterprise SSO** | SAML-like federation with ID token validation |

---

## âœ¨ Key Features

### ğŸ” Core Security Features

| Feature | Technology | Description |
|---------|------------|-------------|
| **End-to-End Encryption** | AES-GCM-256 + XChaCha20-Poly1305 | Dual cipher support with authenticated encryption |
| **Zero-Knowledge Architecture** | WebCrypto API + Client-side | Server never sees plaintext passwords |
| **Argon2id Key Derivation** | Adaptive Memory-hard KDF | 32-128MB memory with device capability detection |
| **Post-Quantum Cryptography** | CRYSTALS-Kyber-768 (Optimized) | NIST Level 3 quantum resistance with NTT acceleration |
| **Hybrid Encryption** | Kyber + X25519 | Defense in depth with combined shared secrets |
| **WebAuthn/FIDO2** | Passkey authentication | Hardware-backed passwordless login |
| **Multi-Factor Auth** | TOTP, SMS, Email, Push | Multiple 2FA options |
| **Biometric Auth** | Face, Voice, Fingerprint | Native biometric support |
| **Continuous Auth** | Behavioral biometrics | 247-dimensional behavioral DNA |
| **Hardware Security** | YubiKey compatible | Hardware key support |
| **FHE Operations** | Concrete-Python + TenSEAL | Server-side computation on encrypted data |
| **Adaptive FHE** | Intelligent routing | Auto-selects optimal FHE tier based on operation |
| **NTT Optimization** | NumPy vectorization | 6-8x faster Kyber polynomial operations |
| **Response Compression** | Gzip + Brotli | 10-50% network payload reduction |
| **Multi-Level Caching** | L1 Memory + L2 Redis | Sub-millisecond response times |

### ğŸ¤– Machine Learning Features

| Feature | Model | Description |
|---------|-------|-------------|
| **Password Strength** | LSTM Neural Network | Real-time strength prediction |
| **Anomaly Detection** | Isolation Forest + Random Forest | Session behavior analysis |
| **Threat Analysis** | CNN-LSTM Hybrid | Multi-vector threat detection |
| **Dark Web Monitoring** | BERT + Siamese Networks | Credential breach detection |
| **Behavioral Profiling** | Transformer (247-dim) | User behavior learning |
| **Smart Suggestions** | ML-powered | Context-aware recommendations |

### ğŸŒ Multi-Platform Support

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SECUREVAULT PLATFORMS                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Web App       â”‚   Desktop    â”‚   Mobile    â”‚   Browser Extension â”‚
â”‚   (React 18)    â”‚  (Electron)  â”‚   (Expo)    â”‚   (Manifest v3)     â”‚
â”‚                 â”‚              â”‚             â”‚                     â”‚
â”‚ â€¢ Vite bundler  â”‚ â€¢ Windows    â”‚ â€¢ iOS       â”‚ â€¢ Chrome            â”‚
â”‚ â€¢ TensorFlow.js â”‚ â€¢ macOS      â”‚ â€¢ Android   â”‚ â€¢ Firefox           â”‚
â”‚ â€¢ PWA support   â”‚ â€¢ Linux      â”‚ â€¢ Biometric â”‚ â€¢ Edge              â”‚
â”‚ â€¢ WebAuthn      â”‚ â€¢ Auto-lock  â”‚ â€¢ Push      â”‚ â€¢ Safari            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“¦ Data Management Features

- **Encrypted Vault Storage** - Secure credential storage
- **Automatic Backup & Restore** - Scheduled and on-demand backups
- **Cross-Device Sync** - Real-time synchronization
- **Import/Export** - LastPass, 1Password, Bitwarden, CSV support
- **Emergency Access** - Trusted contacts with waiting period
- **Shared Folders** - Team collaboration with RBAC
- **Folder Organization** - Nested folders, tags, favorites
- **Email Masking** - SimpleLogin, AnonAddy integration

---

## ğŸ—ï¸ System Architecture

### High-Level Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              CLIENT LAYER                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Web App     â”‚    Desktop    â”‚    Mobile     â”‚       Browser Extension       â”‚
â”‚   (React 18)   â”‚  (Electron)   â”‚ (React Native)â”‚        (Manifest v3)          â”‚
â”‚                â”‚               â”‚               â”‚                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ TensorFlow â”‚ â”‚ â”‚  Native   â”‚ â”‚ â”‚ Biometric â”‚ â”‚ â”‚  Auto-fill Engine           â”‚
â”‚ â”‚    .js     â”‚ â”‚ â”‚  Keychain â”‚ â”‚ â”‚   Auth    â”‚ â”‚ â”‚  Password Capture           â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚  Kyber-768 â”‚ â”‚ â”‚ Secure    â”‚ â”‚ â”‚   Push    â”‚ â”‚ â”‚  Context Menu               â”‚
â”‚ â”‚  (PQC)     â”‚ â”‚ â”‚ Storage   â”‚ â”‚ â”‚   Notif   â”‚ â”‚ â”‚  Form Detection             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                â”‚               â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                          HTTPS/TLS 1.3 + WSS
                                    â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚     NGINX GATEWAY     â”‚
                        â”‚  (Load Balancer/SSL)  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚                       â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Gunicorn    â”‚       â”‚    Daphne     â”‚       â”‚   Static      â”‚
    â”‚   (REST API)  â”‚       â”‚  (WebSockets) â”‚       â”‚   Files       â”‚
    â”‚   Port: 8000  â”‚       â”‚   Port: 8001  â”‚       â”‚   Port: 80    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                 DJANGO BACKEND                    â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Auth Module â”‚   Vault     â”‚  Security   â”‚   ML    â”‚
            â”‚             â”‚   Service   â”‚   Service   â”‚ Engine  â”‚
            â”‚ â€¢ JWT Auth  â”‚ â€¢ CRUD      â”‚ â€¢ Breach    â”‚ â€¢ LSTM  â”‚
            â”‚ â€¢ WebAuthn  â”‚ â€¢ Backup    â”‚   Monitor   â”‚ â€¢ CNN   â”‚
            â”‚ â€¢ OAuth 2.0 â”‚ â€¢ Sync      â”‚ â€¢ MFA       â”‚ â€¢ BERT  â”‚
            â”‚ â€¢ MFA       â”‚ â€¢ Folders   â”‚ â€¢ Audit     â”‚ â€¢ IF    â”‚
            â”‚ â€¢ Recovery  â”‚ â€¢ Sharing   â”‚ â€¢ Session   â”‚ â€¢ Siameseâ”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                   â”‚             â”‚             â”‚           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              â”‚             â”‚             â”‚           â”‚          â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”     â”‚
â”‚ Celeryâ”‚    â”‚ PostgreSQLâ”‚  â”‚  Redis  â”‚   â”‚ Channelsâ”‚  â”‚Arbitrumâ”‚     â”‚
â”‚Worker â”‚    â”‚    DB     â”‚  â”‚ Cache   â”‚   â”‚  Layer  â”‚  â”‚Sepolia â”‚     â”‚
â”‚       â”‚    â”‚           â”‚  â”‚         â”‚   â”‚         â”‚  â”‚        â”‚     â”‚
â”‚Tasks: â”‚    â”‚â€¢ Encryptedâ”‚  â”‚â€¢ Sessionâ”‚   â”‚â€¢ Breach â”‚  â”‚â€¢ Merkleâ”‚     â”‚
â”‚â€¢ Emailâ”‚    â”‚  Vault    â”‚  â”‚â€¢ Cache  â”‚   â”‚  Alerts â”‚  â”‚  Roots â”‚     â”‚
â”‚â€¢ ML   â”‚    â”‚â€¢ pgvector â”‚  â”‚â€¢ Broker â”‚   â”‚â€¢ RT Syncâ”‚  â”‚â€¢ Proofsâ”‚     â”‚
â”‚â€¢ Notifâ”‚    â”‚â€¢ Audit Logâ”‚  â”‚â€¢ Rate   â”‚   â”‚         â”‚  â”‚        â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                                                                      â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ºï¸ Complete System Architecture Diagram

### Full-Stack Architecture with All Components

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                          SECUREVAULT COMPLETE SYSTEM ARCHITECTURE                                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                                                                    â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CLIENT TIER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘
â•‘  â”‚                                                                                                     â”‚           â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚           â•‘
â•‘  â”‚  â”‚    WEB APP          â”‚  â”‚    DESKTOP APP      â”‚  â”‚    MOBILE APP       â”‚  â”‚  BROWSER EXTENSION  â”‚â”‚           â•‘
â•‘  â”‚  â”‚    (React 18)       â”‚  â”‚    (Electron)       â”‚  â”‚  (React Native)     â”‚  â”‚   (Manifest v3)     â”‚â”‚           â•‘
â•‘  â”‚  â”‚                     â”‚  â”‚                     â”‚  â”‚                     â”‚  â”‚                     â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ SecureVaultCryptoâ”‚ â”‚  â”‚ â”‚  Native Keychainâ”‚ â”‚  â”‚ â”‚ Biometric Auth  â”‚ â”‚  â”‚ â”‚ Autofill Engine â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ AES-256-GCM    â”‚ â”‚  â”‚ â”‚ â€¢ Secure Storageâ”‚ â”‚  â”‚ â”‚ â€¢ Face ID       â”‚ â”‚  â”‚ â”‚ â€¢ Form Detect   â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ Argon2id KDF   â”‚ â”‚  â”‚ â”‚ â€¢ Auto-Lock     â”‚ â”‚  â”‚ â”‚ â€¢ Touch ID      â”‚ â”‚  â”‚ â”‚ â€¢ Pwd Capture   â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ WebCrypto API  â”‚ â”‚  â”‚ â”‚ â€¢ IPC Secure    â”‚ â”‚  â”‚ â”‚ â€¢ Push Notifs   â”‚ â”‚  â”‚ â”‚ â€¢ Context Menu  â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚           â•‘
â•‘  â”‚  â”‚                     â”‚  â”‚                     â”‚  â”‚                     â”‚  â”‚                     â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ Kyber Service   â”‚ â”‚  â”‚ â”‚ Local DB        â”‚ â”‚  â”‚ â”‚ Expo SecureStoreâ”‚ â”‚  â”‚ â”‚ Secure Storage  â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ Kyber-768     â”‚ â”‚  â”‚ â”‚ â€¢ SQLite        â”‚ â”‚  â”‚ â”‚ â€¢ Encrypted     â”‚ â”‚  â”‚ â”‚ â€¢ chrome.storageâ”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ X25519 Hybrid â”‚ â”‚  â”‚ â”‚ â€¢ Auto-sync     â”‚ â”‚  â”‚ â”‚ â€¢ Keychain      â”‚ â”‚  â”‚ â”‚ â€¢ Local Only    â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ WASM Module   â”‚ â”‚  â”‚ â”‚ â€¢ Conflict Res  â”‚ â”‚  â”‚ â”‚ â€¢ Biometric Key â”‚ â”‚  â”‚ â”‚ â€¢ CSP Headers   â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚           â•‘
â•‘  â”‚  â”‚                     â”‚  â”‚                     â”‚  â”‚                     â”‚  â”‚                     â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ FHE Client      â”‚ â”‚  â”‚              SHARED SERVICES LAYER              â”‚ â”‚ â”‚ Pwd Generator   â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ TFHE-rs WASM  â”‚ â”‚  â”‚  â€¢ IndexedDB Cache  â€¢ Web Workers              â”‚ â”‚ â”‚ â€¢ Secure Random â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ Key Gen       â”‚ â”‚  â”‚  â€¢ Service Workers  â€¢ Behavioral Capture       â”‚ â”‚ â”‚ â€¢ Policy Based  â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â”‚ â€¢ Encrypt/Dec   â”‚ â”‚  â”‚  â€¢ TensorFlow.js    â€¢ Real-time Sync           â”‚ â”‚ â”‚ â€¢ Entropy Check â”‚ â”‚â”‚           â•‘
â•‘  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚           â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚           â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘
â•‘                                                        â”‚                                                            â•‘
â•‘                                                        â”‚ HTTPS/TLS 1.3 + WebSocket Secure                          â•‘
â•‘                                                        â–¼                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GATEWAY TIER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â•‘
â•‘  â”‚                                                                                                    â”‚             â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚             â•‘
â•‘  â”‚  â”‚                                   NGINX REVERSE PROXY                                         â”‚ â”‚             â•‘
â•‘  â”‚  â”‚  â€¢ SSL/TLS Termination (Let's Encrypt)  â€¢ Rate Limiting (100 req/min)                        â”‚ â”‚             â•‘
â•‘  â”‚  â”‚  â€¢ Load Balancing (Round Robin)         â€¢ Gzip/Brotli Compression                           â”‚ â”‚             â•‘
â•‘  â”‚  â”‚  â€¢ WebSocket Upgrade Support            â€¢ Security Headers (CSP, HSTS)                       â”‚ â”‚             â•‘
â•‘  â”‚  â”‚  â€¢ Static File Caching (365 days)       â€¢ Request Buffering & Timeout                       â”‚ â”‚             â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚             â•‘
â•‘  â”‚                                                                                                    â”‚             â•‘
â•‘  â”‚         â”‚                                       â”‚                                     â”‚           â”‚             â•‘
â•‘  â”‚         â–¼                                       â–¼                                     â–¼           â”‚             â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚             â•‘
â•‘  â”‚  â”‚  Gunicorn       â”‚                    â”‚    Daphne       â”‚                   â”‚  Static Files   â”‚ â”‚             â•‘
â•‘  â”‚  â”‚  REST API       â”‚                    â”‚   WebSockets    â”‚                   â”‚  CDN Ready      â”‚ â”‚             â•‘
â•‘  â”‚  â”‚  Port: 8000     â”‚                    â”‚   Port: 8001    â”‚                   â”‚  Port: 80/443   â”‚ â”‚             â•‘
â•‘  â”‚  â”‚  Workers: 4     â”‚                    â”‚   Workers: 2    â”‚                   â”‚  Cache: 1 year  â”‚ â”‚             â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚             â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â•‘
â•‘                                                        â”‚                                                            â•‘
â•‘                                                        â–¼                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ APPLICATION TIER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â•‘
â•‘  â”‚                                                                                                    â”‚             â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ DJANGO BACKEND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚             â•‘
â•‘  â”‚  â”‚                                                                                                â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚   AUTH MODULE    â”‚  â”‚   VAULT SERVICE  â”‚  â”‚ SECURITY SERVICE â”‚  â”‚   FHE SERVICE    â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ JWT Tokens     â”‚  â”‚ â€¢ CRUD Ops       â”‚  â”‚ â€¢ Breach Monitor â”‚  â”‚ â€¢ Concrete-Py    â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ WebAuthn/FIDO2 â”‚  â”‚ â€¢ Backup/Restore â”‚  â”‚ â€¢ Device Trust   â”‚  â”‚ â€¢ TenSEAL SEAL   â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ OAuth 2.0      â”‚  â”‚ â€¢ Sync Engine    â”‚  â”‚ â€¢ Login Tracking â”‚  â”‚ â€¢ FHE Router     â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ MFA (TOTP/Push)â”‚  â”‚ â€¢ Folder Mgmt    â”‚  â”‚ â€¢ Alert System   â”‚  â”‚ â€¢ Adaptive Depth â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Kyber Crypto   â”‚  â”‚ â€¢ Shared Folders â”‚  â”‚ â€¢ Dark Web Scan  â”‚  â”‚ â€¢ Computation    â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Recovery Flows â”‚  â”‚ â€¢ Import/Export  â”‚  â”‚ â€¢ Audit Logging  â”‚  â”‚   Cache (Redis)  â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”‚             â•‘
â•‘  â”‚  â”‚           â”‚                     â”‚                     â”‚                     â”‚                 â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ BEHAVIORAL       â”‚  â”‚   ML SECURITY    â”‚  â”‚   BLOCKCHAIN     â”‚  â”‚  EMAIL MASKING   â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ RECOVERY         â”‚  â”‚                  â”‚  â”‚   ANCHORING      â”‚  â”‚                  â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚                  â”‚  â”‚ â€¢ LSTM Strength  â”‚  â”‚                  â”‚  â”‚ â€¢ SimpleLogin    â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ 247-dim DNA    â”‚  â”‚ â€¢ CNN-LSTM Threatâ”‚  â”‚ â€¢ Merkle Trees   â”‚  â”‚ â€¢ AnonAddy       â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Trust Scoring  â”‚  â”‚ â€¢ Isolation For. â”‚  â”‚ â€¢ Web3.py        â”‚  â”‚ â€¢ Alias Creation â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Temporal Chal. â”‚  â”‚ â€¢ BERT Breach    â”‚  â”‚ â€¢ Arbitrum L2    â”‚  â”‚ â€¢ Activity Track â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Guardian Mesh  â”‚  â”‚ â€¢ Siamese Similarâ”‚  â”‚ â€¢ ZK Proofs      â”‚  â”‚ â€¢ Provider Mgmt  â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”‚             â•‘
â•‘  â”‚  â”‚                                                                                                â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚                               MIDDLEWARE STACK                                              â”‚â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚  â€¢ VaultCompressionMiddleware (Gzip/Brotli)  â€¢ SecurityHeadersMiddleware (CSP, HSTS)      â”‚â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚  â€¢ CacheControlMiddleware                    â€¢ PerformanceMiddleware (Timing)             â”‚â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚  â€¢ CORSMiddleware                            â€¢ RateLimitMiddleware                        â”‚â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚             â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚             â•‘
â•‘  â”‚                                                                                                    â”‚             â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ BACKGROUND WORKERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚             â•‘
â•‘  â”‚  â”‚                                                                                                â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ CELERY WORKER 1  â”‚  â”‚ CELERY WORKER 2  â”‚  â”‚   CELERY BEAT    â”‚  â”‚  CHANNELS WORKER â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚   (Scheduler)    â”‚  â”‚                  â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Email Tasks    â”‚  â”‚ â€¢ ML Inference   â”‚  â”‚                  â”‚  â”‚ â€¢ Breach Alerts  â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Export Prep    â”‚  â”‚ â€¢ Breach Check   â”‚  â”‚ â€¢ Hourly Cleanup â”‚  â”‚ â€¢ Real-time Sync â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Audit Process  â”‚  â”‚ â€¢ Stats Compute  â”‚  â”‚ â€¢ Daily Audits   â”‚  â”‚ â€¢ Live Updates   â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â”‚ â€¢ Cache Warming  â”‚  â”‚ â€¢ Blockchain Tx  â”‚  â”‚ â€¢ Weekly Purge   â”‚  â”‚ â€¢ Notifications  â”‚       â”‚â”‚             â•‘
â•‘  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”‚             â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚             â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â•‘
â•‘                                                        â”‚                                                            â•‘
â•‘                                                        â–¼                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ DATA TIER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â•‘
â•‘  â”‚                                                                                                    â”‚             â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚             â•‘
â•‘  â”‚  â”‚   POSTGRESQL     â”‚  â”‚     REDIS        â”‚  â”‚   ELASTICSEARCH  â”‚  â”‚   BLOCKCHAIN     â”‚           â”‚             â•‘
â•‘  â”‚  â”‚   (Primary DB)   â”‚  â”‚  (Cache/Broker)  â”‚  â”‚   (Optional)     â”‚  â”‚   (Arbitrum L2)  â”‚           â”‚             â•‘
â•‘  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚           â”‚             â•‘
â•‘  â”‚  â”‚ â€¢ User Accounts  â”‚  â”‚ â€¢ Session Cache  â”‚  â”‚ â€¢ Full-text      â”‚  â”‚ â€¢ Commitment     â”‚           â”‚             â•‘
â•‘  â”‚  â”‚ â€¢ Encrypted Vaultâ”‚  â”‚ â€¢ Rate Limiting  â”‚  â”‚   Search         â”‚  â”‚   Anchors        â”‚           â”‚             â•‘
â•‘  â”‚  â”‚ â€¢ Kyber Keys     â”‚  â”‚ â€¢ Celery Broker  â”‚  â”‚ â€¢ Audit Logs     â”‚  â”‚ â€¢ Merkle Roots   â”‚           â”‚             â•‘
â•‘  â”‚  â”‚ â€¢ FHE Keys/Cache â”‚  â”‚ â€¢ Real-time Pub  â”‚  â”‚ â€¢ ML Vector      â”‚  â”‚ â€¢ ZK Proofs      â”‚           â”‚             â•‘
â•‘  â”‚  â”‚ â€¢ Behavioral DNA â”‚  â”‚ â€¢ L1/L2 Cache    â”‚  â”‚   Store (pgvec)  â”‚  â”‚ â€¢ Verification   â”‚           â”‚             â•‘
â•‘  â”‚  â”‚ â€¢ Audit Logs     â”‚  â”‚ â€¢ FHE Result     â”‚  â”‚                  â”‚  â”‚                  â”‚           â”‚             â•‘
â•‘  â”‚  â”‚ â€¢ Recovery Data  â”‚  â”‚   Cache          â”‚  â”‚                  â”‚  â”‚                  â”‚           â”‚             â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚             â•‘
â•‘  â”‚                                                                                                    â”‚             â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â•‘
â•‘                                                                                                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Component Communication Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           COMPONENT COMMUNICATION PROTOCOLS                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Source        â”‚      Target         â”‚    Protocol       â”‚      Purpose            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Web App            â”‚ NGINX Gateway       â”‚ HTTPS/TLS 1.3     â”‚ API requests            â”‚
â”‚ Web App            â”‚ Daphne              â”‚ WSS               â”‚ Real-time breach alerts â”‚
â”‚ NGINX              â”‚ Gunicorn            â”‚ HTTP (internal)   â”‚ REST API proxy          â”‚
â”‚ NGINX              â”‚ Daphne              â”‚ WebSocket         â”‚ WS proxy                â”‚
â”‚ Django             â”‚ PostgreSQL          â”‚ TCP/5432          â”‚ Data persistence        â”‚
â”‚ Django             â”‚ Redis               â”‚ TCP/6379          â”‚ Cache/Celery broker     â”‚
â”‚ Celery Worker      â”‚ Redis               â”‚ AMQP              â”‚ Task queue              â”‚
â”‚ Celery Worker      â”‚ PostgreSQL          â”‚ TCP/5432          â”‚ Task results            â”‚
â”‚ Django             â”‚ Arbitrum RPC        â”‚ HTTPS/JSON-RPC    â”‚ Blockchain anchoring    â”‚
â”‚ FHE Service        â”‚ Redis               â”‚ TCP/6379          â”‚ Computation cache       â”‚
â”‚ ML Service         â”‚ TensorFlow Serving  â”‚ gRPC (optional)   â”‚ Model inference         â”‚
â”‚ Channels           â”‚ Redis               â”‚ TCP/6379          â”‚ Channel layer           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DATA FLOW DIAGRAM                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   USER                    CLIENT                    SERVER                DB
    â”‚                        â”‚                         â”‚                    â”‚
    â”‚  Enter Password        â”‚                         â”‚                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚                    â”‚
    â”‚                        â”‚                         â”‚                    â”‚
    â”‚                        â”‚  Argon2id KDF           â”‚                    â”‚
    â”‚                        â”‚  (64MB, 3 iter)         â”‚                    â”‚
    â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                    â”‚
    â”‚                        â”‚                 â”‚       â”‚                    â”‚
    â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                    â”‚
    â”‚                        â”‚  256-bit Key            â”‚                    â”‚
    â”‚                        â”‚                         â”‚                    â”‚
    â”‚                        â”‚  AES-GCM-256 Encrypt    â”‚                    â”‚
    â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                    â”‚
    â”‚                        â”‚                 â”‚       â”‚                    â”‚
    â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                    â”‚
    â”‚                        â”‚  Encrypted Blob         â”‚                    â”‚
    â”‚                        â”‚                         â”‚                    â”‚
    â”‚                        â”‚  HTTPS POST (JWT)       â”‚                    â”‚
    â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚                        â”‚                         â”‚                    â”‚
    â”‚                        â”‚                         â”‚  Store Blob       â”‚
    â”‚                        â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                        â”‚                         â”‚                    â”‚
    â”‚                        â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                        â”‚                         â”‚  OK                â”‚
    â”‚                        â”‚                         â”‚                    â”‚
    â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
    â”‚                        â”‚  Success Response       â”‚                    â”‚
    â”‚                        â”‚                         â”‚                    â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚                    â”‚
    â”‚  Confirmation          â”‚                         â”‚                    â”‚
    â”‚                        â”‚                         â”‚                    â”‚

    âœ“ Server NEVER sees plaintext
    âœ“ Keys derived client-side only
    âœ“ Zero-knowledge architecture
```

---

## ğŸ” Authentication Flow Diagrams

### Complete Authentication State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AUTHENTICATION STATE MACHINE                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                      â”‚
â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚                                      â”‚   START     â”‚                                                â”‚
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                â”‚
â”‚                                             â”‚                                                        â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚                     â–¼                       â–¼                       â–¼                               â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚            â”‚ Password + MFA  â”‚     â”‚    WebAuthn     â”‚     â”‚   OAuth 2.0 /   â”‚                      â”‚
â”‚            â”‚     Flow        â”‚     â”‚   (Passkey)     â”‚     â”‚   OIDC (SSO)    â”‚                      â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                     â”‚                       â”‚                       â”‚                                â”‚
â”‚                     â”‚                       â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                     â”‚                       â”‚              â–¼                 â–¼                       â”‚
â”‚                     â”‚                       â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚                     â”‚                       â”‚     â”‚OAuth 2.0    â”‚   â”‚OpenID       â”‚                 â”‚
â”‚                     â”‚                       â”‚     â”‚(Google/     â”‚   â”‚Connect      â”‚                 â”‚
â”‚                     â”‚                       â”‚     â”‚GitHub/Apple)â”‚   â”‚(Okta/Azure) â”‚                 â”‚
â”‚                     â”‚                       â”‚     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                     â”‚                       â”‚            â”‚                 â”‚                        â”‚
â”‚                     â–¼                       â–¼            â–¼                 â–¼                        â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚            â”‚                    IDENTITY VERIFICATION                          â”‚                     â”‚
â”‚            â”‚                                                                   â”‚                     â”‚
â”‚            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                     â”‚
â”‚            â”‚  â”‚  Verify    â”‚ â”‚  Verify    â”‚ â”‚  Verify    â”‚ â”‚  Validate  â”‚     â”‚                     â”‚
â”‚            â”‚  â”‚ Credentialsâ”‚ â”‚ Signature  â”‚ â”‚ OAuth Tokenâ”‚ â”‚  ID Token  â”‚     â”‚                     â”‚
â”‚            â”‚  â”‚ (Argon2id) â”‚ â”‚ (WebAuthn) â”‚ â”‚ (Access)   â”‚ â”‚  (JWKS)    â”‚     â”‚                     â”‚
â”‚            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                     â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                              â”‚                                                       â”‚
â”‚                                              â–¼                                                       â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                  â”‚                  MFA CHECK                               â”‚                        â”‚
â”‚                  â”‚                                                          â”‚                        â”‚
â”‚                  â”‚    Is MFA required for this user/device?                â”‚                        â”‚
â”‚                  â”‚                                                          â”‚                        â”‚
â”‚                  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                        â”‚
â”‚                  â”‚         â”‚   YES   â”‚         â”‚   NO    â”‚                 â”‚                        â”‚
â”‚                  â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â”‚                        â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                 â”‚                  â”‚                                                 â”‚
â”‚                                 â–¼                  â”‚                                                 â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                  â”‚                 MFA VERIFICATION                         â”‚                        â”‚
â”‚                  â”‚                                                          â”‚                        â”‚
â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                        â”‚
â”‚                  â”‚  â”‚   TOTP   â”‚ â”‚   SMS    â”‚ â”‚   Push   â”‚ â”‚ Biometricâ”‚   â”‚                        â”‚
â”‚                  â”‚  â”‚  6-digit â”‚ â”‚   Code   â”‚ â”‚  Notif   â”‚ â”‚Face/Voiceâ”‚   â”‚                        â”‚
â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                        â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                              â”‚                                                       â”‚
â”‚                                              â–¼                                                       â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                  â”‚               DEVICE TRUST CHECK                         â”‚                        â”‚
â”‚                  â”‚                                                          â”‚                        â”‚
â”‚                  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                        â”‚
â”‚                  â”‚    â”‚  Is this device trusted?                   â”‚       â”‚                        â”‚
â”‚                  â”‚    â”‚                                            â”‚       â”‚                        â”‚
â”‚                  â”‚    â”‚  Check: Device ID, Fingerprint, Location   â”‚       â”‚                        â”‚
â”‚                  â”‚    â”‚  Risk Score, Behavioral Pattern            â”‚       â”‚                        â”‚
â”‚                  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                        â”‚
â”‚                  â”‚                                                          â”‚                        â”‚
â”‚                  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                        â”‚
â”‚                  â”‚         â”‚ Trusted â”‚              â”‚ Untrusted â”‚          â”‚                        â”‚
â”‚                  â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚                        â”‚
â”‚                  â”‚              â”‚                         â”‚                â”‚                        â”‚
â”‚                  â”‚              â”‚                         â–¼                â”‚                        â”‚
â”‚                  â”‚              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                        â”‚
â”‚                  â”‚              â”‚         â”‚ Send Security Alert    â”‚       â”‚                        â”‚
â”‚                  â”‚              â”‚         â”‚ Request Device Trust   â”‚       â”‚                        â”‚
â”‚                  â”‚              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                        â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                 â”‚                      â”‚                                             â”‚
â”‚                                 â–¼                      â–¼                                             â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                  â”‚                    SESSION CREATION                      â”‚                        â”‚
â”‚                  â”‚                                                          â”‚                        â”‚
â”‚                  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                        â”‚
â”‚                  â”‚    â”‚  Generate JWT Tokens                           â”‚   â”‚                        â”‚
â”‚                  â”‚    â”‚  â€¢ Access Token  (15 min TTL)                  â”‚   â”‚                        â”‚
â”‚                  â”‚    â”‚  â€¢ Refresh Token (7 days TTL)                  â”‚   â”‚                        â”‚
â”‚                  â”‚    â”‚  â€¢ Device binding                              â”‚   â”‚                        â”‚
â”‚                  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                        â”‚
â”‚                  â”‚                                                          â”‚                        â”‚
â”‚                  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                        â”‚
â”‚                  â”‚    â”‚  Create Audit Log Entry                        â”‚   â”‚                        â”‚
â”‚                  â”‚    â”‚  â€¢ IP Address, User Agent                      â”‚   â”‚                        â”‚
â”‚                  â”‚    â”‚  â€¢ Device Fingerprint                          â”‚   â”‚                        â”‚
â”‚                  â”‚    â”‚  â€¢ Geolocation                                 â”‚   â”‚                        â”‚
â”‚                  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                        â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                              â”‚                                                       â”‚
â”‚                                              â–¼                                                       â”‚
â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚                                      â”‚ AUTHENTICATEDâ”‚                                                â”‚
â”‚                                      â”‚   SESSION   â”‚                                                â”‚
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â”‚
â”‚                                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### OAuth 2.0 + Social Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              OAUTH 2.0 SOCIAL LOGIN FLOW                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚    USER              CLIENT              BACKEND           OAUTH PROVIDER               â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  Click "Login    â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  with Google"    â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  GET /auth/oauth/  â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  google/?action=   â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  redirect          â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Generate state,   â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  PKCE verifier     â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  302 Redirect to   â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  Google OAuth URL  â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  Redirect to Google                   â”‚                    â”‚                       â”‚
â”‚     â”‚                                       â”‚                    â”‚                       â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
â”‚     â”‚  Login with Google credentials                            â”‚                       â”‚
â”‚     â”‚                                       â”‚                    â”‚                       â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
â”‚     â”‚  Authorization Code + State           â”‚                    â”‚                       â”‚
â”‚     â”‚                                       â”‚                    â”‚                       â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  Callback URL    â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  with code+state â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  POST /oauth/googleâ”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  {code, state}     â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Verify state      â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Exchange code     â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  for tokens        â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Access Token +    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  ID Token          â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Fetch user info   â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  {email, name,     â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚   picture}         â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Create/Link User  â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Generate JWT      â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  {access_token,    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚   refresh_token,   â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚   user_info}       â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  Authenticated!   â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚                                                                                          â”‚
â”‚  SUPPORTED PROVIDERS:                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚  â”‚ Google â”‚ â”‚ GitHub â”‚ â”‚ Apple  â”‚ â”‚Microsoft â”‚                                         â”‚
â”‚  â”‚  âœ“     â”‚ â”‚   âœ“    â”‚ â”‚   âœ“    â”‚ â”‚ (coming) â”‚                                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### OpenID Connect (OIDC) Enterprise SSO Flow

SecureVault v2.4 introduces full **OpenID Connect (OIDC)** support for enterprise Single Sign-On (SSO) integration.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           OPENID CONNECT (OIDC) AUTHENTICATION FLOW                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚    USER              CLIENT              BACKEND           OIDC PROVIDER                â”‚
â”‚     â”‚                  â”‚                    â”‚              (Okta/Azure AD)              â”‚
â”‚     â”‚  Click "Login    â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  with SSO"       â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  GET /oidc/        â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  providers/        â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  List of OIDC      â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  providers         â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  Select provider â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  POST /oidc/       â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  authorize/        â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Discover OIDC     â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  endpoints         â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  /.well-known/     â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  openid-configuration                      â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Generate:         â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ state           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ nonce           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ PKCE verifier   â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  302 Redirect to   â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  OIDC Provider     â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  Redirect to Okta/Azure AD           â”‚                    â”‚                       â”‚
â”‚     â”‚                                       â”‚                    â”‚                       â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
â”‚     â”‚  Login with enterprise credentials                        â”‚                       â”‚
â”‚     â”‚                                       â”‚                    â”‚                       â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
â”‚     â”‚  Authorization Code + State           â”‚                    â”‚                       â”‚
â”‚     â”‚                                       â”‚                    â”‚                       â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  Callback URL    â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  with code+state â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  POST /oidc/       â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  callback/         â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Verify state      â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  & nonce           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Exchange code     â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  for tokens        â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ access_token    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ id_token (JWT)  â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ refresh_token   â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Validate ID Token â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ Fetch JWKS      â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ Verify signatureâ”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ Check claims    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  â€¢ Validate nonce  â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Create/Link User  â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚  Generate JWT      â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚  {access_token,    â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚   refresh_token,   â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚   user_info}       â”‚                    â”‚                       â”‚
â”‚     â”‚                  â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                    â”‚                       â”‚
â”‚     â”‚  Authenticated!   â”‚                    â”‚                    â”‚                       â”‚
â”‚                                                                                          â”‚
â”‚  SUPPORTED OIDC PROVIDERS:                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ Okta   â”‚ â”‚Azure ADâ”‚ â”‚ Auth0  â”‚ â”‚  Google  â”‚ â”‚ Keycloak â”‚                            â”‚
â”‚  â”‚   âœ“    â”‚ â”‚   âœ“    â”‚ â”‚   âœ“    â”‚ â”‚    âœ“     â”‚ â”‚    âœ“     â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                                          â”‚
â”‚  KEY FEATURES:                                                                          â”‚
â”‚  â€¢ Auto-discovery via .well-known/openid-configuration                                  â”‚
â”‚  â€¢ ID Token validation with JWKS                                                        â”‚
â”‚  â€¢ Nonce validation for replay attack protection                                        â”‚
â”‚  â€¢ PKCE (Proof Key for Code Exchange) support                                           â”‚
â”‚  â€¢ Standard claims extraction (sub, email, name, etc.)                                  â”‚
â”‚  â€¢ Automatic user provisioning and linking                                              â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### OIDC Configuration

Configure OIDC providers via environment variables:

```bash
# OIDC Provider Configuration
OIDC_RP_CLIENT_ID=your-client-id
OIDC_RP_CLIENT_SECRET=your-client-secret
OIDC_OP_BASE_URL=https://your-provider.com  # e.g., https://accounts.google.com
OIDC_VERIFY_SSL=True
OIDC_USE_NONCE=True

# Optional: Override discovery endpoints
OIDC_OP_JWKS_ENDPOINT=https://your-provider.com/.well-known/jwks.json
OIDC_OP_USER_ENDPOINT=https://your-provider.com/userinfo
```

#### OIDC API Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/auth/oidc/.well-known/openid-configuration/` | GET | OIDC Discovery document |
| `/api/auth/oidc/.well-known/jwks.json` | GET | JSON Web Key Set |
| `/api/auth/oidc/providers/` | GET | List configured providers |
| `/api/auth/oidc/authorize/` | POST | Start OIDC auth flow |
| `/api/auth/oidc/callback/` | GET | Handle OIDC callback |
| `/api/auth/oidc/userinfo/` | GET | Get authenticated user info |

### WebAuthn/Passkey Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           WEBAUTHN PASSKEY AUTHENTICATION FLOW                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚  â•‘                            REGISTRATION PHASE                                      â•‘  â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                                          â”‚
â”‚    USER           BROWSER         CLIENT (JS)         SERVER           AUTHENTICATOR    â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚  Click         â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚  "Add Passkey" â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  POST /register/ â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  begin/          â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Generate:        â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  â€¢ Challenge      â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  â€¢ User handle    â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  â€¢ RP info        â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  {publicKey:     â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚   options}       â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚  navigator.    â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚  credentials.  â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚  create()      â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚
â”‚     â”‚                â”‚  Create credential request                           â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚
â”‚     â”‚  Biometric/PIN prompt                                                 â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚
â”‚     â”‚  User verifies identity (Face ID / Touch ID / PIN)                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Generate keypair â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Sign challenge   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚
â”‚     â”‚                â”‚  PublicKeyCredential {id, rawId, attestationObject}  â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  POST /register/ â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  complete/       â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  {credential}    â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Verify attestationâ”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Store public key â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Store credential â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  {success: true, â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚   passkey_id}    â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚  "Passkey registered!"          â”‚                  â”‚                   â”‚          â”‚
â”‚                                                                                          â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚  â•‘                            AUTHENTICATION PHASE                                    â•‘  â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                                          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚  Click "Login  â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚  with Passkey" â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  POST /auth/     â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  begin/          â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Generate challengeâ”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Get allowed creds â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  {challenge,     â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚   allowCreds}    â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚  navigator.    â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚  credentials.  â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚  get()         â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚
â”‚     â”‚                â”‚  Get credential request                              â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚
â”‚     â”‚  Biometric/PIN prompt                                                 â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚          â”‚
â”‚     â”‚  User verifies identity                                               â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Sign challenge   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  with private key â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚
â”‚     â”‚                â”‚  PublicKeyCredential {authenticatorData, signature}  â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  POST /auth/     â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  complete/       â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  {credential}    â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Verify signature â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  with stored pubkeyâ”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Update sign countâ”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚  Generate JWT     â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚  {access_token,  â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚   refresh_token} â”‚                   â”‚          â”‚
â”‚     â”‚                â”‚                â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                   â”‚          â”‚
â”‚     â”‚  Authenticated! (Passwordless)  â”‚                  â”‚                   â”‚          â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Authorization & Permission Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AUTHORIZATION & PERMISSION FLOW                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚                         INCOMING REQUEST                                        â”‚   â”‚
â”‚    â”‚  Authorization: Bearer <access_token>                                          â”‚   â”‚
â”‚    â”‚  X-Device-Fingerprint: <device_id>                                             â”‚   â”‚
â”‚    â”‚  X-Request-ID: <uuid>                                                          â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                            â”‚                                             â”‚
â”‚                                            â–¼                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚                       JWT TOKEN VALIDATION                                      â”‚   â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚   â”‚
â”‚    â”‚  â”‚ Verify Signatureâ”‚  â”‚ Check Expiry    â”‚  â”‚ Validate Claims â”‚                 â”‚   â”‚
â”‚    â”‚  â”‚ (HS256/RS256)   â”‚  â”‚ (exp < now?)    â”‚  â”‚ (iss, aud, sub) â”‚                 â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   â”‚
â”‚    â”‚           â”‚                    â”‚                    â”‚                           â”‚   â”‚
â”‚    â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚   â”‚
â”‚    â”‚                                â”‚                                                 â”‚   â”‚
â”‚    â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚   â”‚
â”‚    â”‚                    â”‚ OIDC Token?           â”‚                                    â”‚   â”‚
â”‚    â”‚                    â”‚ (Check JWKS endpoint) â”‚                                    â”‚   â”‚
â”‚    â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                            â”‚                                             â”‚
â”‚                                            â–¼                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚                       PERMISSION CHECK LAYERS                                   â”‚   â”‚
â”‚    â”‚                                                                                 â”‚   â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚    â”‚  â”‚ Layer 1: Authentication Status                                           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â€¢ User authenticated?  â€¢ Session valid?  â€¢ Device trusted?              â”‚  â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚    â”‚                                    â”‚                                           â”‚   â”‚
â”‚    â”‚                                    â–¼                                           â”‚   â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚    â”‚  â”‚ Layer 2: Role-Based Access Control (RBAC)                                â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â€¢ User Role: [user, admin, enterprise_admin]                            â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â€¢ Resource Permission: [read, write, delete, share]                     â”‚  â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚    â”‚                                    â”‚                                           â”‚   â”‚
â”‚    â”‚                                    â–¼                                           â”‚   â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚    â”‚  â”‚ Layer 3: Resource Ownership                                              â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â€¢ Vault Item: user.id == item.user_id                                   â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â€¢ Shared Folder: user in folder.members                                 â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â€¢ Emergency Access: approved_contacts                                   â”‚  â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚    â”‚                                    â”‚                                           â”‚   â”‚
â”‚    â”‚                                    â–¼                                           â”‚   â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚    â”‚  â”‚ Layer 4: Adaptive Security Checks                                        â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â€¢ Risk Score Assessment  â€¢ Behavioral Analysis  â€¢ IP/Geo Verification   â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â€¢ Rate Limiting          â€¢ Anomaly Detection    â€¢ MFA Step-up Required? â”‚  â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                            â”‚                                             â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                              â–¼                           â–¼                              â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                     â”‚   AUTHORIZED  â”‚           â”‚   DENIED      â”‚                       â”‚
â”‚                     â”‚   (200 OK)    â”‚           â”‚  (401/403)    â”‚                       â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚                         AUDIT LOG ENTRY                                         â”‚   â”‚
â”‚    â”‚  â€¢ User ID    â€¢ Resource    â€¢ Action    â€¢ Result    â€¢ Timestamp    â€¢ IP        â”‚   â”‚
â”‚    â”‚  â€¢ Device     â€¢ Risk Score  â€¢ MFA Used  â€¢ OIDC Provider (if SSO)               â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                          â”‚
â”‚  PERMISSION MATRIX:                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Resource         â”‚ Owner  â”‚ Shared â”‚ Admin  â”‚ OIDC   â”‚ Emergency                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Vault Items      â”‚ CRUD   â”‚ R      â”‚ CRUD   â”‚ CRUD   â”‚ R (after waiting period)   â”‚ â”‚
â”‚  â”‚ Folders          â”‚ CRUD   â”‚ R/W*   â”‚ CRUD   â”‚ CRUD   â”‚ R                          â”‚ â”‚
â”‚  â”‚ Passkeys         â”‚ CRUD   â”‚ -      â”‚ R/D    â”‚ CRUD   â”‚ -                          â”‚ â”‚
â”‚  â”‚ Recovery Keys    â”‚ C/R    â”‚ -      â”‚ R      â”‚ C/R    â”‚ -                          â”‚ â”‚
â”‚  â”‚ Security Settingsâ”‚ CRUD   â”‚ -      â”‚ CRUD   â”‚ CRUD   â”‚ -                          â”‚ â”‚
â”‚  â”‚ Shared Folders   â”‚ CRUD   â”‚ R/W*   â”‚ CRUD   â”‚ CRUD   â”‚ R                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  * R/W based on member role (viewer/editor)                                             â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagrams

### Complete Vault Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              VAULT DATA FLOW DIAGRAM                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                              CREATE/UPDATE VAULT ITEM                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚  USER   â”‚      â”‚                        CLIENT BROWSER                         â”‚   â”‚
â”‚    â”‚ INPUT   â”‚      â”‚                                                               â”‚   â”‚
â”‚    â”‚         â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚    â”‚ â€¢ Title â”‚ â”€â”€â”€â”€ â”‚  â”‚ Form Input     â”‚â”€â”€â”€â”€>â”‚ SecureVault    â”‚â”€â”€â”€>â”‚ Argon2id   â”‚ â”‚   â”‚
â”‚    â”‚ â€¢ User  â”‚      â”‚  â”‚ Validation     â”‚     â”‚ Crypto         â”‚    â”‚ KDF        â”‚ â”‚   â”‚
â”‚    â”‚ â€¢ Pass  â”‚      â”‚  â”‚                â”‚     â”‚                â”‚    â”‚            â”‚ â”‚   â”‚
â”‚    â”‚ â€¢ URL   â”‚      â”‚  â”‚ XSS Prevention â”‚     â”‚ â€¢ masterPass   â”‚    â”‚ Derive     â”‚ â”‚   â”‚
â”‚    â”‚ â€¢ Notes â”‚      â”‚  â”‚ Input Sanitize â”‚     â”‚ â€¢ salt (server)â”‚    â”‚ 256-bit keyâ”‚ â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚                     â”‚                                                      â”‚        â”‚   â”‚
â”‚                     â”‚                                                      â–¼        â”‚   â”‚
â”‚                     â”‚                                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚   â”‚
â”‚                     â”‚                                             â”‚  AES-256-GCM   â”‚â”‚   â”‚
â”‚                     â”‚                                             â”‚  Encryption    â”‚â”‚   â”‚
â”‚                     â”‚                                             â”‚                â”‚â”‚   â”‚
â”‚                     â”‚                                             â”‚ â€¢ 12-byte IV   â”‚â”‚   â”‚
â”‚                     â”‚                                             â”‚ â€¢ 128-bit tag  â”‚â”‚   â”‚
â”‚                     â”‚                                             â”‚ â€¢ Ciphertext   â”‚â”‚   â”‚
â”‚                     â”‚                                             â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚   â”‚
â”‚                     â”‚                                                     â”‚         â”‚   â”‚
â”‚                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚                     â”‚  â”‚                    ENCRYPTED PACKAGE                    â”‚   â”‚   â”‚
â”‚                     â”‚  â”‚  {                                                     â”‚   â”‚   â”‚
â”‚                     â”‚  â”‚    "v": "2.0",                                         â”‚   â”‚   â”‚
â”‚                     â”‚  â”‚    "alg": "AES-256-GCM-ARGON2ID",                      â”‚   â”‚   â”‚
â”‚                     â”‚  â”‚    "nonce": "base64(12-bytes)",                        â”‚   â”‚   â”‚
â”‚                     â”‚  â”‚    "ct": "base64(ciphertext+authtag)",                 â”‚   â”‚   â”‚
â”‚                     â”‚  â”‚    "compressed": true,                                 â”‚   â”‚   â”‚
â”‚                     â”‚  â”‚    "ts": 1699999999999                                 â”‚   â”‚   â”‚
â”‚                     â”‚  â”‚  }                                                     â”‚   â”‚   â”‚
â”‚                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚                       â”‚
â”‚                                                    HTTPS POST   â”‚                       â”‚
â”‚                                                    (TLS 1.3)    â–¼                       â”‚
â”‚                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                    DJANGO BACKEND                                   â”‚ â”‚
â”‚  â”‚                                                                                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚ â”‚
â”‚  â”‚  â”‚  API Gateway    â”‚    â”‚  Authentication  â”‚    â”‚  Vault Service  â”‚                â”‚ â”‚
â”‚  â”‚  â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚                â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ JWT Verify   â”‚â”€â”€â”€>â”‚  â€¢ User lookup   â”‚â”€â”€â”€>â”‚  â€¢ Validate     â”‚                â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Rate limit   â”‚    â”‚  â€¢ Permission    â”‚    â”‚  â€¢ Store blob   â”‚                â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ CORS         â”‚    â”‚  â€¢ Audit log     â”‚    â”‚  â€¢ Version      â”‚                â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â”‚
â”‚  â”‚                                                          â”‚                         â”‚ â”‚
â”‚  â”‚                                                          â–¼                         â”‚ â”‚
â”‚  â”‚                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚                                               â”‚   PostgreSQL    â”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚                 â”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚ EncryptedVault  â”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚ Item:           â”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚ â€¢ id (UUID)     â”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚ â€¢ user_id (FK)  â”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚ â€¢ encrypted_dataâ”‚ â—„â”€â”€ OPAQUE BLOB â”‚ â”‚
â”‚  â”‚                                               â”‚ â€¢ item_type     â”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚ â€¢ folder_id     â”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚ â€¢ crypto_versionâ”‚                  â”‚ â”‚
â”‚  â”‚                                               â”‚ â€¢ timestamps    â”‚                  â”‚ â”‚
â”‚  â”‚                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                          â”‚
â”‚                          âœ“ Server NEVER sees plaintext password                         â”‚
â”‚                          âœ“ Server stores encrypted blob only                            â”‚
â”‚                          âœ“ Decryption key never leaves client                           â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Post-Quantum Encryption Data Flow (Kyber-768)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CRYSTALS-KYBER HYBRID ENCRYPTION DATA FLOW                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚                           KEY GENERATION PHASE                                 â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚    â”‚      KYBER-768          â”‚                      â”‚        X25519           â”‚         â”‚
â”‚    â”‚   (Post-Quantum KEM)    â”‚                      â”‚   (Classical ECDH)      â”‚         â”‚
â”‚    â”‚                         â”‚                      â”‚                         â”‚         â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚    â”‚  â”‚ KeyGen()        â”‚    â”‚                      â”‚  â”‚ KeyGen()        â”‚    â”‚         â”‚
â”‚    â”‚  â”‚                 â”‚    â”‚                      â”‚  â”‚                 â”‚    â”‚         â”‚
â”‚    â”‚  â”‚ pk: 1184 bytes  â”‚    â”‚                      â”‚  â”‚ pk: 32 bytes    â”‚    â”‚         â”‚
â”‚    â”‚  â”‚ sk: 2400 bytes  â”‚    â”‚                      â”‚  â”‚ sk: 32 bytes    â”‚    â”‚         â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                â”‚                                                â”‚                       â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                   â”‚                                                     â”‚
â”‚                                   â–¼                                                     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                     â”‚    HYBRID PUBLIC KEY        â”‚                                     â”‚
â”‚                     â”‚                             â”‚                                     â”‚
â”‚                     â”‚  {                          â”‚                                     â”‚
â”‚                     â”‚    kyber: pk_kyber,         â”‚                                     â”‚
â”‚                     â”‚    x25519: pk_x25519        â”‚                                     â”‚
â”‚                     â”‚  }                          â”‚                                     â”‚
â”‚                     â”‚                             â”‚                                     â”‚
â”‚                     â”‚  Stored in: KyberKeyPair    â”‚                                     â”‚
â”‚                     â”‚  model with UUID primary keyâ”‚                                     â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚                           ENCRYPTION PHASE                                     â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                          â”‚
â”‚       PLAINTEXT                                                                          â”‚
â”‚          â”‚                                                                               â”‚
â”‚          â–¼                                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚                                                                                  â”‚  â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”‚
â”‚    â”‚  â”‚  Kyber.Encaps()     â”‚              â”‚  X25519.DH()        â”‚                   â”‚  â”‚
â”‚    â”‚  â”‚                     â”‚              â”‚                     â”‚                   â”‚  â”‚
â”‚    â”‚  â”‚  Input: pk_kyber    â”‚              â”‚  Input: pk_x25519   â”‚                   â”‚  â”‚
â”‚    â”‚  â”‚  Output:            â”‚              â”‚  Output:            â”‚                   â”‚  â”‚
â”‚    â”‚  â”‚   â€¢ ct: 1088 bytes  â”‚              â”‚   â€¢ ephemeral pk    â”‚                   â”‚  â”‚
â”‚    â”‚  â”‚   â€¢ ss: 32 bytes    â”‚              â”‚   â€¢ ss: 32 bytes    â”‚                   â”‚  â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚
â”‚    â”‚             â”‚                                    â”‚                              â”‚  â”‚
â”‚    â”‚             â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚  â”‚
â”‚    â”‚             â”‚    â”‚                                                              â”‚  â”‚
â”‚    â”‚             â–¼    â–¼                                                              â”‚  â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚    â”‚  â”‚                     COMBINE SHARED SECRETS                               â”‚   â”‚  â”‚
â”‚    â”‚  â”‚                                                                          â”‚   â”‚  â”‚
â”‚    â”‚  â”‚   combined_ss = HKDF-SHA256(kyber_ss || x25519_ss, salt, info)          â”‚   â”‚  â”‚
â”‚    â”‚  â”‚                                                                          â”‚   â”‚  â”‚
â”‚    â”‚  â”‚   Output: 256-bit combined key                                          â”‚   â”‚  â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚    â”‚                                           â”‚                                     â”‚  â”‚
â”‚    â”‚                                           â–¼                                     â”‚  â”‚
â”‚    â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚  â”‚
â”‚    â”‚                              â”‚      AES-256-GCM            â”‚                    â”‚  â”‚
â”‚    â”‚                              â”‚                             â”‚                    â”‚  â”‚
â”‚    â”‚    PLAINTEXT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Encrypt(plaintext,         â”‚                    â”‚  â”‚
â”‚    â”‚                              â”‚          combined_key,      â”‚                    â”‚  â”‚
â”‚    â”‚                              â”‚          nonce)             â”‚                    â”‚  â”‚
â”‚    â”‚                              â”‚                             â”‚                    â”‚  â”‚
â”‚    â”‚                              â”‚  Output: ciphertext + tag   â”‚                    â”‚  â”‚
â”‚    â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚  â”‚
â”‚    â”‚                                                                                  â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚                           STORED DATA STRUCTURE                                â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚  KyberEncryptedPassword model:                                                   â”‚  â”‚
â”‚    â”‚                                                                                  â”‚  â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚    â”‚  â”‚ Field               â”‚ Description                                        â”‚   â”‚  â”‚
â”‚    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚    â”‚  â”‚ id                  â”‚ UUID primary key                                   â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ user_id             â”‚ Foreign key to User                                â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ keypair_id          â”‚ Foreign key to KyberKeyPair                        â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ service_name        â”‚ Service identifier (not encrypted)                 â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ kyber_ciphertext    â”‚ Kyber KEM ciphertext (1088 bytes)                  â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ aes_ciphertext      â”‚ AES-256-GCM encrypted data                         â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ nonce               â”‚ AES-GCM nonce (12 bytes)                           â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ ephemeral_public_keyâ”‚ X25519 ephemeral key (32 bytes)                    â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ algorithm           â”‚ "Kyber768-AES256-GCM"                              â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ encryption_version  â”‚ Encryption scheme version                          â”‚   â”‚  â”‚
â”‚    â”‚  â”‚ created_at          â”‚ Timestamp                                          â”‚   â”‚  â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ Zero-Knowledge Security Architecture

SecureVault implements a **true zero-knowledge architecture** where sensitive data is encrypted client-side before any transmission. The server only stores and retrieves encrypted blobs.

### Security Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CLIENT (Browser)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Master Password â†’ Argon2id â†’ Encryption Key                â”‚â”‚
â”‚  â”‚       â”‚                            â”‚                        â”‚â”‚
â”‚  â”‚       â–¼                            â–¼                        â”‚â”‚
â”‚  â”‚  Auth Hash (sent)          Encrypt Data (local)             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ (Only encrypted data + auth hash)
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SERVER (Django)                             â”‚
â”‚  â€¢ Stores encrypted blobs only                                  â”‚
â”‚  â€¢ Verifies auth hash (double-hashed)                          â”‚
â”‚  â€¢ Never sees plaintext passwords                              â”‚
â”‚  â€¢ Caches non-sensitive metadata                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Security Principles

| Principle | Implementation |
|-----------|----------------|
| **Master Password Never Leaves Client** | Argon2id derives encryption key locally; auth hash sent for verification |
| **Double-Hashing for Auth** | Client hashes password, server hashes the hash again |
| **Client-Side Encryption** | AES-256-GCM with WebCrypto API before any API call |
| **Encrypted Blob Storage** | Server stores opaque ciphertext + non-sensitive metadata |
| **Client-Side Decryption** | All decryption happens in browser memory only |
| **Session Auto-Lock** | Automatic key clearing after configurable timeout |
| **Secure Memory Clearing** | Keys wiped from memory on lock/logout |

### Authentication Flow (Zero-Knowledge)

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client (Browser)
    participant S as Server

    U->>C: Enter master password
    
    Note over C: Key Derivation (Client)
    C->>C: salt = fetch from server
    C->>C: encryptionKey = Argon2id(password, salt)
    C->>C: authHash = Argon2id(password + ":auth", salt)
    
    C->>S: POST /verify_auth/ {auth_hash}
    Note over S: Server verifies hash of hash
    S->>S: storedHash = SHA256(authHash)
    S->>S: Compare with database
    S->>C: {valid: true}
    
    Note over C: Session Established
    C->>C: Store encryptionKey in memory
    C->>C: Clear password from memory
    
    Note over U,S: Password NEVER sent to server!
```

---

## ğŸ“ Entity Relationship Diagrams

### Complete Database ER Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    SECUREVAULT DATABASE SCHEMA (ER DIAGRAM)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                                  â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
â”‚  â•‘                                         CORE USER & AUTH DOMAIN                                           â•‘   â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚         User           â”‚         â”‚      TwoFactorAuth     â”‚         â”‚       UserSalt         â”‚             â”‚
â”‚   â”‚  (django.auth.User)    â”‚         â”‚                        â”‚         â”‚                        â”‚             â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚   â”‚ PK  id            INT  â”‚â—„â”€â”€â”€â”€â”   â”‚ PK  id            INT  â”‚         â”‚ PK  id            INT  â”‚             â”‚
â”‚   â”‚     username      VAR  â”‚     â”‚   â”‚ FK  user_id       INT  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ FK  user_id       INT  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚     email         VAR  â”‚     â”‚   â”‚     is_enabled    BOOL â”‚         â”‚     salt          BIN  â”‚        â”‚    â”‚
â”‚   â”‚     password      VAR  â”‚     â”‚   â”‚     mfa_type      VAR  â”‚         â”‚     auth_hash     BIN  â”‚        â”‚    â”‚
â”‚   â”‚     first_name    VAR  â”‚     â”‚   â”‚     secret_key    VAR  â”‚         â”‚     created_at    TS   â”‚        â”‚    â”‚
â”‚   â”‚     last_name     VAR  â”‚     â”‚   â”‚     backup_codes  TEXT â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚    â”‚
â”‚   â”‚     is_active     BOOL â”‚     â”‚   â”‚     authy_id      VAR  â”‚                                            â”‚    â”‚
â”‚   â”‚     date_joined   TS   â”‚     â”‚   â”‚     phone_number  VAR  â”‚                                            â”‚    â”‚
â”‚   â”‚     last_login    TS   â”‚     â”‚   â”‚     last_used     TS   â”‚                                            â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚    â”‚
â”‚             â”‚                    â”‚                                                                          â”‚    â”‚
â”‚             â”‚                    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚             â”‚                    â”‚   â”‚      UserPasskey       â”‚         â”‚      RecoveryKey       â”‚         â”‚    â”‚
â”‚             â”‚                    â”‚   â”‚                        â”‚         â”‚                        â”‚         â”‚    â”‚
â”‚             â”‚                    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚    â”‚
â”‚             â”‚                    â””â”€â”€â”€â”‚ FK  user_id       INT  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ FK  user_id       INT  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â”‚                        â”‚     credential_id BIN  â”‚ (unique)â”‚     encrypted_vault TEXTâ”‚             â”‚
â”‚             â”‚                        â”‚     public_key    BIN  â”‚         â”‚     salt          VAR  â”‚             â”‚
â”‚             â”‚                        â”‚     sign_count    INT  â”‚         â”‚     method        VAR  â”‚             â”‚
â”‚             â”‚                        â”‚     rp_id         VAR  â”‚         â”‚     created_at    TS   â”‚             â”‚
â”‚             â”‚                        â”‚     device_type   VAR  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚             â”‚                        â”‚     created_at    TS   â”‚                                                 â”‚
â”‚             â”‚                        â”‚     last_used_at  TS   â”‚                                                 â”‚
â”‚             â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚
â”‚             â”‚                                                                                                   â”‚
â”‚             â”‚                                                                                                   â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
â”‚  â•‘                                         VAULT & ENCRYPTION DOMAIN                                          â•‘   â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚             â”‚                                                                                                   â”‚
â”‚             â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚             â”‚                    â”‚       VaultFolder          â”‚                                                 â”‚
â”‚             â”‚                    â”‚                            â”‚                                                 â”‚
â”‚             â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                 â”‚
â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ PK  id              INT    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚             â”‚                    â”‚ FK  user_id         INT    â”‚          â”‚                                      â”‚
â”‚             â”‚                    â”‚ FK  parent_id       INT    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ (self-ref)                           â”‚
â”‚             â”‚                    â”‚     name            VAR    â”‚                                                 â”‚
â”‚             â”‚                    â”‚     description     TEXT   â”‚                                                 â”‚
â”‚             â”‚                    â”‚     color           VAR    â”‚                                                 â”‚
â”‚             â”‚                    â”‚     icon            VAR    â”‚                                                 â”‚
â”‚             â”‚                    â”‚     created_at      TS     â”‚                                                 â”‚
â”‚             â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚
â”‚             â”‚                                    â”‚                                                              â”‚
â”‚             â”‚                                    â”‚                                                              â”‚
â”‚             â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚             â”‚    â”‚                                                               â”‚                              â”‚
â”‚             â”‚    â–¼                                                               â–¼                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚    EncryptedVaultItem        â”‚                             â”‚        KyberEncryptedPassword      â”‚          â”‚
â”‚   â”‚                              â”‚                             â”‚                                    â”‚          â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚   â”‚ PK  id              UUID     â”‚                             â”‚ PK  id                  UUID       â”‚          â”‚
â”‚   â”‚ FK  user_id         INT      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ FK  user_id             INT        â”‚          â”‚
â”‚   â”‚ FK  folder_id       INT      â”‚                             â”‚ FK  keypair_id          UUID       â”‚â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚     item_id         VAR      â”‚ (unique)                    â”‚     service_name        VAR        â”‚      â”‚   â”‚
â”‚   â”‚     item_type       VAR      â”‚                             â”‚     username            VAR        â”‚      â”‚   â”‚
â”‚   â”‚     encrypted_data  TEXT     â”‚ â—„â”€â”€ OPAQUE BLOB             â”‚     url                 URL        â”‚      â”‚   â”‚
â”‚   â”‚     crypto_version  INT      â”‚                             â”‚     kyber_ciphertext    BIN        â”‚ â—„â”€â”€ KEM â”‚
â”‚   â”‚     crypto_metadata JSON     â”‚                             â”‚     aes_ciphertext      BIN        â”‚ â—„â”€â”€ ENC â”‚
â”‚   â”‚     pqc_wrapped_key BIN      â”‚                             â”‚     nonce               BIN        â”‚      â”‚   â”‚
â”‚   â”‚     fhe_password    BIN      â”‚                             â”‚     ephemeral_public_key BIN       â”‚      â”‚   â”‚
â”‚   â”‚     encrypted_domain_hash BINâ”‚                             â”‚     encryption_version  INT        â”‚      â”‚   â”‚
â”‚   â”‚     cached_strength_score BINâ”‚                             â”‚     algorithm           VAR        â”‚      â”‚   â”‚
â”‚   â”‚     tags            JSON     â”‚                             â”‚     is_favorite         BOOL       â”‚      â”‚   â”‚
â”‚   â”‚     favorite        BOOL     â”‚                             â”‚     is_deleted          BOOL       â”‚      â”‚   â”‚
â”‚   â”‚     deleted         BOOL     â”‚                             â”‚     created_at          TS         â”‚      â”‚   â”‚
â”‚   â”‚     created_at      TS       â”‚                             â”‚     last_accessed       TS         â”‚      â”‚   â”‚
â”‚   â”‚     updated_at      TS       â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                         â”‚   â”‚
â”‚                                                                                                            â”‚   â”‚
â”‚                                                                                                            â”‚   â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚   â”‚
â”‚  â•‘                                    KYBER POST-QUANTUM CRYPTO DOMAIN                                    â•‘ â”‚   â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚   â”‚
â”‚                                                                                                            â”‚   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚   â”‚          KyberKeyPair              â”‚                      â”‚          KyberSession              â”‚       â”‚   â”‚
â”‚   â”‚                                    â”‚                      â”‚                                    â”‚       â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚   â”‚
â”‚   â”‚ PK  id                UUID         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ PK  id                UUID         â”‚       â”‚   â”‚
â”‚   â”‚ FK  user_id           INT          â”‚                      â”‚ FK  user_id           INT          â”‚       â”‚   â”‚
â”‚   â”‚     public_key        BIN (1184B)  â”‚                      â”‚ FK  keypair_id        UUID         â”‚â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â”‚     private_key       BIN (2400B)  â”‚                      â”‚     session_id        VAR          â”‚ (unique)  â”‚
â”‚   â”‚     key_version       INT          â”‚                      â”‚     ciphertext        BIN          â”‚           â”‚
â”‚   â”‚     algorithm         VAR          â”‚                      â”‚     encrypted_shared_secret BIN    â”‚           â”‚
â”‚   â”‚     security_level    INT          â”‚                      â”‚     ip_address        INET         â”‚           â”‚
â”‚   â”‚     is_active         BOOL         â”‚                      â”‚     user_agent        TEXT         â”‚           â”‚
â”‚   â”‚     is_compromised    BOOL         â”‚                      â”‚     is_active         BOOL         â”‚           â”‚
â”‚   â”‚     x25519_public_key BIN (32B)    â”‚                      â”‚     created_at        TS           â”‚           â”‚
â”‚   â”‚     x25519_private_key BIN (32B)   â”‚                      â”‚     expires_at        TS           â”‚           â”‚
â”‚   â”‚     encryption_count  INT          â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚   â”‚     decryption_count  INT          â”‚                                                                       â”‚
â”‚   â”‚     created_at        TS           â”‚                                                                       â”‚
â”‚   â”‚     last_used         TS           â”‚                                                                       â”‚
â”‚   â”‚     expires_at        TS           â”‚                                                                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                       â”‚
â”‚                                                                                                                 â”‚
â”‚                                                                                                                 â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                                    BEHAVIORAL RECOVERY DOMAIN                                              â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   BehavioralCommitment       â”‚        â”‚  BehavioralRecoveryAttempt   â”‚        â”‚   BehavioralChallenge   â”‚  â”‚
â”‚   â”‚                              â”‚        â”‚                              â”‚        â”‚                         â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ PK  id              INT      â”‚        â”‚ PK  id              INT      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”‚ FK  recovery_attempt_id â”‚  â”‚
â”‚   â”‚ FK  user_id         INT      â”‚        â”‚ FK  user_id         INT      â”‚        â”‚ PK  id              INT â”‚  â”‚
â”‚   â”‚     commitment_id   UUID     â”‚unique  â”‚     attempt_id      UUID     â”‚unique  â”‚     challenge_id    UUIDâ”‚  â”‚
â”‚   â”‚     encrypted_embedding BIN  â”‚        â”‚     current_stage   VAR      â”‚        â”‚     challenge_type  VAR â”‚  â”‚
â”‚   â”‚     challenge_type  VAR      â”‚        â”‚     samples_collected INT    â”‚        â”‚     challenge_data  JSONâ”‚  â”‚
â”‚   â”‚     unlock_conditions JSON   â”‚        â”‚     challenges_completed INT â”‚        â”‚     user_response   JSONâ”‚  â”‚
â”‚   â”‚     is_active       BOOL     â”‚        â”‚     similarity_scores JSON   â”‚        â”‚     similarity_score FLTâ”‚  â”‚
â”‚   â”‚     samples_used    INT      â”‚        â”‚     overall_similarity FLT   â”‚        â”‚     passed          BOOLâ”‚  â”‚
â”‚   â”‚     kyber_public_key BIN     â”‚        â”‚     status          VAR      â”‚        â”‚     attempt_number  INT â”‚  â”‚
â”‚   â”‚     kyber_ciphertext BIN     â”‚        â”‚     ip_address      INET     â”‚        â”‚     created_at      TS  â”‚  â”‚
â”‚   â”‚     is_quantum_protected BOOLâ”‚        â”‚     device_fingerprint VAR   â”‚        â”‚     completed_at    TS  â”‚  â”‚
â”‚   â”‚     blockchain_hash VAR      â”‚        â”‚     started_at      TS       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚   â”‚     blockchain_anchored BOOL â”‚        â”‚     completed_at    TS       â”‚                                     â”‚
â”‚   â”‚     creation_timestamp TS    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                              â”‚
â”‚                                                                                                                 â”‚
â”‚                                                                                                                 â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                                      FHE & SECURITY DOMAIN                                                 â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚       FHEKeyStore            â”‚        â”‚     FHEComputationCache      â”‚        â”‚     FHEOperationLog     â”‚  â”‚
â”‚   â”‚                              â”‚        â”‚                              â”‚        â”‚                         â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ PK  id              UUID     â”‚        â”‚ PK  id              UUID     â”‚        â”‚ PK  id              UUIDâ”‚  â”‚
â”‚   â”‚ FK  user_id         INT      â”‚        â”‚ FK  user_id         INT      â”‚        â”‚ FK  user_id         INT â”‚  â”‚
â”‚   â”‚     key_type        VAR      â”‚        â”‚     operation_type  VAR      â”‚        â”‚     operation_type  VAR â”‚  â”‚
â”‚   â”‚     encrypted_key_data BIN   â”‚        â”‚     input_hash      VAR      â”‚idx     â”‚     encryption_tier VAR â”‚  â”‚
â”‚   â”‚     key_size_bits   INT      â”‚        â”‚     encrypted_result BIN     â”‚        â”‚     status          VAR â”‚  â”‚
â”‚   â”‚     polynomial_mod_deg INT   â”‚        â”‚     computation_time_ms INT  â”‚        â”‚     total_time_ms   INT â”‚  â”‚
â”‚   â”‚     security_level  INT      â”‚        â”‚     circuit_depth   INT      â”‚        â”‚     cache_hit       BOOLâ”‚  â”‚
â”‚   â”‚     is_active       BOOL     â”‚        â”‚     hit_count       INT      â”‚        â”‚     error_message   TEXTâ”‚  â”‚
â”‚   â”‚     created_at      TS       â”‚        â”‚     expires_at      TS       â”‚        â”‚     created_at      TS  â”‚  â”‚
â”‚   â”‚     expires_at      TS       â”‚        â”‚     created_at      TS       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚       UserDevice             â”‚        â”‚       LoginAttempt           â”‚        â”‚     SecurityAlert       â”‚  â”‚
â”‚   â”‚                              â”‚        â”‚                              â”‚        â”‚                         â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ PK  id              INT      â”‚        â”‚ PK  id              INT      â”‚        â”‚ PK  id              INT â”‚  â”‚
â”‚   â”‚ FK  user_id         INT      â”‚        â”‚ FK  user_id         INT      â”‚        â”‚ FK  user_id         INT â”‚  â”‚
â”‚   â”‚     device_id       UUID     â”‚unique  â”‚ FK  device_id       INT      â”‚        â”‚     alert_type      VAR â”‚  â”‚
â”‚   â”‚     device_name     VAR      â”‚        â”‚     username_attempted VAR   â”‚        â”‚     severity        VAR â”‚  â”‚
â”‚   â”‚     device_type     VAR      â”‚        â”‚     ip_address      INET     â”‚        â”‚     title           VAR â”‚  â”‚
â”‚   â”‚     fingerprint     VAR      â”‚unique  â”‚     status          VAR      â”‚        â”‚     message         TEXTâ”‚  â”‚
â”‚   â”‚     browser         VAR      â”‚        â”‚     failure_reason  VAR      â”‚        â”‚     data            JSONâ”‚  â”‚
â”‚   â”‚     os              VAR      â”‚        â”‚     is_suspicious   BOOL     â”‚        â”‚     is_read         BOOLâ”‚  â”‚
â”‚   â”‚     ip_address      INET     â”‚        â”‚     threat_score    INT      â”‚        â”‚     is_resolved     BOOLâ”‚  â”‚
â”‚   â”‚     is_trusted      BOOL     â”‚        â”‚     timestamp       TS       â”‚        â”‚     created_at      TS  â”‚  â”‚
â”‚   â”‚     last_seen       TS       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                              â”‚
â”‚                                                                                                                 â”‚
â”‚                                                                                                                 â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                                   OIDC (OpenID Connect) DOMAIN                                            â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚       OIDCProvider           â”‚        â”‚       OIDCSession            â”‚        â”‚    OIDCUserMapping      â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ PK  id              UUID     â”‚        â”‚ PK  id              UUID     â”‚        â”‚ PK  id              INT â”‚  â”‚
â”‚   â”‚     name            VAR      â”‚unique  â”‚ FK  user_id         INT      â”‚        â”‚ FK  user_id         INT â”‚  â”‚
â”‚   â”‚     client_id       VAR      â”‚        â”‚ FK  provider_id     UUID     â”‚        â”‚ FK  provider_id     UUIDâ”‚  â”‚
â”‚   â”‚     client_secret   VAR      â”‚        â”‚     state           VAR      â”‚        â”‚     oidc_subject    VAR â”‚  â”‚
â”‚   â”‚     discovery_url   VAR      â”‚        â”‚     nonce           VAR      â”‚        â”‚     oidc_email      VAR â”‚  â”‚
â”‚   â”‚     authorization_ep VAR     â”‚        â”‚     pkce_verifier   VAR      â”‚        â”‚     oidc_name       VAR â”‚  â”‚
â”‚   â”‚     token_endpoint  VAR      â”‚        â”‚     id_token        TEXT     â”‚        â”‚     linked_at       TS  â”‚  â”‚
â”‚   â”‚     userinfo_ep     VAR      â”‚        â”‚     access_token    TEXT     â”‚        â”‚     last_login      TS  â”‚  â”‚
â”‚   â”‚     jwks_uri        VAR      â”‚        â”‚     refresh_token   TEXT     â”‚        â”‚     is_primary      BOOLâ”‚  â”‚
â”‚   â”‚     issuer          VAR      â”‚        â”‚     token_expires   TS       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚   â”‚     scopes          JSON     â”‚        â”‚     created_at      TS       â”‚                                     â”‚
â”‚   â”‚     is_active       BOOL     â”‚        â”‚     status          VAR      â”‚                                     â”‚
â”‚   â”‚     created_at      TS       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                              â”‚
â”‚                                                                                                                 â”‚
â”‚   OIDC: OIDCProvider â†’ OIDCSession â†’ OIDCUserMapping â†’ USER (Okta, Azure AD, Auth0, Google, Keycloak)          â”‚
â”‚                                                                                                                 â”‚
â”‚                                                                                                                 â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                                       RELATIONSHIPS LEGEND                                                 â•‘ â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ â”‚
â”‚  â•‘                                                                                                            â•‘ â”‚
â”‚  â•‘   â”€â”€â”€â”€â”€â”€â”€â–º  One-to-Many (FK)     â—„â”€â”€â”€â”€â”€â”€â–º  One-to-One     â”€â”€â”€â”€â”    Self-referencing                       â•‘ â”‚
â”‚  â•‘                                                            â”€â”€â”€â”˜                                            â•‘ â”‚
â”‚  â•‘                                                                                                            â•‘ â”‚
â”‚  â•‘   PK = Primary Key    FK = Foreign Key    TS = Timestamp    BIN = Binary    VAR = VARCHAR                 â•‘ â”‚
â”‚  â•‘   UUID = UUID type    BOOL = Boolean      INT = Integer     TEXT = Text     JSON = JSON type              â•‘ â”‚
â”‚  â•‘                                                                                                            â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Simplified ER Diagram (Core Relationships)

```mermaid
erDiagram
    USER ||--o{ ENCRYPTEDVAULTITEM : owns
    USER ||--o{ KYBERKEYAPAIR : has
    USER ||--o{ USERPASSKEY : has
    USER ||--|| TWOFACTORAUTH : has
    USER ||--|| USERSALT : has
    USER ||--|| RECOVERYKEY : has
    USER ||--o{ BEHAVIORALCOMMITMENT : creates
    USER ||--o{ BEHAVIORALRECOVERYATTEMPT : initiates
    USER ||--o{ USERDEVICE : uses
    USER ||--o{ LOGINATTEMPT : makes
    USER ||--o{ SECURITYALERT : receives
    USER ||--o{ FHEKEYSTORE : owns
    
    VAULTFOLDER ||--o{ ENCRYPTEDVAULTITEM : contains
    VAULTFOLDER ||--o{ VAULTFOLDER : parent_of
    
    KYBERKEYPAIR ||--o{ KYBERENCRYPTEDPASSWORD : encrypts
    KYBERKEYPAIR ||--o{ KYBERSESSION : has
    
    BEHAVIORALRECOVERYATTEMPT ||--o{ BEHAVIORALCHALLENGE : includes
    BEHAVIORALRECOVERYATTEMPT ||--|| RECOVERYFEEDBACK : receives
    
    OIDCPROVIDER ||--o{ OIDCSESSION : authenticates
    OIDCSESSION ||--|| USER : authenticates
    USER ||--o{ OIDCUSERMAPPING : linked_via
    OIDCPROVIDER ||--o{ OIDCUSERMAPPING : provides
    
    USER {
        int id PK
        string username
        string email
        string password
        boolean is_active
    }
    
    ENCRYPTEDVAULTITEM {
        uuid id PK
        int user_id FK
        int folder_id FK
        string item_type
        text encrypted_data
        int crypto_version
    }
    
    KYBERKEYPAIR {
        uuid id PK
        int user_id FK
        binary public_key
        binary private_key
        int key_version
        boolean is_active
    }
    
    BEHAVIORALCOMMITMENT {
        int id PK
        int user_id FK
        uuid commitment_id
        binary encrypted_embedding
        string challenge_type
        boolean blockchain_anchored
    }
```

---

## ğŸ”§ Technology Stack

### Backend Technologies

| Technology | Version | Purpose |
|------------|---------|---------|
| Python | 3.13 | Primary language |
| Django | 4.2.26 | Web framework (LTS) |
| Django REST Framework | 3.16+ | REST API |
| Django Channels | 4.0+ | WebSocket support |
| Celery | 5.5+ | Background tasks |
| Redis | 7.0+ | Cache & message broker |
| PostgreSQL | 15+ | Primary database |
| TensorFlow/Keras | 2.13+ | ML models |
| Transformers | 4.35+ | NLP models |
| Web3.py | 7.0+ | Blockchain interaction |
| mozilla-django-oidc | 4.0+ | OpenID Connect integration |
| Concrete-Python | 2.5+ | Lightweight FHE operations (optional) |
| TenSEAL | 0.3.14+ | Batch FHE operations (optional) |

### Frontend Technologies

| Technology | Version | Purpose |
|------------|---------|---------|
| React | 18.2.0 | UI framework |
| Vite | 5.1.4 | Build tool |
| TensorFlow.js | 3.21.0 | Client-side ML |
| @stablelib/x25519 | 2.0.1 | X25519 ECDH |
| Argon2-browser | 1.18.0 | Client-side KDF |
| CryptoJS | 4.2.0 | Cryptographic operations |
| tsparticles | 3.9.1 | UI animations |
| React Router | 7.5.2 | Client routing |

### ğŸ“¦ Complete Frontend Dependencies (package.json)

SecureVault's frontend uses a carefully curated set of libraries for security, performance, and user experience.

---

#### ğŸ” Core Cryptography & Security Libraries

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **argon2-browser** | ^1.18.0 | ğŸ” KDF | Memory-hard key derivation function (Argon2id) compiled to WebAssembly. Winner of the Password Hashing Competition (PHC). Used for deriving encryption keys from master passwords with adaptive parameters (32-128MB memory based on device capability). |
| **crypto-js** | ^4.2.0 | ğŸ” Encryption | JavaScript library of cryptographic standards including AES-256-CBC, SHA-256, HMAC, PBKDF2. Used as fallback when WebCrypto API is unavailable. Provides legacy encryption compatibility. |
| **@noble/curves** | ^1.6.0 | ğŸ” ECC | Audited, zero-dependency implementation of elliptic curve cryptography. Provides P-384 (secp384r1), Ed25519 for hybrid ECDH key exchange alongside Kyber for defense-in-depth. |
| **@noble/hashes** | ^1.5.0 | ğŸ” Hashing | Audited cryptographic hash functions including SHA-256, SHA-512, HKDF, HMAC. Used for key derivation, message authentication, and combining shared secrets. |
| **@stablelib/random** | ^1.0.2 | ğŸ” RNG | Cryptographically secure random number generation. Provides cross-platform entropy for key generation, nonces, and IVs. |
| **@stablelib/sha256** | ^2.0.1 | ğŸ” Hashing | Optimized SHA-256 implementation. Used in HKDF operations to combine Kyber and X25519 shared secrets. |
| **@stablelib/x25519** | ^2.0.1 | ğŸ” ECDH | Curve25519 elliptic curve Diffie-Hellman key agreement. Provides fast, secure key exchange as the classical fallback alongside post-quantum Kyber. |

---

#### ğŸ›¡ï¸ Post-Quantum Cryptography (PQC) Libraries

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **crystals-kyber-js** | ^2.5.0 | ğŸ›¡ï¸ PQC | Pure JavaScript implementation of CRYSTALS-Kyber-768 (NIST Level 3). Provides quantum-resistant key encapsulation mechanism. Primary PQC library with full WebAssembly acceleration. |
| **mlkem** | ^2.5.0 | ğŸ›¡ï¸ PQC | ML-KEM (Module-Lattice Key Encapsulation Mechanism) - the standardized name for Kyber post NIST finalization. Alternative implementation with optimized performance characteristics. |
| **pqc-kyber** | ^0.7.0 | ğŸ›¡ï¸ PQC | Another Kyber implementation providing redundancy for post-quantum operations. Used as fallback if primary libraries fail to initialize. All three Kyber libraries enable robust PQC with multiple fallback options. |

---

#### ğŸ¤– Machine Learning & AI Libraries

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **@tensorflow/tfjs** | ^3.21.0 | ğŸ¤– ML Core | TensorFlow.js core library for client-side machine learning. Powers real-time password strength prediction, anomaly detection, and behavioral biometrics analysis directly in the browser. |
| **@tensorflow/tfjs-core** | ^3.21.0 | ğŸ¤– ML Core | Core TensorFlow.js operations and tensor manipulation. Provides low-level ML primitives for custom model operations. |
| **@tensorflow/tfjs-backend-webgl** | ^3.21.0 | ğŸ¤– ML Acceleration | WebGL backend for TensorFlow.js enabling GPU-accelerated inference. Provides 10-50x speedup for ML operations on capable devices. |
| **@tensorflow/tfjs-converter** | ^3.21.0 | ğŸ¤– Model Loading | Converts TensorFlow SavedModels and Keras models to TensorFlow.js format. Enables loading pre-trained ML models for password analysis. |
| **@tensorflow-models/universal-sentence-encoder** | ^1.3.3 | ğŸ¤– NLP | Universal Sentence Encoder for semantic text understanding. Used in behavioral profiling to analyze typing patterns and generate 247-dimensional embeddings. |

---

#### âš›ï¸ React Ecosystem

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **react** | ^18.2.0 | âš›ï¸ Core | Core React library with concurrent features, automatic batching, and Suspense for data fetching. Foundation of SecureVault's component architecture. |
| **react-dom** | ^18.2.0 | âš›ï¸ DOM | React DOM renderer for web applications. Provides React 18's new root API (`createRoot`) for improved rendering performance. |
| **react-router-dom** | ^7.5.2 | âš›ï¸ Routing | Declarative routing for React applications. Handles client-side navigation, protected routes, and deep linking for vault items. |
| **react-hot-toast** | ^2.5.2 | âš›ï¸ Notifications | Lightweight, customizable toast notifications. Provides user feedback for security events, form validation, and system status. |
| **react-icons** | ^5.5.0 | âš›ï¸ Icons | Comprehensive icon library including Font Awesome, Material Design, Heroicons. Used throughout the UI for consistent iconography. |

---

#### ğŸ¨ UI & Animation Libraries

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **framer-motion** | ^12.9.1 | ğŸ¨ Animation | Production-ready motion library for React. Powers smooth page transitions, micro-interactions, and gesture-based animations throughout the vault interface. |
| **styled-components** | ^6.1.17 | ğŸ¨ CSS-in-JS | Visual primitives for component-age styling. Enables dynamic theming, scoped styles, and server-side rendering support. |
| **@tsparticles/react** | ^3.0.0 | ğŸ¨ Effects | React wrapper for tsparticles. Provides interactive particle backgrounds for login/signup pages. |
| **@tsparticles/slim** | ^3.9.1 | ğŸ¨ Effects | Lightweight tsparticles bundle with essential features. Creates visual effects without full library overhead (~60% smaller). |
| **lucide-react** | ^0.515.0 | ğŸ¨ Icons | Beautiful, consistent icon library. Alternative to react-icons with better tree-shaking support. |
| **qrcode.react** | ^4.2.0 | ğŸ¨ QR Codes | React component for generating QR codes. Used for TOTP setup, passkey enrollment, and secure credential sharing. |

---

#### ğŸ”¥ Firebase & Push Notifications

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **firebase** | ^11.7.1 | ğŸ”¥ BaaS | Firebase SDK for web. Provides push notifications, real-time database sync, and analytics. Powers cross-device notifications and security alerts. |
| **react-firebase-hooks** | ^5.1.1 | ğŸ”¥ Firebase | React hooks for Firebase. Simplifies Firebase authentication state management and real-time data subscriptions. |

---

#### ğŸ“ Form Management & Validation

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **formik** | ^2.4.6 | ğŸ“ Forms | Popular form library for React. Manages form state, validation, and submission for login, signup, vault item creation, and settings forms. |
| **yup** | ^1.6.1 | ğŸ“ Validation | Schema validation library. Defines validation rules for email format, password strength requirements, and vault item fields. |

---

#### ğŸ”§ Utilities & Data Processing

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **axios** | ^1.8.4 | ğŸ”§ HTTP | Promise-based HTTP client. Handles all API communication with the Django backend including JWT refresh, request interceptors, and error handling. |
| **date-fns** | ^2.30.0 | ğŸ”§ Dates | Modern JavaScript date utility library. Formats timestamps, calculates relative times ("2 hours ago"), and handles password expiration dates. |
| **pako** | ^2.1.0 | ğŸ”§ Compression | High-speed zlib port. Compresses vault data before encryption (>1KB) to reduce storage and network overhead. Provides gzip/deflate compression. |
| **path-browserify** | ^1.0.1 | ğŸ”§ Polyfill | Node.js `path` module for browsers. Required for some cryptographic libraries that expect Node.js environment. |
| **web-vitals** | ^2.1.4 | ğŸ”§ Performance | Library for measuring Core Web Vitals (LCP, FID, CLS). Tracks real user performance metrics for optimization. |

---

#### ğŸ› ï¸ Device Fingerprinting & Security

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **@fingerprintjs/fingerprintjs** | ^3.4.2 | ğŸ› ï¸ Security | Browser fingerprinting library. Generates unique device identifiers for trusted device recognition, anomaly detection, and session binding. |

---

#### ğŸŒ Communication Protocols

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **@grpc/grpc-js** | ^1.13.3 | ğŸŒ gRPC | Pure JavaScript gRPC client. Enables high-performance communication with backend services, particularly for blockchain operations and FHE computations. |

---

#### ğŸ§ª Development Dependencies

| Package | Version | Category | Description |
|---------|---------|----------|-------------|
| **vite** | ^5.1.4 | ğŸ§ª Build | Next-generation frontend build tool. Provides instant dev server startup, HMR (Hot Module Replacement), and optimized production builds with tree-shaking. |
| **@vitejs/plugin-react** | ^4.2.1 | ğŸ§ª Build | Official React plugin for Vite. Enables Fast Refresh, automatic JSX runtime, and React-specific optimizations. |
| **@vitejs/plugin-legacy** | ^5.3.1 | ğŸ§ª Build | Legacy browser support plugin. Generates polyfills for older browsers while maintaining modern code for capable browsers. |
| **vite-plugin-wasm** | ^3.5.0 | ğŸ§ª Build | WebAssembly support for Vite. Required for Argon2 and Kyber WASM modules to work correctly in dev and production. |
| **vite-plugin-top-level-await** | ^1.6.0 | ğŸ§ª Build | Enables top-level await in modules. Required for async WASM initialization in cryptographic libraries. |
| **vitest** | ^1.3.1 | ğŸ§ª Testing | Vite-native unit testing framework. Runs tests with same config as dev server, providing fast test execution. |
| **@vitest/ui** | ^1.3.1 | ğŸ§ª Testing | Visual UI for Vitest. Provides interactive test runner with filtering, debugging, and coverage visualization. |
| **@testing-library/react** | ^16.3.0 | ğŸ§ª Testing | React testing utilities. Enables testing components as users interact with them (by role, label, text). |
| **@testing-library/jest-dom** | ^6.6.3 | ğŸ§ª Testing | Custom Jest matchers for DOM testing. Extends expect with toBeInTheDocument, toHaveStyle, toBeVisible, etc. |
| **@testing-library/user-event** | ^13.5.0 | ğŸ§ª Testing | Simulates user interactions. Provides realistic click, type, and keyboard event simulation for integration tests. |
| **jsdom** | ^24.0.0 | ğŸ§ª Testing | JavaScript DOM implementation. Provides browser-like environment for Node.js testing without a real browser. |

---

#### ğŸ“Š Frontend Dependency Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       FRONTEND DEPENDENCY ARCHITECTURE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           CORE LAYER                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚   react    â”‚  â”‚ react-dom  â”‚  â”‚   axios    â”‚  â”‚  react-router-dom      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  (18.2.0)  â”‚  â”‚  (18.2.0)  â”‚  â”‚  (1.8.4)   â”‚  â”‚     (7.5.2)            â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                             â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚           â”‚                           â”‚                           â”‚                â”‚
â”‚           â–¼                           â–¼                           â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   ğŸ” CRYPTO LAYER   â”‚  â”‚   ğŸ¤– ML LAYER       â”‚  â”‚   ğŸ¨ UI LAYER       â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ â€¢ argon2-browser    â”‚  â”‚ â€¢ @tensorflow/tfjs  â”‚  â”‚ â€¢ framer-motion     â”‚        â”‚
â”‚  â”‚ â€¢ crypto-js         â”‚  â”‚ â€¢ tfjs-core         â”‚  â”‚ â€¢ styled-components â”‚        â”‚
â”‚  â”‚ â€¢ @noble/curves     â”‚  â”‚ â€¢ tfjs-backend-webglâ”‚  â”‚ â€¢ @tsparticles      â”‚        â”‚
â”‚  â”‚ â€¢ @noble/hashes     â”‚  â”‚ â€¢ tfjs-converter    â”‚  â”‚ â€¢ lucide-react      â”‚        â”‚
â”‚  â”‚ â€¢ @stablelib/x25519 â”‚  â”‚ â€¢ universal-encoder â”‚  â”‚ â€¢ react-icons       â”‚        â”‚
â”‚  â”‚ â€¢ @stablelib/sha256 â”‚  â”‚                     â”‚  â”‚ â€¢ qrcode.react      â”‚        â”‚
â”‚  â”‚ â€¢ @stablelib/random â”‚  â”‚                     â”‚  â”‚ â€¢ react-hot-toast   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚           â”‚                                                                        â”‚
â”‚           â–¼                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        ğŸ›¡ï¸ POST-QUANTUM LAYER                                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚ crystals-kyber-jsâ”‚  â”‚      mlkem       â”‚  â”‚    pqc-kyber     â”‚          â”‚   â”‚
â”‚  â”‚  â”‚     (2.5.0)      â”‚  â”‚     (2.5.0)      â”‚  â”‚     (0.7.0)      â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  [Primary PQC]   â”‚  â”‚  [NIST ML-KEM]   â”‚  â”‚   [Fallback]     â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           UTILITY LAYER                                      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚  formik  â”‚ â”‚   yup    â”‚ â”‚ date-fns â”‚ â”‚   pako   â”‚ â”‚ @fingerprintjs     â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ (2.4.6)  â”‚ â”‚ (1.6.1)  â”‚ â”‚ (2.30.0) â”‚ â”‚ (2.1.0)  â”‚ â”‚ (3.4.2)            â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  Forms   â”‚ â”‚Validationâ”‚ â”‚  Dates   â”‚ â”‚Compress  â”‚ â”‚ Device ID          â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                          BUILD LAYER (Dev)                                   â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚   â”‚
â”‚  â”‚ â”‚  vite    â”‚ â”‚ @vitejs/react   â”‚ â”‚ vite-plugin-wasm â”‚ â”‚ vitest + jsdom    â”‚â”‚   â”‚
â”‚  â”‚ â”‚ (5.1.4)  â”‚ â”‚ (4.2.1)         â”‚ â”‚ (3.5.0)          â”‚ â”‚ (testing)         â”‚â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### ğŸ“ˆ Dependency Statistics

| Metric | Value |
|--------|-------|
| **Total Production Dependencies** | 37 packages |
| **Total Dev Dependencies** | 12 packages |
| **Crypto/Security Packages** | 10 packages |
| **Post-Quantum (PQC) Packages** | 3 packages |
| **ML/AI Packages** | 5 packages |
| **UI/Animation Packages** | 7 packages |
| **React Ecosystem Packages** | 5 packages |
| **Estimated Bundle Size (gzipped)** | ~450KB core + lazy-loaded |

---

### DevOps & Infrastructure

| Technology | Purpose |
|------------|---------|
| Docker | Containerization |
| Kubernetes | Orchestration |
| GitHub Actions | CI/CD pipeline |
| Nginx | Reverse proxy & load balancer |
| Gunicorn | WSGI server |
| Daphne | ASGI server (WebSockets) |
| Trivy | Security scanning |

### ğŸ“¦ Complete Backend Dependencies (requirements.txt)

#### Core Django Framework

| Package | Version | Description |
|---------|---------|-------------|
| Django | 4.2.26 | High-level Python web framework (LTS) |
| djangorestframework | 3.16.1 | Powerful toolkit for building Web APIs |
| djangorestframework-simplejwt | 5.2.2 | JWT authentication for Django REST Framework |
| asgiref | 3.8.1 | ASGI specs, helper code, and adapters |

#### Django Extensions & Tools

| Package | Version | Description |
|---------|---------|-------------|
| django-extensions | 4.1 | Collection of custom extensions for Django |
| django-cors-headers | 4.0.0 | Django app for handling CORS headers |
| django-storages | 1.13.2 | Custom storage backends for Django |
| django-timezone-field | 7.1 | Timezone field for Django models |
| drf-yasg | 1.21.10 | Swagger/OpenAPI 2.0 documentation generator |

#### Authentication & OAuth 2.0 / OpenID Connect

| Package | Version | Description |
|---------|---------|-------------|
| django-allauth | 65.12.0 | Authentication, registration, account management |
| dj-rest-auth | 7.0.1 | REST API endpoints for authentication |
| python3-openid | 3.2.0 | Python 3 port of python-openid |
| oauthlib | 3.2.2 | OAuth request-signing logic |
| requests-oauthlib | 2.0.0 | OAuthlib integration with Requests |
| mozilla-django-oidc | 4.0.0+ | OpenID Connect authentication for Django |

#### Cryptography & Security

| Package | Version | Description |
|---------|---------|-------------|
| cryptography | 44.0.2 | Cryptographic primitives and recipes |
| argon2-cffi | 21.3.0 | Argon2 password hashing (winner of PHC) |
| argon2-cffi-bindings | 21.2.0 | Low-level bindings for Argon2 |
| pyOpenSSL | 25.0.0 | Python wrapper around OpenSSL |
| pycryptodome | 3.20.0+ | Self-contained cryptographic library |
| ecdsa | 0.19.1 | ECDSA signature implementation |
| pyotp | 2.9.0 | Python One-Time Password Library (TOTP/HOTP) |

#### JWT & Tokens

| Package | Version | Description |
|---------|---------|-------------|
| PyJWT | 2.10.1 | JSON Web Token implementation |
| python-jose | 3.3.0 | JavaScript Object Signing and Encryption (JOSE) |

#### Celery & Task Queue

| Package | Version | Description |
|---------|---------|-------------|
| celery | 5.5.1 | Distributed task queue |
| django-celery-beat | 2.8.0 | Database-backed periodic tasks |
| django-celery-results | 2.6.0 | Celery result backends for Django |
| amqp | 5.3.1 | AMQP client for Python |
| billiard | 4.2.1 | Python multiprocessing fork |
| kombu | 5.5.3 | Messaging library for Python |
| vine | 5.1.0 | Promise/callback chain implementation |
| redis | 5.2.1 | Python client for Redis |

#### Database

| Package | Version | Description |
|---------|---------|-------------|
| psycopg2-binary | 2.9.10 | PostgreSQL database adapter |
| sqlparse | 0.5.3 | SQL parser for Python |

#### HTTP & Networking

| Package | Version | Description |
|---------|---------|-------------|
| requests | 2.32.3 | HTTP library for Python |
| certifi | 2025.1.31 | Root certificates for SSL verification |
| charset-normalizer | 3.4.1 | Character encoding detection |
| idna | 3.10 | Internationalized Domain Names support |
| urllib3 | 1.26.20 | HTTP client for Python |
| dnspython | 2.7.0 | DNS toolkit for Python |

#### AWS & Cloud Storage

| Package | Version | Description |
|---------|---------|-------------|
| boto3 | 1.26.76 | AWS SDK for Python |
| botocore | 1.29.165 | Low-level AWS SDK interface |
| s3transfer | 0.6.2 | Amazon S3 transfer manager |
| jmespath | 1.0.1 | JSON Matching Expressions |
| google-cloud-storage | 2.5.0 | Google Cloud Storage client |

#### Firebase & Push Notifications

| Package | Version | Description |
|---------|---------|-------------|
| firebase-admin | 5.3.0 | Firebase Admin Python SDK |
| django-push-notifications | 3.0.0 | Push notifications for Django |
| pyfcm | 1.5.4 | Firebase Cloud Messaging client |

#### Django Channels & WebSockets

| Package | Version | Description |
|---------|---------|-------------|
| channels | 4.0.0+ | Async support for Django (WebSockets) |
| channels-redis | 4.1.0+ | Redis channel layer for Django Channels |
| daphne | 4.0.0+ | HTTP/WebSocket protocol server (ASGI) |

#### GeoIP & Device Detection

| Package | Version | Description |
|---------|---------|-------------|
| geoip2 | 4.7.0 | MaxMind GeoIP2 database reader |
| django-ipware | 4.0.2 | IP address detection for Django |
| user-agents | 2.2.0 | User agent string parser |

#### Machine Learning & Data Science

| Package | Version | Description |
|---------|---------|-------------|
| numpy | 1.24.0+ | Numerical computing library |
| pandas | 2.0.0+ | Data analysis library |
| scikit-learn | 1.3.0+ | Machine learning library |
| joblib | 1.3.0+ | Lightweight pipelining in Python |
| tensorflow | 2.13.0+ | Deep learning framework |
| torch | 2.1.0+ | PyTorch deep learning framework |
| transformers | 4.35.0+ | State-of-the-art NLP models |

#### Advanced Security Features

| Package | Version | Description |
|---------|---------|-------------|
| web3 | 7.0.0+ | Ethereum blockchain interaction |
| eth-account | 0.13.0+ | Ethereum account management |
| secretsharing | 0.2.6+ | Shamir's Secret Sharing implementation |
| liboqs-python | 0.10.0+ | Post-quantum cryptography (optional, Linux) |
| concrete-python | 2.5.0+ | Fully Homomorphic Encryption (optional) |
| tenseal | 0.3.14+ | Tensor operations on encrypted data (optional) |

#### Notifications & Communication

| Package | Version | Description |
|---------|---------|-------------|
| twilio | 8.0.0+ | Twilio API for SMS/Voice |
| sendgrid | 6.11.0+ | SendGrid email delivery |
| authy | 2.2.6 | Twilio Authy 2FA integration |

#### Production & Deployment

| Package | Version | Description |
|---------|---------|-------------|
| gunicorn | 21.2.0+ | Python WSGI HTTP server |
| uvicorn | 0.24.0+ | ASGI server with uvloop |
| whitenoise | 6.6.0+ | Static file serving |
| django-redis | 5.4.0+ | Redis cache backend for Django |
| hiredis | 2.3.2+ | High performance Redis client |
| sentry-sdk | 1.40.0+ | Error tracking and monitoring |
| psutil | 5.9.0+ | System monitoring utilities |

#### Security & Rate Limiting

| Package | Version | Description |
|---------|---------|-------------|
| django-ratelimit | 4.1.0+ | Rate limiting for Django views |
| django-defender | 0.9.7+ | Brute-force attack prevention |
| django-health-check | 3.18.0+ | Health check endpoints |
| safety | 2.3.0+ | Dependency vulnerability scanner |
| pip-audit | 2.6.0+ | Security auditing for pip packages |

---

## ğŸ“ Project Structure

```
Password_manager/
â”œâ”€â”€ ğŸ“ .github/
â”‚   â””â”€â”€ ğŸ“ workflows/
â”‚       â””â”€â”€ ğŸ“„ ci.yml                    # CI/CD pipeline configuration
â”œâ”€â”€ ğŸ“ contracts/                        # Solidity smart contracts
â”‚   â”œâ”€â”€ ğŸ“ contracts/
â”‚   â”‚   â””â”€â”€ ğŸ“„ BehavioralCommitmentAnchor.sol
â”‚   â”œâ”€â”€ ğŸ“ scripts/                      # Deployment scripts
â”‚   â”œâ”€â”€ ğŸ“ test/                         # Contract tests
â”‚   â”œâ”€â”€ ğŸ“„ hardhat.config.js             # Hardhat configuration
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“ docker/                           # Docker configurations
â”‚   â”œâ”€â”€ ğŸ“ backend/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Dockerfile                # Backend production image
â”‚   â”‚   â””â”€â”€ ğŸ“„ entrypoint.sh             # Container entrypoint
â”‚   â”œâ”€â”€ ğŸ“ frontend/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Dockerfile                # Frontend production image
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Dockerfile.dev            # Frontend development image
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ nginx.conf                # Nginx config for frontend
â”‚   â”‚   â””â”€â”€ ğŸ“„ entrypoint.sh             # Runtime config injection
â”‚   â”œâ”€â”€ ğŸ“ nginx/
â”‚   â”‚   â””â”€â”€ ğŸ“„ nginx.conf                # Main reverse proxy config
â”‚   â”œâ”€â”€ ğŸ“„ docker-compose.yml            # Production compose
â”‚   â”œâ”€â”€ ğŸ“„ docker-compose.dev.yml        # Development compose
â”‚   â””â”€â”€ ğŸ“„ env.example                   # Environment template
â”œâ”€â”€ ğŸ“ k8s/                              # Kubernetes manifests
â”‚   â”œâ”€â”€ ğŸ“„ namespace.yaml                # K8s namespace
â”‚   â”œâ”€â”€ ğŸ“„ configmap.yaml                # Application config
â”‚   â”œâ”€â”€ ğŸ“„ secrets.yaml                  # Sensitive credentials
â”‚   â”œâ”€â”€ ğŸ“„ deployment.yaml               # All deployments
â”‚   â”œâ”€â”€ ğŸ“„ ingress.yaml                  # Ingress with SSL
â”‚   â””â”€â”€ ğŸ“„ hpa.yaml                      # Horizontal pod autoscaler
â”œâ”€â”€ ğŸ“ desktop/                          # Electron desktop app
â”‚   â”œâ”€â”€ ğŸ“„ main.js                       # Electron main process
â”‚   â”œâ”€â”€ ğŸ“ src/                          # Desktop source code
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“ mobile/                           # React Native mobile app
â”‚   â”œâ”€â”€ ğŸ“„ App.js                        # Mobile entry point
â”‚   â”œâ”€â”€ ğŸ“ src/                          # Mobile source code
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“ browser-extension/                # Browser extension
â”‚   â”œâ”€â”€ ğŸ“„ manifest.json                 # Extension manifest
â”‚   â”œâ”€â”€ ğŸ“ src/                          # Extension source code
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“ frontend/                         # React web application
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ Components/               # React components
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ auth/                 # Authentication components
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ animations/           # UI animations
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ recovery/             # Recovery flow components
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ sharedfolders/        # Shared folders UI
â”‚   â”‚   â”œâ”€â”€ ğŸ“ services/                 # Frontend services
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ api.js                # API client
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ cryptoService.js      # Client-side encryption
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ xchachaEncryption.js  # XChaCha20 encryption
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ eccService.js         # ECC operations
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ oauthService.js       # OAuth social login
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ oidcService.js        # OpenID Connect (OIDC) â­ NEW
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ mfaService.js         # Multi-factor authentication
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ quantum/              # Post-quantum crypto
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ kyberService.js   # Kyber-768 implementation
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ fhe/                  # Fully Homomorphic Encryption
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ fheService.js     # FHE client service (WASM)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ fheKeys.js        # FHE key management (IndexedDB)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ index.js          # FHE module exports
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ behavioralCapture/    # Behavioral biometrics
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ blockchain/           # Web3 integration
â”‚   â”‚   â”œâ”€â”€ ğŸ“ ml/                       # Client-side ML
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ behavioralDNA/        # Behavioral DNA models
â”‚   â”‚   â”œâ”€â”€ ğŸ“ contexts/                 # React contexts
â”‚   â”‚   â”œâ”€â”€ ğŸ“ hooks/                    # Custom hooks
â”‚   â”‚   â””â”€â”€ ğŸ“ utils/                    # Utility functions
â”‚   â”œâ”€â”€ ğŸ“„ vite.config.js                # Vite configuration
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“ password_manager/                 # Django backend
â”‚   â”œâ”€â”€ ğŸ“ password_manager/             # Django project settings
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ settings.py               # Main settings
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ urls.py                   # Root URL config
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ asgi.py                   # ASGI config
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ wsgi.py                   # WSGI config
â”‚   â”‚   â””â”€â”€ ğŸ“„ throttling.py             # Rate limiting
â”‚   â”œâ”€â”€ ğŸ“ api/                          # API app
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ health.py                 # Health check endpoints
â”‚   â”‚   â””â”€â”€ ğŸ“„ urls.py                   # API URL routing
â”‚   â”œâ”€â”€ ğŸ“ auth_module/                  # Authentication
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ views.py                  # Auth views
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ passkey_views.py          # WebAuthn endpoints
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ oauth_views.py            # OAuth endpoints
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ oidc_views.py             # OpenID Connect (OIDC) endpoints â­ NEW
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ mfa_views.py              # MFA endpoints
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ kyber_views.py            # Post-quantum crypto endpoints
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ passkey_primary_recovery_views.py  # Primary recovery
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ quantum_recovery_views.py # Quantum recovery
â”‚   â”‚   â””â”€â”€ ğŸ“ services/                 # Auth services
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ oidc_service.py       # OIDC service (discovery, JWKS) â­ NEW
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ quantum_crypto_service.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ kyber_crypto.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ kyber_cache.py        # Kyber key caching
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ kyber_monitor.py      # Kyber performance monitoring
â”‚   â”‚       â””â”€â”€ ğŸ“„ passkey_primary_recovery_service.py
â”‚   â”œâ”€â”€ ğŸ“ vault/                        # Vault management
â”‚   â”‚   â”œâ”€â”€ ğŸ“ views/                    # Vault views
â”‚   â”‚   â””â”€â”€ ğŸ“„ urls.py                   # Vault URLs
â”‚   â”œâ”€â”€ ğŸ“ security/                     # Security features
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ views.py                  # Security endpoints
â”‚   â”‚   â””â”€â”€ ğŸ“ api/                      # Security APIs
â”‚   â”œâ”€â”€ ğŸ“ ml_security/                  # ML security models
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ views.py                  # ML endpoints
â”‚   â”‚   â””â”€â”€ ğŸ“ ml_models/                # Trained models
â”‚   â”œâ”€â”€ ğŸ“ ml_dark_web/                  # Dark web monitoring
â”‚   â”‚   â”œâ”€â”€ ğŸ“ ml_services.py            # ML services
â”‚   â”‚   â””â”€â”€ ğŸ“„ routing.py                # WebSocket routing
â”‚   â”œâ”€â”€ ğŸ“ behavioral_recovery/          # Behavioral recovery
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ views.py                  # Recovery endpoints
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ models.py                 # Recovery models
â”‚   â”‚   â””â”€â”€ ğŸ“ services/                 # Recovery services
â”‚   â”œâ”€â”€ ğŸ“ blockchain/                   # Blockchain integration
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ views.py                  # Blockchain endpoints
â”‚   â”‚   â””â”€â”€ ğŸ“ services/                 # Blockchain services
â”‚   â”œâ”€â”€ ğŸ“ fhe_service/                  # FHE (Fully Homomorphic Encryption)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ views.py                  # FHE API endpoints
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ models.py                 # FHE models (cache, keystore, logs)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ urls.py                   # FHE URL routing
â”‚   â”‚   â””â”€â”€ ğŸ“ services/                 # FHE services
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ concrete_service.py   # Concrete-Python operations
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ seal_service.py       # TenSEAL batch operations
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ fhe_router.py         # Intelligent operation routing
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ fhe_cache.py          # Redis computation cache
â”‚   â”‚       â””â”€â”€ ğŸ“„ adaptive_manager.py   # Circuit depth management
â”‚   â”œâ”€â”€ ğŸ“ shared/                       # Shared utilities
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ performance_views.py      # Performance monitoring
â”‚   â”‚   â””â”€â”€ ğŸ“ crypto/                   # Server crypto utilities
â”‚   â”œâ”€â”€ ğŸ“ analytics/                    # Analytics
â”‚   â”œâ”€â”€ ğŸ“ ab_testing/                   # A/B testing
â”‚   â”œâ”€â”€ ğŸ“ email_masking/                # Email alias service
â”‚   â””â”€â”€ ğŸ“„ requirements.txt              # Python dependencies
â”œâ”€â”€ ğŸ“ tests/                            # Test suite
â”‚   â”œâ”€â”€ ğŸ“ behavioral_recovery/
â”‚   â”œâ”€â”€ ğŸ“ functional/
â”‚   â””â”€â”€ ğŸ“„ run_all_tests.py
â”œâ”€â”€ ğŸ“ scripts/                          # Utility scripts
â”œâ”€â”€ ğŸ“ docs/                             # Documentation
â””â”€â”€ ğŸ“„ README.md                         # This file
```

---

## ğŸ“‚ Detailed Project Files Structure

### Complete Backend Structure (`password_manager/`)

```
password_manager/
â”œâ”€â”€ ğŸ“ password_manager/                    # Django Project Settings
â”‚   â”œâ”€â”€ ğŸ“„ settings.py                      # Main settings (965 lines)
â”‚   â”‚   â”œâ”€â”€ DATABASES                       # PostgreSQL configuration
â”‚   â”‚   â”œâ”€â”€ CACHES                          # Redis cache backend
â”‚   â”‚   â”œâ”€â”€ CELERY_*                        # Celery configuration
â”‚   â”‚   â”œâ”€â”€ REST_FRAMEWORK                  # DRF settings
â”‚   â”‚   â”œâ”€â”€ SIMPLE_JWT                      # JWT token settings
â”‚   â”‚   â”œâ”€â”€ CORS_*                          # CORS configuration
â”‚   â”‚   â””â”€â”€ CHANNEL_LAYERS                  # Django Channels config
â”‚   â”œâ”€â”€ ğŸ“„ urls.py                          # Root URL routing (113 lines)
â”‚   â”œâ”€â”€ ğŸ“„ asgi.py                          # ASGI config for WebSockets
â”‚   â”œâ”€â”€ ğŸ“„ wsgi.py                          # WSGI config for Gunicorn
â”‚   â”œâ”€â”€ ğŸ“„ compression_middleware.py        # Gzip/Brotli compression (320 lines)
â”‚   â”‚   â”œâ”€â”€ VaultCompressionMiddleware      # Response compression
â”‚   â”‚   â”œâ”€â”€ SecurityHeadersMiddleware       # CSP, HSTS headers
â”‚   â”‚   â””â”€â”€ CacheControlMiddleware          # Cache headers
â”‚   â”œâ”€â”€ ğŸ“„ throttling.py                    # Rate limiting (154 lines)
â”‚   â””â”€â”€ ğŸ“„ api_utils.py                     # API response utilities
â”‚
â”œâ”€â”€ ğŸ“ auth_module/                         # Authentication Module
â”‚   â”œâ”€â”€ ğŸ“„ views.py                         # Core auth endpoints (1403 lines)
â”‚   â”‚   â”œâ”€â”€ RegisterView                    # User registration
â”‚   â”‚   â”œâ”€â”€ LoginView                       # User login
â”‚   â”‚   â””â”€â”€ LogoutView                      # User logout
â”‚   â”œâ”€â”€ ğŸ“„ passkey_views.py                 # WebAuthn/FIDO2 (587 lines)
â”‚   â”‚   â”œâ”€â”€ PasskeyRegistrationView         # Register passkey
â”‚   â”‚   â”œâ”€â”€ PasskeyAuthenticationView       # Authenticate with passkey
â”‚   â”‚   â””â”€â”€ PasskeyListView                 # List user's passkeys
â”‚   â”œâ”€â”€ ğŸ“„ mfa_views.py                     # Multi-factor auth (790 lines)
â”‚   â”‚   â”œâ”€â”€ TOTPSetupView                   # TOTP setup
â”‚   â”‚   â”œâ”€â”€ BiometricSetupView              # Biometric enrollment
â”‚   â”‚   â””â”€â”€ MFAVerifyView                   # Verify MFA code
â”‚   â”œâ”€â”€ ğŸ“„ oauth_views.py                   # OAuth 2.0 (427 lines)
â”‚   â”‚   â”œâ”€â”€ GoogleOAuthView                 # Google login
â”‚   â”‚   â”œâ”€â”€ GitHubOAuthView                 # GitHub login
â”‚   â”‚   â””â”€â”€ AppleOAuthView                  # Apple login
â”‚   â”œâ”€â”€ ğŸ“„ kyber_views.py                   # Kyber API (async views)
â”‚   â”‚   â”œâ”€â”€ generate_keypair                # Async keypair generation
â”‚   â”‚   â”œâ”€â”€ encrypt_password                # Hybrid encryption
â”‚   â”‚   â”œâ”€â”€ decrypt_password                # Hybrid decryption
â”‚   â”‚   â”œâ”€â”€ batch_encrypt                   # Batch operations
â”‚   â”‚   â””â”€â”€ get_kyber_metrics               # Performance metrics
â”‚   â”œâ”€â”€ ğŸ“„ passkey_primary_recovery_views.py # Primary recovery (637 lines)
â”‚   â”œâ”€â”€ ğŸ“„ quantum_recovery_views.py        # Social mesh recovery (1104 lines)
â”‚   â”œâ”€â”€ ğŸ“„ models.py                        # Auth models (540 lines)
â”‚   â”‚   â”œâ”€â”€ KyberKeyPair                    # Kyber-768 keypairs
â”‚   â”‚   â”œâ”€â”€ KyberEncryptedPassword          # Kyber-encrypted data
â”‚   â”‚   â”œâ”€â”€ KyberSession                    # Session shared secrets
â”‚   â”‚   â”œâ”€â”€ TwoFactorAuth                   # 2FA settings
â”‚   â”‚   â”œâ”€â”€ UserSalt                        # User's key derivation salt
â”‚   â”‚   â”œâ”€â”€ UserPasskey                     # WebAuthn credentials
â”‚   â”‚   â”œâ”€â”€ RecoveryKey                     # Recovery key backup
â”‚   â”‚   â””â”€â”€ PushAuth                        # Push notification auth
â”‚   â””â”€â”€ ğŸ“ services/                        # Auth services
â”‚       â”œâ”€â”€ ğŸ“„ kyber_crypto.py              # Kyber-768 implementation
â”‚       â”œâ”€â”€ ğŸ“„ optimized_ntt.py             # NumPy-optimized NTT
â”‚       â”‚   â”œâ”€â”€ OptimizedNTT                # Main NTT class
â”‚       â”‚   â”œâ”€â”€ forward_ntt()               # Forward transform
â”‚       â”‚   â”œâ”€â”€ inverse_ntt()               # Inverse transform
â”‚       â”‚   â””â”€â”€ multiply_ntt()              # Pointwise multiply
â”‚       â”œâ”€â”€ ğŸ“„ parallel_kyber.py            # Parallel operations
â”‚       â”‚   â””â”€â”€ ParallelKyberOperations     # ThreadPoolExecutor batch ops
â”‚       â”œâ”€â”€ ğŸ“„ kyber_cache.py               # Hybrid caching (959 lines)
â”‚       â”‚   â”œâ”€â”€ L1: Memory (LRU)            # Hot keys
â”‚       â”‚   â”œâ”€â”€ L2: Redis                   # Distributed cache
â”‚       â”‚   â””â”€â”€ L3: Database                # Persistent storage
â”‚       â”œâ”€â”€ ğŸ“„ kyber_monitor.py             # Performance monitoring
â”‚       â”œâ”€â”€ ğŸ“„ quantum_crypto_service.py    # PQC service
â”‚       â”œâ”€â”€ ğŸ“„ passkey_primary_recovery_service.py
â”‚       â”œâ”€â”€ ğŸ“„ challenge_generator.py       # Temporal challenges
â”‚       â””â”€â”€ ğŸ“„ trust_scorer.py              # Trust scoring algorithm
â”‚
â”œâ”€â”€ ğŸ“ vault/                               # Vault Management
â”‚   â”œâ”€â”€ ğŸ“ views/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ crud_views.py                # Basic CRUD operations
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ api_views.py                 # Enhanced API (309 lines)
â”‚   â”‚   â”‚   â”œâ”€â”€ get_salt                    # User salt for KDF
â”‚   â”‚   â”‚   â”œâ”€â”€ verify_auth                 # Zero-knowledge auth
â”‚   â”‚   â”‚   â””â”€â”€ statistics                  # Cached vault stats
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ backup_views.py              # Backup/restore
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ folder_views.py              # Folder management
â”‚   â”‚   â””â”€â”€ ğŸ“„ shared_folder_views.py       # Shared folders (RBAC)
â”‚   â”œâ”€â”€ ğŸ“ models/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ vault_models.py              # EncryptedVaultItem
â”‚   â”‚   â””â”€â”€ ğŸ“„ folder_models.py             # VaultFolder
â”‚   â”œâ”€â”€ ğŸ“ services/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ vault_optimization_service.py # Optimization (483 lines)
â”‚   â”‚   â”‚   â”œâ”€â”€ VaultCacheManager           # Multi-level caching
â”‚   â”‚   â”‚   â”œâ”€â”€ VaultQueryOptimizer         # Query optimization
â”‚   â”‚   â”‚   â”œâ”€â”€ VaultCompression            # Gzip utilities
â”‚   â”‚   â”‚   â””â”€â”€ AuthHashService             # Zero-knowledge auth
â”‚   â”‚   â””â”€â”€ ğŸ“„ __init__.py
â”‚   â””â”€â”€ ğŸ“„ tasks.py                         # Celery tasks (471 lines)
â”‚       â”œâ”€â”€ process_audit_log               # Async audit logging
â”‚       â”œâ”€â”€ warm_user_cache                 # Cache warming
â”‚       â”œâ”€â”€ cleanup_deleted_items           # Purge soft-deleted
â”‚       â”œâ”€â”€ check_breach_status             # HIBP API check
â”‚       â””â”€â”€ prepare_export                  # Encrypted export
â”‚
â”œâ”€â”€ ğŸ“ fhe_service/                         # Fully Homomorphic Encryption
â”‚   â”œâ”€â”€ ğŸ“„ views.py                         # FHE endpoints (663 lines)
â”‚   â”‚   â”œâ”€â”€ fhe_encrypt                     # Encrypt with FHE
â”‚   â”‚   â”œâ”€â”€ fhe_strength_check              # Password strength
â”‚   â”‚   â”œâ”€â”€ fhe_batch_strength              # Batch evaluation
â”‚   â”‚   â””â”€â”€ fhe_search                      # Encrypted search
â”‚   â”œâ”€â”€ ğŸ“„ models.py                        # FHE models (287 lines)
â”‚   â”‚   â”œâ”€â”€ FHEKeyStore                     # User FHE keys
â”‚   â”‚   â”œâ”€â”€ FHEComputationCacheModel        # Computation cache
â”‚   â”‚   â”œâ”€â”€ FHEOperationLog                 # Audit log
â”‚   â”‚   â””â”€â”€ FHEMetrics                      # Aggregated metrics
â”‚   â””â”€â”€ ğŸ“ services/
â”‚       â”œâ”€â”€ ğŸ“„ concrete_service.py          # Concrete-Python ops
â”‚       â”œâ”€â”€ ğŸ“„ seal_service.py              # TenSEAL SEAL ops
â”‚       â”œâ”€â”€ ğŸ“„ fhe_router.py                # Tier routing
â”‚       â”œâ”€â”€ ğŸ“„ fhe_cache.py                 # Redis cache
â”‚       â””â”€â”€ ğŸ“„ adaptive_manager.py          # Depth management
â”‚
â”œâ”€â”€ ğŸ“ behavioral_recovery/                 # Behavioral Recovery System
â”‚   â”œâ”€â”€ ğŸ“„ views.py                         # Recovery endpoints (726 lines)
â”‚   â”œâ”€â”€ ğŸ“„ models.py                        # Recovery models (587 lines)
â”‚   â”‚   â”œâ”€â”€ BehavioralCommitment            # 247-dim DNA storage
â”‚   â”‚   â”œâ”€â”€ BehavioralRecoveryAttempt       # Recovery attempts
â”‚   â”‚   â”œâ”€â”€ BehavioralChallenge             # Individual challenges
â”‚   â”‚   â”œâ”€â”€ BehavioralProfileSnapshot       # Periodic snapshots
â”‚   â”‚   â”œâ”€â”€ RecoveryFeedback                # User feedback (Phase 2B.2)
â”‚   â”‚   â””â”€â”€ RecoveryPerformanceMetric       # Performance metrics
â”‚   â”œâ”€â”€ ğŸ“„ tasks.py                         # Celery tasks
â”‚   â””â”€â”€ ğŸ“ services/
â”‚       â”œâ”€â”€ ğŸ“„ recovery_orchestrator.py     # Flow orchestration
â”‚       â”œâ”€â”€ ğŸ“„ behavioral_analyzer.py       # DNA analysis
â”‚       â””â”€â”€ ğŸ“„ guardian_service.py          # Guardian mesh
â”‚
â”œâ”€â”€ ğŸ“ blockchain/                          # Blockchain Anchoring
â”‚   â”œâ”€â”€ ğŸ“„ views.py                         # Blockchain endpoints (390 lines)
â”‚   â”œâ”€â”€ ğŸ“„ models.py                        # Anchor models
â”‚   â””â”€â”€ ğŸ“ services/
â”‚       â”œâ”€â”€ ğŸ“„ blockchain_anchor_service.py # Web3.py + Merkle trees
â”‚       â”œâ”€â”€ ğŸ“„ merkle_tree.py               # Merkle tree implementation
â”‚       â””â”€â”€ ğŸ“„ commitment_hasher.py         # SHA-256 hashing
â”‚
â”œâ”€â”€ ğŸ“ ml_security/                         # Machine Learning Security
â”‚   â”œâ”€â”€ ğŸ“„ views.py                         # ML endpoints
â”‚   â””â”€â”€ ğŸ“ ml_models/
â”‚       â”œâ”€â”€ ğŸ“„ password_strength_model.py   # LSTM password strength
â”‚       â”œâ”€â”€ ğŸ“„ anomaly_detector.py          # Isolation Forest
â”‚       â”œâ”€â”€ ğŸ“„ threat_analyzer.py           # CNN-LSTM threat analysis
â”‚       â””â”€â”€ ğŸ“„ behavioral_model.py          # Behavioral profiling
â”‚
â”œâ”€â”€ ğŸ“ ml_dark_web/                         # Dark Web Monitoring
â”‚   â”œâ”€â”€ ğŸ“„ ml_services.py                   # BERT breach detection
â”‚   â”œâ”€â”€ ğŸ“„ consumers.py                     # WebSocket consumers
â”‚   â””â”€â”€ ğŸ“„ routing.py                       # WebSocket routing
â”‚
â”œâ”€â”€ ğŸ“ security/                            # Security Features
â”‚   â”œâ”€â”€ ğŸ“„ views.py                         # Security endpoints
â”‚   â”œâ”€â”€ ğŸ“„ models.py                        # Security models (207 lines)
â”‚   â”‚   â”œâ”€â”€ UserDevice                      # Device tracking
â”‚   â”‚   â”œâ”€â”€ SocialMediaAccount              # Social account protection
â”‚   â”‚   â”œâ”€â”€ LoginAttempt                    # Login tracking
â”‚   â”‚   â”œâ”€â”€ SecurityAlert                   # Alert system
â”‚   â”‚   â”œâ”€â”€ UserNotificationSettings        # Notification prefs
â”‚   â”‚   â””â”€â”€ AccountLockEvent                # Lock/unlock events
â”‚   â””â”€â”€ ğŸ“ services/
â”‚       â”œâ”€â”€ ğŸ“„ breach_monitor.py            # Breach monitoring
â”‚       â””â”€â”€ ğŸ“„ device_trust.py              # Device trust scoring
â”‚
â””â”€â”€ ğŸ“„ requirements.txt                     # 119 Python packages
```

### Complete Frontend Structure (`frontend/src/`)

```
frontend/src/
â”œâ”€â”€ ğŸ“„ App.jsx                              # Main React app (1149 lines)
â”œâ”€â”€ ğŸ“„ App.css                              # Global styles (638 lines)
â”œâ”€â”€ ğŸ“„ main.jsx                             # React entry point
â”‚
â”œâ”€â”€ ğŸ“ services/                            # Frontend Services
â”‚   â”œâ”€â”€ ğŸ“„ api.js                           # API client (209 lines)
â”‚   â”œâ”€â”€ ğŸ“„ cryptoService.js                 # AES-GCM encryption (454 lines)
â”‚   â”œâ”€â”€ ğŸ“„ secureVaultCrypto.js             # WebCrypto API (717 lines) â­
â”‚   â”‚   â”œâ”€â”€ deriveKeyFromPassword()         # Argon2id KDF
â”‚   â”‚   â”œâ”€â”€ encrypt()                       # AES-256-GCM encrypt
â”‚   â”‚   â”œâ”€â”€ decrypt()                       # AES-256-GCM decrypt
â”‚   â”‚   â”œâ”€â”€ generatePassword()              # Secure random generator
â”‚   â”‚   â””â”€â”€ clearMemory()                   # Secure memory wipe
â”‚   â”œâ”€â”€ ğŸ“„ secureVaultService.js            # Zero-knowledge ops (709 lines) â­
â”‚   â”‚   â”œâ”€â”€ initialize()                    # Init with master password
â”‚   â”‚   â”œâ”€â”€ fetchAndDecryptItems()          # Fetch + decrypt
â”‚   â”‚   â”œâ”€â”€ encryptAndSave()                # Encrypt + save
â”‚   â”‚   â””â”€â”€ verifyMasterPassword()          # Zero-knowledge verify
â”‚   â”œâ”€â”€ ğŸ“„ xchachaEncryption.js             # XChaCha20-Poly1305 (413 lines)
â”‚   â”œâ”€â”€ ğŸ“„ eccService.js                    # ECC operations (367 lines)
â”‚   â”œâ”€â”€ ğŸ“ quantum/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ kyberService.js              # Kyber-768 + X25519 (1232 lines)
â”‚   â”‚   â”‚   â”œâ”€â”€ generateKeypair()           # Hybrid keypair gen
â”‚   â”‚   â”‚   â”œâ”€â”€ hybridEncapsulate()         # KEM + DH
â”‚   â”‚   â”‚   â””â”€â”€ hybridDecapsulate()         # Decapsulation
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.js                     # Quantum exports
â”‚   â”œâ”€â”€ ğŸ“ fhe/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ fheService.js                # TFHE WASM client (681 lines)
â”‚   â”‚   â”‚   â”œâ”€â”€ initialize()                # Load WASM module
â”‚   â”‚   â”‚   â”œâ”€â”€ generateKeys()              # FHE keypair gen
â”‚   â”‚   â”‚   â”œâ”€â”€ encryptPassword()           # FHE encrypt
â”‚   â”‚   â”‚   â””â”€â”€ checkStrength()             # Encrypted strength
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ fheKeys.js                   # IndexedDB key storage (604 lines)
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.js
â”‚   â”œâ”€â”€ ğŸ“ behavioralCapture/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BehavioralCaptureEngine.js   # 247-dim capture
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ KeystrokeDynamics.js         # Typing patterns
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ MouseBiometrics.js           # Mouse patterns
â”‚   â”‚   â””â”€â”€ ğŸ“„ CognitivePatterns.js         # Cognitive analysis
â”‚   â”œâ”€â”€ ğŸ“ blockchain/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ web3Service.js               # Web3 integration
â”‚   â”‚   â””â”€â”€ ğŸ“„ contractABI.json             # Smart contract ABI
â”‚   â”œâ”€â”€ ğŸ“„ vaultService.js                  # Vault operations (438 lines)
â”‚   â”œâ”€â”€ ğŸ“„ mfaService.js                    # MFA client (583 lines)
â”‚   â”œâ”€â”€ ğŸ“„ oauthService.js                  # OAuth client (235 lines)
â”‚   â”œâ”€â”€ ğŸ“„ mlSecurityService.js             # ML security (369 lines)
â”‚   â”œâ”€â”€ ğŸ“„ darkWebService.js                # Dark web monitoring (115 lines)
â”‚   â”œâ”€â”€ ğŸ“„ analyticsService.js              # Analytics (734 lines)
â”‚   â”œâ”€â”€ ğŸ“„ preferencesService.js            # User preferences (809 lines)
â”‚   â”œâ”€â”€ ğŸ“„ performanceMonitor.js            # Performance tracking (528 lines)
â”‚   â””â”€â”€ ğŸ“„ SecureBehavioralStorage.js       # Encrypted IndexedDB (373 lines)
â”‚
â”œâ”€â”€ ğŸ“ hooks/                               # React Hooks
â”‚   â”œâ”€â”€ ğŸ“„ useAuth.jsx                      # Authentication hook
â”‚   â”œâ”€â”€ ğŸ“„ useSecureVault.js                # Vault operations (466 lines) â­
â”‚   â”‚   â”œâ”€â”€ initialize()                    # Init vault
â”‚   â”‚   â”œâ”€â”€ fetchItems()                    # Fetch + decrypt
â”‚   â”‚   â”œâ”€â”€ saveItem()                      # Encrypt + save
â”‚   â”‚   â””â”€â”€ deleteItem()                    # Soft delete
â”‚   â”œâ”€â”€ ğŸ“„ useKyber.js                      # Kyber WASM/Worker
â”‚   â”œâ”€â”€ ğŸ“„ useBehavioralRecovery.js         # Recovery hook
â”‚   â”œâ”€â”€ ğŸ“„ useBiometricReauth.js            # Biometric re-auth
â”‚   â”œâ”€â”€ ğŸ“„ useBreachWebSocket.js            # Breach alerts
â”‚   â””â”€â”€ ğŸ“„ useSecureSession.js              # Session management
â”‚
â”œâ”€â”€ ğŸ“ contexts/                            # React Contexts
â”‚   â”œâ”€â”€ ğŸ“„ AuthContext.jsx                  # Authentication state
â”‚   â”œâ”€â”€ ğŸ“„ VaultContext.jsx                 # Vault state
â”‚   â”œâ”€â”€ ğŸ“„ BehavioralContext.jsx            # Behavioral profile
â”‚   â””â”€â”€ ğŸ“„ AccessibilityContext.jsx         # A11y settings
â”‚
â”œâ”€â”€ ğŸ“ Components/
â”‚   â”œâ”€â”€ ğŸ“ auth/                            # Auth Components
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Login.jsx                    # Login form (174 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PasskeyAuth.jsx              # Passkey auth (308 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PasskeyRegistration.jsx      # Passkey setup (179 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BiometricAuth.jsx            # Biometric auth (413 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BiometricSetup.jsx           # Biometric enrollment (437 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ TwoFactorSetup.jsx           # 2FA config (417 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ RecoveryKeySetup.jsx         # Recovery key (434 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PasswordRecovery.jsx         # Password recovery (636 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PasskeyPrimaryRecoverySetup.jsx # Primary recovery (451 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PasskeyPrimaryRecoveryInitiate.jsx # Recovery start (517 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ QuantumRecoverySetup.jsx     # Quantum recovery UI (696 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ OAuthCallback.jsx            # OAuth callback (334 lines)
â”‚   â”‚   â””â”€â”€ ğŸ“„ SocialLoginButtons.jsx       # Social login (98 lines)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ vault/                           # Vault Components
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ VaultList.jsx                # Item list
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ VaultItem.jsx                # Item display
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ VaultItemDetail.jsx          # Item detail
â”‚   â”‚   â””â”€â”€ ğŸ“„ VaultSearch.jsx              # Search functionality
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ security/                        # Security Components
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PasswordGenerator.jsx        # Password generator
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PasswordStrengthMeter.jsx    # Strength meter
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PasswordStrengthMeterML.jsx  # ML-powered strength
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ SessionMonitor.jsx           # Session monitoring
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ AccountProtection.jsx        # Account protection
â”‚   â”‚   â””â”€â”€ ğŸ“„ BiometricReauth.jsx          # Re-authentication
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ sharedfolders/                   # Shared Folders
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ SharedFoldersDashboard.jsx   # Dashboard (376 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ CreateFolderModal.jsx        # Create folder (368 lines)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ FolderDetailsModal.jsx       # Folder details (590 lines)
â”‚   â”‚   â””â”€â”€ ğŸ“„ InvitationsModal.jsx         # Invitations (427 lines)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ recovery/                        # Recovery Components
â”‚   â”‚   â”œâ”€â”€ ğŸ“ behavioral/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BehavioralRecoveryFlow.jsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ ChallengeDisplay.jsx
â”‚   â”‚   â””â”€â”€ ğŸ“ social/
â”‚   â”‚       â””â”€â”€ ğŸ“„ SocialMeshRecovery.jsx
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ admin/                           # Admin Components
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ RecoveryDashboard.jsx        # Recovery admin
â”‚   â”‚   â””â”€â”€ ğŸ“„ PerformanceMonitoring.jsx    # Performance admin
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ common/                          # Common Components
â”‚       â”œâ”€â”€ ğŸ“„ Button.jsx
â”‚       â”œâ”€â”€ ğŸ“„ Modal.jsx
â”‚       â”œâ”€â”€ ğŸ“„ Input.jsx
â”‚       â”œâ”€â”€ ğŸ“„ LoadingIndicator.jsx
â”‚       â””â”€â”€ ğŸ“„ ErrorBoundary.jsx
â”‚
â”œâ”€â”€ ğŸ“ ml/                                  # Client-side ML
â”‚   â””â”€â”€ ğŸ“ behavioralDNA/
â”‚       â”œâ”€â”€ ğŸ“„ index.js                     # ML exports
â”‚       â”œâ”€â”€ ğŸ“„ HybridModel.js               # Client/server switcher
â”‚       â”œâ”€â”€ ğŸ“„ TransformerModel.js          # Behavioral transformer
â”‚       â””â”€â”€ ğŸ“„ BackendAPI.js                # Backend ML API client
â”‚
â”œâ”€â”€ ğŸ“ utils/                               # Utilities
â”‚   â”œâ”€â”€ ğŸ“„ kyber-wasm-loader.js             # Kyber WASM loader
â”‚   â”œâ”€â”€ ğŸ“„ kyber-cache.js                   # IndexedDB cache
â”‚   â”œâ”€â”€ ğŸ“„ deviceFingerprint.js             # Device fingerprinting
â”‚   â”œâ”€â”€ ğŸ“„ errorHandler.js                  # Error handling
â”‚   â”œâ”€â”€ ğŸ“„ NetworkQualityEstimator.js       # Network quality
â”‚   â””â”€â”€ ğŸ“„ OfflineQueueManager.js           # Offline queue
â”‚
â””â”€â”€ ğŸ“ workers/                             # Web Workers
    â””â”€â”€ ğŸ“„ kyber-worker.js                  # Background Kyber ops
```

### Docker & DevOps Structure

```
docker/
â”œâ”€â”€ ğŸ“„ docker-compose.yml                   # Production compose (362 lines)
â”‚   â”œâ”€â”€ backend                             # Django + Gunicorn
â”‚   â”œâ”€â”€ frontend                            # Nginx + React
â”‚   â”œâ”€â”€ postgres                            # PostgreSQL 15
â”‚   â”œâ”€â”€ redis                               # Redis 7
â”‚   â”œâ”€â”€ celery-worker                       # Celery workers
â”‚   â”œâ”€â”€ celery-beat                         # Celery scheduler
â”‚   â””â”€â”€ daphne                              # WebSocket server
â”œâ”€â”€ ğŸ“„ docker-compose.dev.yml               # Development compose
â”œâ”€â”€ ğŸ“„ env.example                          # Environment template
â”œâ”€â”€ ğŸ“ backend/
â”‚   â”œâ”€â”€ ğŸ“„ Dockerfile                       # Multi-stage build
â”‚   â””â”€â”€ ğŸ“„ entrypoint.sh                    # Migrations + startup
â”œâ”€â”€ ğŸ“ frontend/
â”‚   â”œâ”€â”€ ğŸ“„ Dockerfile                       # Production build
â”‚   â”œâ”€â”€ ğŸ“„ Dockerfile.dev                   # Development build
â”‚   â”œâ”€â”€ ğŸ“„ nginx.conf                       # Nginx configuration
â”‚   â””â”€â”€ ğŸ“„ entrypoint.sh                    # Runtime env injection
â””â”€â”€ ğŸ“ nginx/
    â””â”€â”€ ğŸ“„ nginx.conf                       # Reverse proxy config

k8s/
â”œâ”€â”€ ğŸ“„ namespace.yaml                       # password-manager namespace
â”œâ”€â”€ ğŸ“„ configmap.yaml                       # Application config
â”œâ”€â”€ ğŸ“„ secrets.yaml                         # Sensitive credentials
â”œâ”€â”€ ğŸ“„ deployment.yaml                      # All deployments (697 lines)
â”‚   â”œâ”€â”€ backend-deployment                  # Django (replicas: 4)
â”‚   â”œâ”€â”€ frontend-deployment                 # Nginx (replicas: 3)
â”‚   â”œâ”€â”€ celery-worker-deployment            # Workers (replicas: 2)
â”‚   â”œâ”€â”€ celery-beat-deployment              # Scheduler (replicas: 1)
â”‚   â””â”€â”€ daphne-deployment                   # WebSocket (replicas: 2)
â”œâ”€â”€ ğŸ“„ ingress.yaml                         # nginx-ingress + SSL
â””â”€â”€ ğŸ“„ hpa.yaml                             # Horizontal pod autoscalers

.github/workflows/
â””â”€â”€ ğŸ“„ ci.yml                               # CI/CD pipeline (536 lines)
    â”œâ”€â”€ test                                # pytest + vitest
    â”œâ”€â”€ lint                                # flake8 + ESLint
    â”œâ”€â”€ security                            # bandit + safety + Trivy
    â”œâ”€â”€ build                               # Docker multi-arch
    â”œâ”€â”€ deploy-staging                      # Auto on develop
    â””â”€â”€ deploy-production                   # Manual approval
```

---

## ğŸš€ Quick Start

### Prerequisites

- Python 3.13+
- Node.js 20+
- PostgreSQL 15+
- Redis 7+
- Docker & Docker Compose (optional)

### Option 1: Docker Compose (Recommended)

```bash
# Clone repository
git clone https://github.com/yourusername/Password_manager.git
cd Password_manager

# Copy environment file
cp docker/env.example docker/.env

# Edit .env with your settings
nano docker/.env

# Start all services
cd docker
docker-compose up -d

# Access the application
# Frontend: http://localhost:3000
# Backend API: http://localhost:8000
# API Docs: http://localhost:8000/docs/
```

### Option 2: Manual Setup

```bash
# Backend Setup
cd password_manager
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt

# Create .env file (IMPORTANT!)
cp env.example .env
# Edit .env and ensure DEBUG=True for development

python manage.py migrate
python manage.py runserver 8000

# Frontend Setup (new terminal)
cd frontend
npm install
npm run dev

# Access at http://localhost:5173
```

### âš ï¸ Important Development Notes

| Setting | Development | Production |
|---------|-------------|------------|
| `DEBUG` | `True` | `False` |
| Rate Limiting (auth) | 30/minute | 3/minute |
| HTTPS Redirect | Disabled | Enabled |
| Error Details | Shown | Hidden |

**Common Issues & Solutions:**

1. **HTTPS Redirect Loops / SSL Errors**
   - Ensure `DEBUG=True` in `password_manager/.env`
   - This disables `SECURE_SSL_REDIRECT` which causes issues in development

2. **HTTP 429 Too Many Requests**
   - Rate limiting is automatically lenient in `DEBUG` mode
   - If hitting limits, restart the backend server

3. **WebSocket / ASGI Errors**
   - Use `python manage.py runserver` (WSGI) for development
   - Daphne (ASGI) is only needed for WebSocket features in production

4. **Login Form Not Submitting**
   - Clear browser cache and localStorage
   - Ensure both email and password fields are filled

### Test User Setup

```bash
# Create a test user for development
cd password_manager
python manage.py shell -c "
from django.contrib.auth.models import User
from auth_module.models import UserSalt
import os
u, _ = User.objects.get_or_create(username='testuser@gmail.com', defaults={'email': 'testuser@gmail.com'})
u.set_password('TestPass123!')
u.save()
if not UserSalt.objects.filter(user=u).exists():
    UserSalt.objects.create(user=u, salt=os.urandom(32), auth_hash=os.urandom(64))
print('Test user created: testuser@gmail.com / TestPass123!')
"
```

---

## ğŸ” Encryption & Decryption Mechanisms

### Zero-Knowledge Architecture

SecureVault implements a **strict zero-knowledge architecture** where:

1. **All encryption/decryption happens client-side**
2. **Server never receives plaintext data or encryption keys**
3. **Master password never leaves the client**
4. **Only encrypted blobs are transmitted and stored**

### Encryption Flow Diagram

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client (Browser)
    participant S as Server
    participant DB as Database

    U->>C: Enter password + data
    
    Note over C: Key Derivation
    C->>C: Argon2id(password, salt)
    C->>C: Generate 256-bit key
    
    Note over C: Encryption
    C->>C: Generate random IV (12 bytes)
    C->>C: AES-GCM-256 encrypt(data, key, iv)
    C->>C: Generate auth tag (128-bit)
    
    Note over C: Package encrypted data
    C->>C: {ciphertext, iv, tag, salt}
    
    C->>S: HTTPS POST encrypted blob
    S->>DB: Store encrypted blob
    DB->>S: OK
    S->>C: Success response
    C->>U: Confirmation
    
    Note over S: Server NEVER sees plaintext!
```

### Complete Encryption & Decryption Mechanisms

SecureVault implements a **multi-layer encryption architecture** with various algorithms for different security requirements:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ENCRYPTION ALGORITHM HIERARCHY                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   Layer 1: Primary Vault Encryption                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  AES-256-GCM + Argon2id KDF                                                      â”‚  â”‚
â”‚   â”‚  â€¢ 256-bit key derived from master password                                      â”‚  â”‚
â”‚   â”‚  â€¢ 96-bit random nonce (IV) per encryption                                       â”‚  â”‚
â”‚   â”‚  â€¢ 128-bit authentication tag (integrity verification)                           â”‚  â”‚
â”‚   â”‚  â€¢ Compression: Gzip for data > 1KB                                              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                          â”‚
â”‚   Layer 2: Alternative Symmetric Encryption                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  XChaCha20-Poly1305 AEAD                                                         â”‚  â”‚
â”‚   â”‚  â€¢ 256-bit key                                                                   â”‚  â”‚
â”‚   â”‚  â€¢ 192-bit extended nonce (safer for random generation)                          â”‚  â”‚
â”‚   â”‚  â€¢ 128-bit Poly1305 MAC                                                          â”‚  â”‚
â”‚   â”‚  â€¢ Used for: File encryption, large data, stream ciphers                         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                          â”‚
â”‚   Layer 3: Post-Quantum Key Encapsulation                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  CRYSTALS-Kyber-768 (NIST Level 3) + X25519 Hybrid                               â”‚  â”‚
â”‚   â”‚  â€¢ Kyber: 1184-byte public key, 2400-byte private key                            â”‚  â”‚
â”‚   â”‚  â€¢ X25519: 32-byte keys (defense-in-depth)                                       â”‚  â”‚
â”‚   â”‚  â€¢ Combined 64-byte shared secret                                                â”‚  â”‚
â”‚   â”‚  â€¢ Quantum-resistant + classical security                                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                          â”‚
â”‚   Layer 4: Elliptic Curve Cryptography (Key Exchange)                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Hybrid ECC: Curve25519 + P-384                                                  â”‚  â”‚
â”‚   â”‚  â€¢ Curve25519 (X25519): 32-byte keys, constant-time                              â”‚  â”‚
â”‚   â”‚  â€¢ P-384 (secp384r1): 48-byte keys, NIST approved                                â”‚  â”‚
â”‚   â”‚  â€¢ HKDF-SHA256 for key derivation                                                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                          â”‚
â”‚   Layer 5: Fully Homomorphic Encryption (Server-side Computation)                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  TFHE (WASM) / Concrete-Python / TenSEAL                                         â”‚  â”‚
â”‚   â”‚  â€¢ 2048-bit keys, 8192 polynomial degree                                         â”‚  â”‚
â”‚   â”‚  â€¢ 128-bit security level                                                        â”‚  â”‚
â”‚   â”‚  â€¢ Used for: Password strength check, encrypted search                           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 1. AES-256-GCM (Primary Vault Encryption)

| Parameter | Value | Description |
|-----------|-------|-------------|
| **Algorithm** | AES-256-GCM | Galois/Counter Mode with 256-bit key |
| **Key Size** | 256 bits (32 bytes) | Maximum AES key length |
| **Nonce/IV** | 96 bits (12 bytes) | Random per encryption |
| **Auth Tag** | 128 bits (16 bytes) | Integrity verification |
| **Block Size** | 128 bits | Standard AES block |
| **KDF** | Argon2id | Memory-hard key derivation |

```javascript
// Frontend: secureVaultCrypto.js - AES-256-GCM Encryption
async encrypt(data, options = {}) {
  const { compress = true, additionalData = null } = options;

  // Convert data to bytes
  let dataToEncrypt = typeof data === 'string' ? data : JSON.stringify(data);

  // Optional compression for large data (>1KB)
  if (compress && dataToEncrypt.length > 1024) {
    const compressed = await this._compress(dataToEncrypt);
    if (compressed.length < dataToEncrypt.length * 0.9) {
      dataToEncrypt = compressed;
    }
  }

  const encoder = new TextEncoder();
  const plaintextBytes = encoder.encode(dataToEncrypt);

  // Generate random 12-byte nonce (96 bits for AES-GCM)
  const nonce = window.crypto.getRandomValues(new Uint8Array(12));

  // Prepare Additional Authenticated Data (AAD) if provided
  const aadBytes = additionalData 
    ? encoder.encode(JSON.stringify(additionalData))
    : undefined;

  // Encrypt with AES-256-GCM using WebCrypto API
  const encryptedBuffer = await window.crypto.subtle.encrypt(
    {
      name: 'AES-GCM',
      iv: nonce,
      tagLength: 128,       // 128-bit authentication tag
      additionalData: aadBytes
    },
    this.encryptionKey,     // 256-bit key derived from Argon2id
    plaintextBytes
  );

  // Return encrypted package
  return {
    v: '2.0',                               // Encryption version
    alg: 'AES-256-GCM-ARGON2ID',           // Algorithm identifier
    nonce: this._bytesToBase64(nonce),      // Base64-encoded nonce
    ct: this._bytesToBase64(new Uint8Array(encryptedBuffer)),  // Ciphertext
    compressed: compress && dataToEncrypt.length > 1024,
    ts: Date.now()                          // Timestamp
  };
}
```

```javascript
// Frontend: secureVaultCrypto.js - AES-256-GCM Decryption
async decrypt(encryptedPackage, options = {}) {
  const { additionalData = null } = options;

  // Handle legacy format
  if (typeof encryptedPackage === 'string') {
    encryptedPackage = JSON.parse(encryptedPackage);
  }

  // Extract nonce and ciphertext
  const nonce = this._base64ToBytes(encryptedPackage.nonce);
  const ciphertext = this._base64ToBytes(encryptedPackage.ct);

  // Prepare AAD if required
  const encoder = new TextEncoder();
  const aadBytes = additionalData 
    ? encoder.encode(JSON.stringify(additionalData))
    : undefined;

  // Decrypt with AES-GCM
  const decryptedBuffer = await window.crypto.subtle.decrypt(
    {
      name: 'AES-GCM',
      iv: nonce,
      tagLength: 128,
      additionalData: aadBytes
    },
    this.encryptionKey,
    ciphertext
  );

  const decoder = new TextDecoder();
  let decryptedData = decoder.decode(decryptedBuffer);

  // Decompress if needed
  if (encryptedPackage.compressed) {
    decryptedData = await this._decompress(decryptedData);
  }

  return JSON.parse(decryptedData);
}
```

---

#### 2. XChaCha20-Poly1305 (Alternative AEAD)

| Parameter | Value | Description |
|-----------|-------|-------------|
| **Algorithm** | XChaCha20-Poly1305 | Extended nonce ChaCha20 with Poly1305 MAC |
| **Key Size** | 256 bits (32 bytes) | ChaCha20 key length |
| **Nonce** | 192 bits (24 bytes) | Extended nonce (safer for random generation) |
| **MAC** | 128 bits (16 bytes) | Poly1305 authentication tag |
| **Use Case** | File encryption, streaming | Better random nonce safety |

```javascript
// Frontend: xchachaEncryption.js - XChaCha20-Poly1305 Encryption
async encrypt(keyBuffer, plaintext, associatedData = null) {
  // Convert plaintext to ArrayBuffer
  const plaintextBuffer = typeof plaintext === 'string'
    ? new TextEncoder().encode(plaintext)
    : plaintext;

  // Generate 12-byte nonce (falls back to AES-GCM in browser)
  const nonce = window.crypto.getRandomValues(new Uint8Array(12));

  // Import key for AES-GCM (browser fallback)
  const cryptoKey = await window.crypto.subtle.importKey(
    'raw',
    keyBuffer,
    { name: 'AES-GCM' },
    false,
    ['encrypt', 'decrypt']
  );

  // Encrypt data with 128-bit authentication tag
  const ciphertext = await window.crypto.subtle.encrypt(
    {
      name: 'AES-GCM',
      iv: nonce,
      tagLength: 128,
      additionalData: associatedData 
        ? new TextEncoder().encode(associatedData) 
        : undefined
    },
    cryptoKey,
    plaintextBuffer
  );

  return {
    ciphertext: this.arrayBufferToBase64(ciphertext),
    nonce: this.arrayBufferToBase64(nonce),
    algorithm: 'XChaCha20-Poly1305',     // Logical algorithm
    actualAlgorithm: 'AES-256-GCM',       // Browser implementation
    version: '1.0'
  };
}

// File Encryption with Streaming (64KB chunks)
async encryptFile(keyBuffer, file, progressCallback = null) {
  const CHUNK_SIZE = 64 * 1024;  // 64 KB chunks
  const chunks = [];
  const masterNonce = this.generateNonce(12);
  
  let offset = 0;
  let chunkNumber = 0;
  
  while (offset < file.size) {
    const chunk = file.slice(offset, offset + CHUNK_SIZE);
    const chunkBuffer = await chunk.arrayBuffer();
    
    // Derive chunk-specific nonce
    const chunkNonceExtra = new Uint8Array([chunkNumber]);
    const chunkNonce = new Uint8Array([...masterNonce, ...chunkNonceExtra]);
    
    // Encrypt chunk
    const encrypted = await this.encrypt(keyBuffer, chunkBuffer, null);
    chunks.push(encrypted);
    
    offset += CHUNK_SIZE;
    chunkNumber++;
    
    if (progressCallback) {
      progressCallback(Math.round((offset / file.size) * 100));
    }
  }
  
  return {
    chunks,
    masterNonce: this.arrayBufferToBase64(masterNonce),
    originalSize: file.size,
    chunkSize: CHUNK_SIZE,
    fileName: file.name,
    fileType: file.type
  };
}
```

---

#### 3. CRYSTALS-Kyber-768 (Post-Quantum KEM)

| Parameter | Value | Description |
|-----------|-------|-------------|
| **Algorithm** | CRYSTALS-Kyber-768 | NIST PQC Standard (FIPS 203) |
| **Security Level** | NIST Level 3 | ~AES-192 equivalent |
| **Public Key** | 1184 bytes | Kyber-768 public key |
| **Private Key** | 2400 bytes | Kyber-768 secret key |
| **Ciphertext** | 1088 bytes | Encapsulated ciphertext |
| **Shared Secret** | 32 bytes | Derived shared secret |
| **Hybrid Mode** | Kyber + X25519 | Defense in depth |

```javascript
// Frontend: kyberService.js - Hybrid Post-Quantum Key Generation
async generateHybridKeypair() {
  await this.ensureInitialized();

  // Generate Kyber-768 keypair
  let kyberKeypair = null;
  if (!this.useFallback && this.kyberModule) {
    const { publicKey, secretKey } = await this.kyberModule.keypair();
    kyberKeypair = {
      publicKey: new Uint8Array(publicKey),
      secretKey: new Uint8Array(secretKey)
    };
  }

  // Generate X25519 keypair (always available)
  const x25519Keypair = this._generateX25519Keypair();

  // Return hybrid keypair
  return {
    kyber: kyberKeypair,
    x25519: x25519Keypair,
    algorithm: this.useFallback ? 'X25519' : 'Kyber768+X25519',
    securityLevel: this.useFallback ? 'classical' : 'post-quantum',
    timestamp: Date.now()
  };
}

// Hybrid Encapsulation (KEM + ECDH)
async hybridEncapsulate(recipientPublicKeys) {
  await this.ensureInitialized();
  const startTime = performance.now();

  let kyberResult = null;
  let x25519Result = null;

  // Kyber-768 encapsulation
  if (!this.useFallback && this.kyberModule && recipientPublicKeys.kyber) {
    const { ciphertext, sharedSecret } = await this.kyberModule.encapsulate(
      recipientPublicKeys.kyber.publicKey
    );
    kyberResult = {
      ciphertext: new Uint8Array(ciphertext),
      sharedSecret: new Uint8Array(sharedSecret)
    };
  }

  // X25519 key agreement (always performed)
  if (recipientPublicKeys.x25519) {
    const ephemeralKeypair = this._generateX25519Keypair();
    const sharedSecret = x25519.scalarMult(
      ephemeralKeypair.secretKey,
      recipientPublicKeys.x25519.publicKey
    );
    x25519Result = {
      publicKey: ephemeralKeypair.publicKey,
      sharedSecret: sharedSecret
    };
  }

  // Combine shared secrets using HKDF-SHA256
  const combinedSecret = await this._combineSharedSecrets(
    kyberResult?.sharedSecret,
    x25519Result?.sharedSecret
  );

  // Update metrics
  const encapsulateTime = performance.now() - startTime;
  this.metrics.encapsulations++;
  this.metrics.averageEncapsulateTime = 
    (this.metrics.averageEncapsulateTime * (this.metrics.encapsulations - 1) + encapsulateTime) 
    / this.metrics.encapsulations;

  return {
    kyber: kyberResult ? { ciphertext: kyberResult.ciphertext } : null,
    x25519: x25519Result ? { publicKey: x25519Result.publicKey } : null,
    sharedSecret: combinedSecret,
    algorithm: kyberResult ? 'Kyber768+X25519' : 'X25519',
    timing: encapsulateTime
  };
}

// Hybrid Decapsulation
async hybridDecapsulate(encapsulatedData, ourPrivateKeys) {
  await this.ensureInitialized();

  let kyberSecret = null;
  let x25519Secret = null;

  // Kyber-768 decapsulation
  if (!this.useFallback && this.kyberModule && encapsulatedData.kyber && ourPrivateKeys.kyber) {
    const sharedSecret = await this.kyberModule.decapsulate(
      encapsulatedData.kyber.ciphertext,
      ourPrivateKeys.kyber.secretKey
    );
    kyberSecret = new Uint8Array(sharedSecret);
  }

  // X25519 key agreement
  if (encapsulatedData.x25519 && ourPrivateKeys.x25519) {
    x25519Secret = x25519.scalarMult(
      ourPrivateKeys.x25519.secretKey,
      encapsulatedData.x25519.publicKey
    );
  }

  // Combine shared secrets
  return await this._combineSharedSecrets(kyberSecret, x25519Secret);
}

// Combine Kyber + X25519 shared secrets using HKDF
async _combineSharedSecrets(kyberSecret, x25519Secret) {
  const combined = new Uint8Array(
    (kyberSecret?.length || 0) + (x25519Secret?.length || 0)
  );
  
  let offset = 0;
  if (kyberSecret) {
    combined.set(kyberSecret, offset);
    offset += kyberSecret.length;
  }
  if (x25519Secret) {
    combined.set(x25519Secret, offset);
  }

  // Derive final key using HKDF-SHA256
  const info = new TextEncoder().encode('SecureVault-Hybrid-KEM-v1');
  return hash(combined, { dkLen: 32 }); // 256-bit derived key
}
```

```python
# Backend: kyber_crypto.py - Production Kyber Implementation
class ProductionKyber:
    """
    Production-ready CRYSTALS-Kyber implementation.
    Uses liboqs-python or pqcrypto for real post-quantum cryptography.
    """
    
    # Key sizes for CRYSTALS-Kyber-768 (NIST Level 3)
    PUBLIC_KEY_SIZE = 1184
    PRIVATE_KEY_SIZE = 2400
    CIPHERTEXT_SIZE = 1088
    SHARED_SECRET_SIZE = 32
    
    def generate_keypair(self) -> Tuple[bytes, bytes]:
        """Generate CRYSTALS-Kyber-768 keypair."""
        if self.implementation == 'liboqs':
            kem = oqs.KeyEncapsulation("Kyber768")
            public_key = kem.generate_keypair()
            private_key = kem.export_secret_key()
            return public_key, private_key
        elif self.implementation == 'pqcrypto':
            return pqcrypto_kyber.generate_keypair()
    
    def encapsulate(self, public_key: bytes) -> Tuple[bytes, bytes]:
        """Encapsulate a shared secret using recipient's public key."""
        if self.implementation == 'liboqs':
            kem = oqs.KeyEncapsulation("Kyber768")
            ciphertext, shared_secret = kem.encap_secret(public_key)
            return ciphertext, shared_secret
        elif self.implementation == 'pqcrypto':
            return pqcrypto_kyber.encrypt(public_key)
    
    def decapsulate(self, ciphertext: bytes, private_key: bytes) -> bytes:
        """Decapsulate shared secret using private key."""
        if self.implementation == 'liboqs':
            kem = oqs.KeyEncapsulation("Kyber768", private_key)
            return kem.decap_secret(ciphertext)
        elif self.implementation == 'pqcrypto':
            return pqcrypto_kyber.decrypt(private_key, ciphertext)
```

---

#### 4. Hybrid Elliptic Curve Cryptography (ECC)

| Curve | Key Size | Use Case | Standard |
|-------|----------|----------|----------|
| **Curve25519 (X25519)** | 32 bytes | ECDH key agreement | djb/Bernstein |
| **P-384 (secp384r1)** | 48 bytes | ECDH key agreement | NIST FIPS 186-4 |
| **Ed25519** | 32 bytes | Digital signatures | EdDSA |

```javascript
// Frontend: eccService.js - Hybrid ECC Implementation
export class ECCService {
  constructor() {
    this.CURVE25519_KEY_SIZE = 32;  // bytes
    this.P384_KEY_SIZE = 48;         // bytes (384 bits)
  }

  // Generate hybrid keypair (both curves)
  generateHybridKeyPair() {
    const curve25519Pair = this.generateCurve25519KeyPair();
    const p384Pair = this.generateP384KeyPair();
    
    return {
      curve25519: curve25519Pair,
      p384: p384Pair,
      type: 'hybrid-ecdh',
      version: 2
    };
  }

  // Perform Curve25519 ECDH
  performCurve25519ECDH(privateKey, publicKey) {
    return x25519.getSharedSecret(privateKey, publicKey);
  }

  // Perform P-384 ECDH
  performP384ECDH(privateKey, publicKey) {
    return p384.getSharedSecret(privateKey, publicKey);
  }

  // Combine secrets from both curves using HKDF
  async deriveHybridSharedSecret(ourKeys, peerKeys, context = 'SecureVault-ECC-v2') {
    // Perform ECDH with both curves
    const secret1 = this.performCurve25519ECDH(
      ourKeys.curve25519.privateKey,
      peerKeys.curve25519
    );
    
    const secret2 = this.performP384ECDH(
      ourKeys.p384.privateKey,
      peerKeys.p384
    );

    // Combine secrets
    const combined = new Uint8Array(secret1.length + secret2.length);
    combined.set(secret1, 0);
    combined.set(secret2, secret1.length);

    // Derive final key using HKDF-SHA256
    const info = new TextEncoder().encode(context);
    return hkdf(sha256, combined, undefined, info, 32);
  }
}
```

---

#### 5. Fully Homomorphic Encryption (FHE)

| Parameter | Value | Description |
|-----------|-------|-------------|
| **Implementation** | TFHE (WASM) / Concrete-Python / TenSEAL | Multiple FHE backends |
| **Key Size** | 2048 bits | FHE encryption key |
| **Polynomial Degree** | 8192 | Lattice polynomial |
| **Security Level** | 128 bits | Post-quantum secure |
| **Use Cases** | Password strength check, encrypted search | Server-side computation |

```javascript
// Frontend: fheService.js - FHE Client Operations
class FHEService {
  constructor() {
    this.KEY_SIZE = 2048;
    this.POLYNOMIAL_DEGREE = 8192;
    this.SECURITY_LEVEL = 128;
  }

  // Initialize TFHE WASM module
  async initialize() {
    try {
      // Attempt to load TFHE WebAssembly module
      const tfhe = await loadTFHE();
      if (tfhe) {
        this._tfheModule = tfhe;
        this.wasmLoaded = true;
      }
      
      // Load or generate keys
      await this._initializeKeys();
      this.initialized = true;
      
      return true;
    } catch (error) {
      // Fall back to simulated FHE for development
      this.wasmLoaded = false;
      this.initialized = true;
      return true;
    }
  }

  // Encrypt password for FHE operations
  async encryptPassword(password, options = {}) {
    if (!this.initialized) await this.initialize();

    const { tier = EncryptionTier.HYBRID_FHE } = options;

    // For client-only tier, use local encryption
    if (tier === EncryptionTier.CLIENT_ONLY) {
      return this._clientOnlyEncrypt(password);
    }

    // For hybrid/full FHE, use backend service
    const response = await api.post(FHE_CONFIG.ENDPOINTS.ENCRYPT, {
      data: this._prepareForEncryption(password),
      tier: tier,
      operation: FHE_CONFIG.OPERATIONS.PASSWORD_SEARCH
    });

    return response.data;
  }

  // Check password strength on encrypted data
  async checkStrength(encryptedPassword) {
    const response = await api.post(FHE_CONFIG.ENDPOINTS.STRENGTH_CHECK, {
      encrypted_password: encryptedPassword,
      return_details: true
    });

    return {
      strength: response.data.strength_score,
      entropy: response.data.entropy,
      feedback: response.data.feedback,
      computation_time: response.data.computation_time_ms
    };
  }
}
```

```python
# Backend: fhe_service/services/concrete_service.py - FHE Server Operations
class ConcreteFHEService:
    """
    Lightweight FHE operations using Concrete-Python.
    Optimized for single-value operations like password strength.
    """
    
    def __init__(self):
        self.circuit = None
        self.initialized = False
    
    def encrypt_password(self, password: str) -> bytes:
        """Encrypt password for FHE operations."""
        # Convert password to numerical representation
        password_values = [ord(c) for c in password[:32]]
        
        # Encrypt using Concrete
        encrypted = self.circuit.encrypt(password_values)
        return encrypted
    
    def compute_strength_encrypted(self, encrypted_password: bytes) -> int:
        """
        Compute password strength on encrypted data.
        Server never sees the plaintext password!
        """
        # Run FHE circuit
        result = self.circuit.run(encrypted_password)
        
        # Decrypt result (strength score only)
        strength_score = self.circuit.decrypt(result)
        return strength_score
```

---

### Algorithm Comparison Matrix

| Algorithm | Key Size | Security | Quantum-Safe | Speed | Use Case |
|-----------|----------|----------|--------------|-------|----------|
| **AES-256-GCM** | 256-bit | 256-bit | âŒ No | âš¡ Very Fast | Primary vault encryption |
| **XChaCha20-Poly1305** | 256-bit | 256-bit | âŒ No | âš¡ Very Fast | File/stream encryption |
| **Kyber-768** | 1184/2400 bytes | NIST L3 | âœ… Yes | ğŸ”µ Fast | Post-quantum KEM |
| **X25519** | 32 bytes | 128-bit | âŒ No | âš¡ Very Fast | Classical ECDH |
| **P-384** | 48 bytes | 192-bit | âŒ No | ğŸ”µ Fast | Enterprise ECDH |
| **TFHE** | 2048-bit | 128-bit | âœ… Yes | ğŸ”´ Slow | Encrypted computation |
| **Argon2id** | N/A | Memory-hard | âœ… Yes | ğŸ”µ Configurable | Key derivation |

---

### Encrypted Data Package Format

```json
{
  "v": "2.0",                           // Encryption version
  "alg": "AES-256-GCM-ARGON2ID",       // Algorithm identifier
  "nonce": "base64(12-bytes)",          // Random nonce/IV
  "ct": "base64(ciphertext+tag)",       // Ciphertext with auth tag
  "compressed": true,                   // Compression flag
  "ts": 1699999999999,                  // Timestamp
  "aad": true,                          // Additional authenticated data flag
  "kdf": {                              // Key derivation parameters
    "type": "argon2id",
    "time": 4,
    "mem": 131072,
    "parallelism": 2
  }
}
```

### Key Derivation Function (Argon2id)

SecureVault uses **Argon2id** (PHC winner, OWASP 2024 recommended) with adaptive parameters based on device capability.

> **Note:** SecureVault has TWO crypto services with slightly different Argon2id parameters:
> - `secureVaultCrypto.js` (v2.0) - 64-byte hash with key splitting (recommended for new implementations)
> - `cryptoService.js` (legacy-compatible) - 32-byte hash, different memory parameters per tier

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ARGON2ID KEY DERIVATION (Adaptive)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                  â”‚
â”‚    Master Password              User-Specific Salt                                              â”‚
â”‚           â”‚                           â”‚                                                          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â”‚
â”‚                       â”‚                                                                          â”‚
â”‚                       â–¼                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚                              ARGON2ID v1.3                                               â”‚  â”‚
â”‚    â”‚                                                                                          â”‚  â”‚
â”‚    â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚  â”‚
â”‚    â”‚   â•‘  secureVaultCrypto.js (v2.0) - Key Splitting Mode                                â•‘  â”‚  â”‚
â”‚    â”‚   â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£  â”‚  â”‚
â”‚    â”‚   â•‘  High-End (8GB+ RAM, 4+ cores):                                                  â•‘  â”‚  â”‚
â”‚    â”‚   â•‘    Memory: 128 MB | Iterations: 4 | Parallelism: 4 | Hash: 64 bytes â†’ split     â•‘  â”‚  â”‚
â”‚    â”‚   â•‘                                                                                  â•‘  â”‚  â”‚
â”‚    â”‚   â•‘  Mid-Range (4GB+ RAM, 2+ cores):                                                 â•‘  â”‚  â”‚
â”‚    â”‚   â•‘    Memory: 64 MB  | Iterations: 3 | Parallelism: 2 | Hash: 64 bytes â†’ split     â•‘  â”‚  â”‚
â”‚    â”‚   â•‘                                                                                  â•‘  â”‚  â”‚
â”‚    â”‚   â•‘  Low-End (mobile, <4GB RAM):                                                     â•‘  â”‚  â”‚
â”‚    â”‚   â•‘    Memory: 32 MB  | Iterations: 2 | Parallelism: 1 | Hash: 64 bytes â†’ split     â•‘  â”‚  â”‚
â”‚    â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚  â”‚
â”‚    â”‚                                                                                          â”‚  â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚    â”‚   â”‚  cryptoService.js (Legacy-Compatible) - Single Key Mode                          â”‚  â”‚  â”‚
â”‚    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚    â”‚   â”‚  High-End (8GB+ RAM, 4+ cores):                                                  â”‚  â”‚  â”‚
â”‚    â”‚   â”‚    Memory: 128 MB | Iterations: 4 | Parallelism: 2 | Hash: 32 bytes             â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                                                                                  â”‚  â”‚  â”‚
â”‚    â”‚   â”‚  Mid-Range (4GB+ RAM, 2+ cores):                                                 â”‚  â”‚  â”‚
â”‚    â”‚   â”‚    Memory: 96 MB  | Iterations: 4 | Parallelism: 2 | Hash: 32 bytes             â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                                                                                  â”‚  â”‚  â”‚
â”‚    â”‚   â”‚  Low-End (mobile, <4GB RAM):                                                     â”‚  â”‚  â”‚
â”‚    â”‚   â”‚    Memory: 64 MB  | Iterations: 3 | Parallelism: 1 | Hash: 32 bytes             â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                                                                                  â”‚  â”‚  â”‚
â”‚    â”‚   â”‚  Legacy (v1 compatibility):                                                      â”‚  â”‚  â”‚
â”‚    â”‚   â”‚    Memory: 64 MB  | Iterations: 10 | Parallelism: 1 | Hash: 32 bytes            â”‚  â”‚  â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚    â”‚                                                                                          â”‚  â”‚
â”‚    â”‚   Fixed Parameters (Both Services):                                                     â”‚  â”‚
â”‚    â”‚     Type: Argon2id (hybrid: data-dependent + independent addressing)                    â”‚  â”‚
â”‚    â”‚     Version: 0x13 (v1.3)                                                                â”‚  â”‚
â”‚    â”‚     Salt Length: 16-32 bytes (depending on service)                                     â”‚  â”‚
â”‚    â”‚                                                                                          â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â”‚                                                              â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚           â”‚                                               â”‚                                     â”‚
â”‚           â–¼                                               â–¼                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚    â”‚   secureVaultCrypto.js (v2.0)   â”‚    â”‚   cryptoService.js (Legacy)     â”‚                  â”‚
â”‚    â”‚                                 â”‚    â”‚                                 â”‚                  â”‚
â”‚    â”‚   64-byte derived hash          â”‚    â”‚   32-byte derived hash          â”‚                  â”‚
â”‚    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚    â”‚   â”‚                             â”‚                  â”‚
â”‚    â”‚   â–¼          â–¼                  â”‚    â”‚   â–¼                             â”‚                  â”‚
â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                  â”‚
â”‚    â”‚ â”‚Encryptionâ”‚ â”‚  Auth    â”‚       â”‚    â”‚ â”‚ Single AES-256   â”‚            â”‚                  â”‚
â”‚    â”‚ â”‚   Key    â”‚ â”‚   Key    â”‚       â”‚    â”‚ â”‚  Encryption Key  â”‚            â”‚                  â”‚
â”‚    â”‚ â”‚(32 bytes)â”‚ â”‚(32 bytes)â”‚       â”‚    â”‚ â”‚   (32 bytes)     â”‚            â”‚                  â”‚
â”‚    â”‚ â”‚ AES-GCM  â”‚ â”‚HMAC-SHA256â”‚      â”‚    â”‚ â”‚  AES-GCM/CBC     â”‚            â”‚                  â”‚
â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Parameter Comparison Table

| Service | Tier | Memory | Iterations | Parallelism | Hash Length | Key Split |
|---------|------|--------|------------|-------------|-------------|-----------|
| **secureVaultCrypto.js** | High | 128 MB | 4 | 4 | 64 bytes | âœ… Yes |
| **secureVaultCrypto.js** | Medium | 64 MB | 3 | 2 | 64 bytes | âœ… Yes |
| **secureVaultCrypto.js** | Low | 32 MB | 2 | 1 | 64 bytes | âœ… Yes |
| **cryptoService.js** | High | 128 MB | 4 | 2 | 32 bytes | âŒ No |
| **cryptoService.js** | Medium | 96 MB | 4 | 2 | 32 bytes | âŒ No |
| **cryptoService.js** | Low | 64 MB | 3 | 1 | 32 bytes | âŒ No |
| **cryptoService.js** | Legacy | 64 MB | 10 | 1 | 32 bytes | âŒ No |

---

### CryptoService.js - Complete Client-Side Encryption Service

`cryptoService.js` is the **primary encryption service** for SecureVault, implementing a zero-knowledge architecture where all cryptographic operations occur exclusively in the browser.

#### Service Overview

| Feature | Description |
|---------|-------------|
| **File** | `frontend/src/services/cryptoService.js` |
| **Size** | 454 lines |
| **Purpose** | Zero-knowledge client-side encryption |
| **Dependencies** | `crypto-js`, `pako`, `argon2-browser` |
| **Primary Encryption** | AES-256-GCM (WebCrypto) / AES-256-CBC (CryptoJS fallback) |
| **KDF** | Argon2id with PBKDF2-SHA256 fallback |
| **Compression** | Gzip via pako (for data > 1KB) |

#### Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CryptoService.js Architecture                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                       INITIALIZATION                                 â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚   new CryptoService(masterPassword)                                 â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º Store master password in memory                               â”‚   â”‚
â”‚   â”‚   â””â”€â–º Initialize SubtleCrypto API reference                         â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    DEVICE CAPABILITY DETECTION                       â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚   getDeviceCapabilities()                                            â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º navigator.deviceMemory (RAM in GB)                            â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º navigator.hardwareConcurrency (CPU cores)                     â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚   â”‚
â”‚   â”‚   â””â”€â–º Returns: 'high' | 'medium' | 'low'                            â”‚   â”‚
â”‚   â”‚       â€¢ high:   8GB+ RAM, 4+ cores                                  â”‚   â”‚
â”‚   â”‚       â€¢ medium: 4GB+ RAM, 2+ cores                                  â”‚   â”‚
â”‚   â”‚       â€¢ low:    <4GB RAM or <2 cores                                â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    KEY DERIVATION FLOW                               â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚   deriveKey(salt, cryptoVersion)                                    â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º Primary: Argon2id (argon2-browser)                            â”‚   â”‚
â”‚   â”‚   â”‚   â€¢ time:        3-4 iterations (adaptive)                      â”‚   â”‚
â”‚   â”‚   â”‚   â€¢ mem:         64-128 MB (adaptive)                           â”‚   â”‚
â”‚   â”‚   â”‚   â€¢ hashLen:     32 bytes                                       â”‚   â”‚
â”‚   â”‚   â”‚   â€¢ parallelism: 1-2 (adaptive)                                 â”‚   â”‚
â”‚   â”‚   â”‚   â€¢ type:        Argon2id                                       â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚   â”‚
â”‚   â”‚   â””â”€â–º Fallback: PBKDF2-HMAC-SHA256 (CryptoJS)                       â”‚   â”‚
â”‚   â”‚       â€¢ iterations:  600,000                                        â”‚   â”‚
â”‚   â”‚       â€¢ keySize:     256 bits                                       â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     ENCRYPTION METHODS                               â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚   encrypt(data, salt)          â”‚    legacyEncrypt(data, key)        â”‚   â”‚
â”‚   â”‚   â”‚                            â”‚    â”‚                                â”‚   â”‚
â”‚   â”‚   â”‚ WebCrypto API (primary)    â”‚    â”‚ CryptoJS (fallback)           â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ AES-256-GCM              â”‚    â”‚ â€¢ AES-256-CBC                  â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ 12-byte random IV        â”‚    â”‚ â€¢ 16-byte random IV           â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Hardware-accelerated     â”‚    â”‚ â€¢ PKCS7 padding               â”‚   â”‚
â”‚   â”‚   â”‚                            â”‚    â”‚ â€¢ Optional gzip compression   â”‚   â”‚
â”‚   â”‚   â”‚                            â”‚    â”‚                                â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                                â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     DECRYPTION METHODS                               â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚   decrypt(encryptedData, key)                                       â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º Parse JSON payload {iv, data, compressed, version}            â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º AES-256-CBC decrypt with CryptoJS                             â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º Decompress if compressed flag is true                         â”‚   â”‚
â”‚   â”‚   â””â”€â–º Return parsed JSON object                                     â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Complete API Reference

```javascript
/**
 * CryptoService - Zero-Knowledge Client-Side Encryption
 * 
 * ZERO-KNOWLEDGE SECURITY MODEL:
 * 1. All encryption/decryption happens exclusively in the browser
 * 2. The server never receives plaintext data or encryption keys
 * 3. The master password never leaves the client
 * 4. Only encrypted data is transmitted to and stored on the server
 * 5. Recovery keys provide an alternative decryption path
 */
export class CryptoService {
  constructor(masterPassword) {
    this.masterPassword = masterPassword;
    this.subtle = window.crypto.subtle;
  }
}
```

#### Method: Device Capability Detection

```javascript
// cryptoService.js - Device capability detection for adaptive Argon2id
getDeviceCapabilities() {
  // Check device RAM and CPU cores
  const memory = navigator.deviceMemory || 4;  // GB, default 4GB
  const cores = navigator.hardwareConcurrency || 1;
  
  // Categorize device capability
  if (memory >= 8 && cores >= 4) {
    return 'high';    // Desktop/high-end laptop
  } else if (memory >= 4 && cores >= 2) {
    return 'medium';  // Mid-range device
  } else {
    return 'low';     // Low-end mobile
  }
}
```

#### Method: Argon2id Parameters

```javascript
// cryptoService.js - Adaptive Argon2id parameters
getArgon2Params(deviceCapability = null) {
  const capability = deviceCapability || this.getDeviceCapabilities();
  
  const params = {
    high: {
      time: 4,           // 4 iterations
      mem: 131072,       // 128 MB memory
      parallelism: 2,    // 2 threads
      version: 2
    },
    medium: {
      time: 4,           // 4 iterations
      mem: 98304,        // 96 MB memory (NOTE: different from secureVaultCrypto!)
      parallelism: 2,    // 2 threads
      version: 2
    },
    low: {
      time: 3,           // 3 iterations
      mem: 65536,        // 64 MB memory
      parallelism: 1,    // 1 thread
      version: 2
    },
    legacy: {            // v1 backward compatibility
      time: 10,          // 10 iterations (higher for older params)
      mem: 65536,        // 64 MB memory
      parallelism: 1,    // 1 thread
      version: 1
    }
  };
  
  return params[capability] || params.medium;
}
```

#### Method: Key Derivation (Argon2id + PBKDF2 Fallback)

```javascript
// cryptoService.js - Key derivation with Argon2id
async deriveKey(salt, cryptoVersion = 2) {
  // SECURITY NOTE: Key derivation happens client-side for zero-knowledge
  try {
    const saltArr = typeof salt === 'string' 
      ? CryptoJS.enc.Base64.parse(salt).toString(CryptoJS.enc.Hex)
      : salt;
    
    // Get parameters based on crypto version and device capability
    const params = cryptoVersion === 1 
      ? this.getArgon2Params('legacy')
      : this.getArgon2Params();
    
    console.log(`Deriving key with Argon2id v${cryptoVersion}:`, {
      time: params.time,
      mem: `${params.mem / 1024} MB`,
      parallelism: params.parallelism
    });
    
    // Argon2id hash
    const result = await argon2.hash({
      pass: this.masterPassword,
      salt: saltArr,
      time: params.time,
      mem: params.mem,
      hashLen: 32,                      // 32 bytes (256 bits) for AES-256
      parallelism: params.parallelism,
      type: argon2.ArgonType.Argon2id   // Use Argon2id variant
    });

    // Return base64 encoded hash for AES encryption
    return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Hex.parse(result.hashHex));
    
  } catch (error) {
    console.error('Argon2 key derivation failed, falling back to PBKDF2:', error);
    
    // Fallback to PBKDF2 with 600,000 iterations (OWASP minimum)
    const key = CryptoJS.PBKDF2(this.masterPassword, salt, {
      keySize: 256/32,      // 256 bits
      iterations: 600000,   // 600k iterations
      hasher: CryptoJS.algo.SHA256
    });
    return key.toString(CryptoJS.enc.Base64);
  }
}
```

#### Method: WebCrypto Encryption (Primary)

```javascript
// cryptoService.js - WebCrypto AES-256-GCM encryption
async encrypt(data, salt) {
  try {
    // Derive CryptoKey using PBKDF2 (WebCrypto native)
    const key = await this.getCryptoKey(salt);
    
    // Generate 12-byte random IV (96 bits for AES-GCM)
    const iv = window.crypto.getRandomValues(new Uint8Array(12));
    
    // Convert data to ArrayBuffer
    const encoder = new TextEncoder();
    const dataToEncrypt = encoder.encode(JSON.stringify(data));
    
    // Encrypt with AES-256-GCM (authenticated encryption)
    const encryptedData = await this.subtle.encrypt(
      { name: 'AES-GCM', iv },
      key,
      dataToEncrypt
    );
    
    // Package result
    const result = {
      iv: Array.from(iv).map(b => String.fromCharCode(b)).join(''),
      data: Array.from(new Uint8Array(encryptedData)).map(b => String.fromCharCode(b)).join(''),
      version: 'webcrypto-1',
      usingHardwareEncryption: navigator.credentials && !!navigator.credentials.preventSilentAccess
    };
    
    return btoa(JSON.stringify(result));
    
  } catch (error) {
    console.error('WebCrypto encryption failed, falling back to CryptoJS:', error);
    return this.legacyEncrypt(data, salt);
  }
}
```

#### Method: Legacy Encryption (CryptoJS Fallback)

```javascript
// cryptoService.js - CryptoJS AES-256-CBC encryption with compression
async legacyEncrypt(data, key) {
  // SECURITY NOTE: Encryption occurs client-side only
  
  let dataToEncrypt = data;
  let compressed = false;
  
  // Compress large data (>1KB) using gzip
  const jsonData = JSON.stringify(data);
  if (jsonData.length > 1024) {
    try {
      const compressedData = pako.deflate(jsonData);
      if (compressedData.length < jsonData.length) {
        dataToEncrypt = compressedData;
        compressed = true;
      }
    } catch (error) {
      console.warn('Compression failed, using uncompressed data', error);
    }
  }
  
  // Generate 16-byte random IV
  const iv = CryptoJS.lib.WordArray.random(16);
  
  // Encrypt with AES-256-CBC
  const dataToProcess = compressed 
    ? CryptoJS.lib.WordArray.create(dataToEncrypt)
    : JSON.stringify(dataToEncrypt);
  
  const encrypted = CryptoJS.AES.encrypt(dataToProcess, key, {
    iv: iv,
    mode: CryptoJS.mode.CBC,
    padding: CryptoJS.pad.Pkcs7
  });
  
  // Return JSON payload
  return JSON.stringify({
    iv: iv.toString(CryptoJS.enc.Base64),
    data: encrypted.toString(),
    compressed: compressed
  });
}
```

#### Method: Decryption

```javascript
// cryptoService.js - AES-256-CBC decryption with decompression
async decrypt(encryptedData, key) {
  // SECURITY NOTE: Decryption occurs client-side - server never sees plaintext
  try {
    const payload = JSON.parse(encryptedData);
    
    if (!payload.iv || !payload.data) {
      throw new Error('Invalid encrypted data format');
    }
    
    // Parse IV from Base64
    const iv = CryptoJS.enc.Base64.parse(payload.iv);
    
    // Decrypt data
    const decrypted = CryptoJS.AES.decrypt(payload.data, key, {
      iv: iv,
      mode: CryptoJS.mode.CBC,
      padding: CryptoJS.pad.Pkcs7
    });
    
    // Handle decompression if data was compressed
    if (payload.compressed) {
      const decryptedBytes = this.convertWordArrayToUint8Array(decrypted);
      const decompressed = pako.inflate(decryptedBytes);
      const jsonStr = new TextDecoder().decode(decompressed);
      return JSON.parse(jsonStr);
    } else {
      const decryptedStr = decrypted.toString(CryptoJS.enc.Utf8);
      if (!decryptedStr) {
        throw new Error('Decryption failed - invalid key or corrupted data');
      }
      return JSON.parse(decryptedStr);
    }
    
  } catch (error) {
    console.error('Decryption error:', error.message);
    throw new Error('Failed to decrypt data: ' + error.message);
  }
}
```

#### Method: Recovery Key Derivation

```javascript
// cryptoService.js - Derive key from recovery key (alternative decryption path)
async deriveKeyFromRecoveryKey(recoveryKey, salt, iterations = 10) {
  // SECURITY NOTE: Recovery key derivation also happens client-side
  // Recovery keys maintain zero-knowledge while providing backup access
  try {
    // Remove hyphens from recovery key
    const cleanRecoveryKey = recoveryKey.replace(/-/g, '');
    
    const saltArr = typeof salt === 'string' 
      ? CryptoJS.enc.Base64.parse(salt).toString(CryptoJS.enc.Hex)
      : salt;
    
    const result = await argon2.hash({
      pass: cleanRecoveryKey,
      salt: saltArr,
      time: iterations,    // Lower iterations for recovery keys
      mem: 65536,          // 64 MB memory
      hashLen: 32,         // 32 bytes output
      parallelism: 1,
      type: argon2.ArgonType.Argon2id
    });

    return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Hex.parse(result.hashHex));
    
  } catch (error) {
    console.error('Argon2 recovery key derivation failed:', error);
    
    // Fallback to PBKDF2
    const key = CryptoJS.PBKDF2(
      recoveryKey.replace(/-/g, ''),
      salt, 
      {
        keySize: 256/32,
        iterations: 600000,
        hasher: CryptoJS.algo.SHA256
      }
    );
    return key.toString(CryptoJS.enc.Base64);
  }
}
```

#### Method: Secure Password Generation

```javascript
// cryptoService.js - Cryptographically secure password generation
generatePassword(length = 16, options = {
  uppercase: true,
  lowercase: true,
  numbers: true,
  symbols: true
}) {
  const chars = {
    uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
    lowercase: 'abcdefghijklmnopqrstuvwxyz',
    numbers: '0123456789',
    symbols: '!@#$%^&*()_+~`|}{[]:;?><,./-='
  };
  
  let charset = '';
  if (options.uppercase) charset += chars.uppercase;
  if (options.lowercase) charset += chars.lowercase;
  if (options.numbers) charset += chars.numbers;
  if (options.symbols) charset += chars.symbols;
  
  if (charset === '') {
    charset = chars.lowercase + chars.numbers;
  }
  
  // Use Web Crypto API for cryptographically secure random values
  let password = '';
  const randomValues = new Uint32Array(length);
  window.crypto.getRandomValues(randomValues);
  
  for (let i = 0; i < length; i++) {
    password += charset[randomValues[i] % charset.length];
  }
  
  return password;
}
```

#### Method: Secure Memory Clearing

```javascript
// cryptoService.js - Securely clear sensitive data from memory
clearKeys() {
  // SECURITY NOTE: Clear sensitive data when no longer needed
  this.masterPassword = null;
  this.encryptionKey = null;
  
  // Overwrite memory with random data
  const buf = new Uint8Array(1024);
  crypto.getRandomValues(buf);
  
  // Force garbage collection if available
  if (global.gc) global.gc();
}
```

#### Encrypted Data Format

```json
// WebCrypto format (version: 'webcrypto-1')
{
  "iv": "binary-string-12-bytes",
  "data": "binary-string-ciphertext",
  "version": "webcrypto-1",
  "usingHardwareEncryption": true
}

// Legacy CryptoJS format
{
  "iv": "base64-16-bytes",
  "data": "base64-ciphertext",
  "compressed": true|false
}
```

---

#### Argon2id Parameters (Code)

```javascript
// Frontend: secureVaultCrypto.js - Adaptive Argon2id Parameters
const ARGON2_PARAMS = {
  high: {     // Desktop/high-end laptop (8GB+ RAM, 4+ cores)
    time: 4,           // 4 iterations
    mem: 131072,       // 128 MB memory
    parallelism: 4     // 4 threads
  },
  medium: {   // Mid-range device (4GB+ RAM, 2+ cores)
    time: 3,           // 3 iterations
    mem: 65536,        // 64 MB memory
    parallelism: 2     // 2 threads
  },
  low: {      // Low-end/mobile (<4GB RAM)
    time: 2,           // 2 iterations
    mem: 32768,        // 32 MB memory
    parallelism: 1     // 1 thread
  },
};

// Detect device capability
_detectDeviceCapability() {
  const memory = navigator.deviceMemory || 4;  // GB
  const cores = navigator.hardwareConcurrency || 2;

  if (memory >= 8 && cores >= 4) return 'high';
  if (memory >= 4 && cores >= 2) return 'medium';
  return 'low';
}

// Derive key from master password
async deriveKeyFromPassword(masterPassword, salt) {
  const saltBytes = typeof salt === 'string' 
    ? this._base64ToBytes(salt) 
    : salt;
  
  const params = ARGON2_PARAMS[this.deviceCapability];
  
  console.log(`[SecureCrypto] Deriving key with Argon2id (${this.deviceCapability}):`, {
    time: params.time,
    memory: `${params.mem / 1024}MB`,
    parallelism: params.parallelism
  });

  // Use Argon2id for key derivation
  const result = await argon2.hash({
    pass: masterPassword,
    salt: this._bytesToHex(saltBytes),
    time: params.time,
    mem: params.mem,
    hashLen: 64,          // 512 bits for split key
    parallelism: params.parallelism,
    type: argon2.ArgonType.Argon2id
  });

  // Split derived key into encryption key (256 bits) and auth key (256 bits)
  const keyMaterial = this._hexToBytes(result.hashHex);
  const encKeyBytes = keyMaterial.slice(0, 32);   // First 32 bytes
  const authKeyBytes = keyMaterial.slice(32, 64); // Last 32 bytes

  // Import as CryptoKey for AES-GCM
  this.encryptionKey = await window.crypto.subtle.importKey(
    'raw',
    encKeyBytes,
    { name: 'AES-GCM', length: 256 },
    false,  // Not extractable
    ['encrypt', 'decrypt']
  );

  // Store auth key for HMAC operations
  this.authKey = await window.crypto.subtle.importKey(
    'raw',
    authKeyBytes,
    { name: 'HMAC', hash: 'SHA-256' },
    false,
    ['sign', 'verify']
  );

  // Secure memory wipe
  this._secureWipe(keyMaterial);
  this._secureWipe(encKeyBytes);
  this._secureWipe(authKeyBytes);

  return this.encryptionKey;
}
```

```python
# Backend: vault/crypto.py - Argon2id Key Derivation
from argon2 import PasswordHasher, Type
import argon2

def derive_key_from_password(password, salt, time_cost=4, memory_cost=131072, parallelism=2, crypto_version=2):
    """
    Derive encryption key using Argon2id (OWASP 2024 recommended)
    
    Args:
        password: User's master password
        salt: Cryptographic salt (16+ bytes)
        time_cost: Number of iterations (v2 default: 4)
        memory_cost: Memory usage in KiB (v2 default: 131072 = 128 MB)
        parallelism: Parallelism factor (v2 default: 2)
        crypto_version: Crypto version (1 = legacy, 2 = enhanced)
        
    Returns:
        bytes: Base64-encoded derived key
    """
    # Legacy parameters for backward compatibility
    if crypto_version == 1:
        time_cost = 3
        memory_cost = 65536   # 64 MB
        parallelism = 1
    
    ph = PasswordHasher(
        time_cost=time_cost,
        memory_cost=memory_cost,
        parallelism=parallelism,
        hash_len=32,          # 32 bytes for AES-256
        salt_len=16,
        type=argon2.Type.ID   # Argon2id for balanced security
    )
    
    # Hash password with salt
    key = ph.hash(password + salt.hex())
    
    # Derive final key using SHA-256 for consistent output
    return base64.urlsafe_b64encode(hashlib.sha256(key.encode()).digest())
```

#### PBKDF2 Fallback (Legacy Support)

When Argon2id is not available (older browsers), PBKDF2-HMAC-SHA256 is used:

```javascript
// Fallback to PBKDF2 with 600,000 iterations
async legacyDeriveKey(salt) {
  const key = CryptoJS.PBKDF2(this.masterPassword, salt, {
    keySize: 256/32,      // 256 bits
    iterations: 600000,   // OWASP 2024 minimum
    hasher: CryptoJS.algo.SHA256
  });
  return key.toString(CryptoJS.enc.Base64);
}
```

### Decryption Flow

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant S as Server
    participant DB as Database

    U->>C: Request vault item
    C->>S: GET /api/vault/items/{id}/
    S->>DB: Fetch encrypted blob
    DB->>S: {ciphertext, iv, tag, salt}
    S->>C: Return encrypted blob
    
    U->>C: Enter master password
    
    Note over C: Key Derivation
    C->>C: Argon2id(password, salt)
    
    Note over C: Decryption
    C->>C: Verify auth tag
    C->>C: AES-GCM-256 decrypt
    
    C->>U: Display plaintext
    
    Note over C: Plaintext only exists in browser memory
```

---

## ğŸ” Client-Side Encryption

SecureVault v2.0 introduces an enhanced client-side encryption system using the **WebCrypto API** for hardware-accelerated cryptographic operations.

### Implementation Components

| Component | File | Purpose |
|-----------|------|---------|
| **SecureVaultCrypto** | `services/secureVaultCrypto.js` | Core encryption/decryption with WebCrypto API |
| **SecureVaultService** | `services/secureVaultService.js` | Zero-knowledge vault operations |
| **useSecureVault** | `hooks/useSecureVault.js` | React hook for vault integration |

### SecureVaultCrypto Features

```javascript
// Client-side implementation (secureVaultCrypto.js)
export class SecureVaultCrypto {
  // Adaptive Argon2id parameters based on device capability
  static ARGON2_PARAMS = {
    high: { time: 4, mem: 131072, parallelism: 4 }, // 128MB for high-end
    medium: { time: 3, mem: 65536, parallelism: 2 }, // 64MB for mid-range
    low: { time: 2, mem: 32768, parallelism: 1 },    // 32MB for mobile
  };

  // Key derivation with hardware acceleration
  async deriveKeyFromPassword(masterPassword, salt) {
    const result = await argon2.hash({
      pass: masterPassword,
      salt: saltBytes,
      time: params.time,
      mem: params.mem,
      hashLen: 64, // 512 bits split into encryption + auth keys
      parallelism: params.parallelism,
      type: argon2.ArgonType.Argon2id
    });
    
    // Import as WebCrypto CryptoKey for AES-GCM
    this.encryptionKey = await crypto.subtle.importKey(
      'raw', encKeyBytes, 
      { name: 'AES-GCM', length: 256 },
      false, ['encrypt', 'decrypt']
    );
  }

  // AES-256-GCM encryption with random nonce
  async encrypt(data, options = {}) {
    const nonce = crypto.getRandomValues(new Uint8Array(12));
    const encrypted = await crypto.subtle.encrypt(
      { name: 'AES-GCM', iv: nonce, tagLength: 128 },
      this.encryptionKey,
      plaintextBytes
    );
    
    return { v: '2.0', alg: 'AES-256-GCM-ARGON2ID', nonce, ct: encrypted };
  }
}
```

### Key Features Summary

| Feature | Implementation |
|---------|----------------|
| **Client-Side Encryption** | AES-256-GCM with WebCrypto API |
| **Key Derivation** | Argon2id with adaptive parameters (OWASP 2024) |
| **Zero-Knowledge Auth** | Auth hash verification (password never sent) |
| **Hardware Acceleration** | WebCrypto API uses native crypto hardware |
| **Batch Operations** | Parallel encrypt/decrypt with Promise.all |
| **Secure Password Generator** | Crypto-random values with character requirements |
| **Compression** | Gzip for large payloads (10-50% reduction) |
| **Session Management** | Auto-lock with configurable timeout |
| **Secure Memory Clearing** | Keys wiped on lock/logout |
| **Legacy Support** | Backward compatible with v1 format |

### Encryption Package Format

```json
{
  "v": "2.0",
  "alg": "AES-256-GCM-ARGON2ID",
  "nonce": "base64-encoded-12-bytes",
  "ct": "base64-encoded-ciphertext-with-auth-tag",
  "compressed": true,
  "ts": 1699999999999
}
```

---

## âš¡ CRYSTALS-Kyber Optimizations

SecureVault includes an **optimized CRYSTALS-Kyber implementation** with NumPy-accelerated Number Theoretic Transform (NTT) for post-quantum cryptographic operations.

### NTT Optimization Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OPTIMIZED NTT PIPELINE (Kyber-768)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    PRECOMPUTATION PHASE (Startup)                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Twiddle Factors â”‚  â”‚ Inverse Factors â”‚  â”‚ Bit-Reversal Table  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  @lru_cache(1)  â”‚  â”‚  @lru_cache(1)  â”‚  â”‚  @lru_cache(1)      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    RUNTIME NTT OPERATIONS                            â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Input Polynomial â”€â”€â–º Bit-Reversal â”€â”€â–º Cooley-Tukey FFT â”€â”€â–º NTT     â”‚   â”‚
â”‚  â”‚       (n=256)         (Vectorized)    (NumPy Butterfly)    Domain   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  NTT Domain â”€â”€â–º Gentleman-Sande â”€â”€â–º Bit-Reversal â”€â”€â–º Output         â”‚   â”‚
â”‚  â”‚                  (Inverse NTT)       Ã— nâ»Â¹ mod q    Polynomial      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Performance Benchmarks

| Operation | Naive Implementation | Optimized NTT | Speedup |
|-----------|---------------------|---------------|---------|
| **Forward NTT** | ~0.8ms | ~0.1ms | **8x** |
| **Inverse NTT** | ~0.9ms | ~0.12ms | **7.5x** |
| **Key Generation** | ~2ms | ~0.3ms | **6-7x** |
| **Encryption** | ~1.5ms | ~0.2ms | **7-8x** |
| **Batch (100 ops)** | ~150ms | ~15ms | **10x** |

### Kyber Parameters

```python
# CRYSTALS-Kyber-768 NTT Parameters
KYBER_N = 256       # Polynomial degree
KYBER_Q = 3329      # Modulus
KYBER_ZETA = 17     # Primitive 256th root of unity mod q

# Optimizations:
# - Precomputed twiddle factors (forward & inverse)
# - NumPy vectorized butterfly operations
# - Cached bit-reversal permutation
# - Montgomery reduction for modular arithmetic
```

### Implementation Example

```python
# Backend (optimized_ntt.py)
from auth_module.services.optimized_ntt import OptimizedNTT

ntt = OptimizedNTT()

# Forward NTT (polynomial â†’ NTT domain)
ntt_form = ntt.forward_ntt(polynomial)

# Point-wise multiplication (O(n) in NTT domain vs O(nÂ²) naive)
product_ntt = ntt.multiply_ntt(a_ntt, b_ntt)

# Inverse NTT (NTT domain â†’ polynomial)
result = ntt.inverse_ntt(product_ntt)

# Performance metrics
metrics = ntt.get_metrics()
# {'forward_ntt_count': 1000, 'avg_forward_ntt_ms': 0.1, ...}
```

### Hybrid Caching System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KYBER CACHE ARCHITECTURE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   L1: Memory   â”‚   â”‚   L2: Redis    â”‚   â”‚  L3: Database  â”‚  â”‚
â”‚  â”‚    (LRU)       â”‚   â”‚  (Distributed) â”‚   â”‚  (PostgreSQL)  â”‚  â”‚
â”‚  â”‚   TTL: 5min    â”‚â”€â”€â–ºâ”‚   TTL: 1hr     â”‚â”€â”€â–ºâ”‚  Persistent    â”‚  â”‚
â”‚  â”‚   ~1000 keys   â”‚   â”‚   Shared       â”‚   â”‚   Backup       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  Cached Items:                                                  â”‚
â”‚  â€¢ Public keys (user_id â†’ public_key)                          â”‚
â”‚  â€¢ Session shared secrets (session_id â†’ shared_secret)         â”‚
â”‚  â€¢ Key validation results (key_hash â†’ is_valid)                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Fully Homomorphic Encryption (FHE)

SecureVault implements **Fully Homomorphic Encryption** to enable server-side computations on encrypted data without ever decrypting it.

### FHE Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FHE ARCHITECTURE                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           CLIENT (Browser)                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ TFHE-rs WASM    â”‚   â”‚ Key Management   â”‚   â”‚ Simulated FHE        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ (WebAssembly)   â”‚   â”‚ (IndexedDB)      â”‚   â”‚ (Fallback Mode)      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                 â”‚   â”‚                  â”‚   â”‚                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Key Gen       â”‚   â”‚ â€¢ Client Keys    â”‚   â”‚ â€¢ AES-GCM Encrypt    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Encrypt       â”‚   â”‚ â€¢ Public Keys    â”‚   â”‚ â€¢ Local Strength     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ ZK Proofs     â”‚   â”‚ â€¢ Server Keys    â”‚   â”‚ â€¢ Cache Results      â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚           â”‚                     â”‚                        â”‚              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚              â”‚                     â”‚                        â”‚                   â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                    â”‚                                            â”‚
â”‚                    HTTPS (Encrypted Ciphertext)                                â”‚
â”‚                                    â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        FHE OPERATION ROUTER                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚                    Intelligent Tier Selection                       â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   Budget        Operation        Data Size       Result             â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   Latency  â”€â”€â”€> Type      â”€â”€â”€>   & Complexity â”€â”€> Tier Selection    â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   Memory        Priority         Circuit Depth                      â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â”‚                     â”‚                    â”‚                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚   TIER 1: CLIENT     â”‚  â”‚ TIER 2: HYBRID â”‚  â”‚ TIER 3: FULL FHE â”‚        â”‚
â”‚    â”‚   (~5ms latency)     â”‚  â”‚ (~50ms latency)â”‚  â”‚ (~500ms latency) â”‚        â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚    â”‚ â€¢ Local computation  â”‚  â”‚â€¢ Concrete-Py   â”‚  â”‚ â€¢ TenSEAL SEAL   â”‚        â”‚
â”‚    â”‚ â€¢ No server needed   â”‚  â”‚â€¢ Simple ops    â”‚  â”‚ â€¢ Complex ops    â”‚        â”‚
â”‚    â”‚ â€¢ Instant response   â”‚  â”‚â€¢ Integer arith â”‚  â”‚ â€¢ Batch SIMD     â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                      â”‚                    â”‚                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                    â”‚                                                          â”‚
â”‚                    â–¼                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚                     REDIS FHE COMPUTATION CACHE                      â”‚  â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚    â”‚  â”‚  Operation Hash â”€â”€> Cached Result (TTL: 1 hour)                â”‚  â”‚  â”‚
â”‚    â”‚  â”‚  â€¢ Avoid redundant FHE computations                            â”‚  â”‚  â”‚
â”‚    â”‚  â”‚  â€¢ 10x performance improvement for repeated operations         â”‚  â”‚  â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FHE Encryption Tiers

| Tier | Name | Latency | Use Case | Technology |
|------|------|---------|----------|------------|
| 1 | Client Only | ~5ms | Real-time typing feedback | Local JS |
| 2 | Hybrid FHE | ~50ms | Password strength check | Concrete-Python |
| 3 | Full FHE | ~500ms | Encrypted search, batch ops | TenSEAL (SEAL) |
| 4 | Cached FHE | ~1ms | Repeated operations | Redis cache |

### FHE Password Strength Flow

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client (Browser)
    participant R as FHE Router
    participant F as FHE Service
    participant CA as Redis Cache

    U->>C: Type password
    
    Note over C: Client-side FHE encryption
    C->>C: Generate/load FHE keys from IndexedDB
    C->>C: Encrypt password with TFHE
    
    C->>R: POST /api/fhe/strength-check/
    Note right of C: {encrypted_password, budget, metadata}
    
    R->>CA: Check cache (operation hash)
    
    alt Cache Hit
        CA->>R: Return cached result
        R->>C: Encrypted strength score
    else Cache Miss
        R->>R: Evaluate computational budget
        R->>R: Select optimal tier
        
        alt Tier 2: Hybrid
            R->>F: Route to Concrete-Python
            F->>F: FHE strength computation
        else Tier 3: Full FHE
            R->>F: Route to TenSEAL
            F->>F: SIMD batch computation
        end
        
        F->>CA: Cache result
        F->>R: Return encrypted score
        R->>C: Encrypted strength score
    end
    
    C->>C: Decrypt result with client key
    C->>U: Display strength meter
    
    Note over C,F: Server NEVER sees plaintext password!
```

### FHE Key Management

```javascript
// Client-side FHE key generation (fheService.js)
async initialize() {
  // Load or generate TFHE keys
  const cachedKeys = await fheKeyManager.loadKeys();
  
  if (!cachedKeys) {
    // Generate new FHE keypair
    this.clientKey = await tfhe.TfheClientKey.generate();
    this.publicKey = await tfhe.TfhePublicKey.new(this.clientKey);
    this.serverKey = await tfhe.TfheCompressedServerKey.new(this.clientKey);
    
    // Cache in IndexedDB (encrypted with device key)
    await fheKeyManager.saveKeys({
      clientKey: this.clientKey,
      publicKey: this.publicKey,
      serverKey: this.serverKey,
      createdAt: Date.now(),
    });
  }
}
```

### FHE Integration with Vault

The vault model includes FHE-specific columns for encrypted operations:

```python
class EncryptedVaultItem(models.Model):
    # ... standard fields ...
    
    # FHE fields for server-side computation
    fhe_password = models.BinaryField(
        null=True,
        help_text="FHE encrypted password (SEAL CKKS ciphertext)"
    )
    encrypted_domain_hash = models.BinaryField(
        null=True,
        help_text="Encrypted domain hash for FHE search"
    )
    cached_strength_score = models.FloatField(
        null=True,
        help_text="Cached FHE-computed strength score"
    )
    fhe_last_computed = models.DateTimeField(
        null=True,
        help_text="Last FHE computation timestamp"
    )
```

---

## âš™ï¸ Backend Optimizations

SecureVault v2.0 includes comprehensive backend optimizations for performance and scalability.

### Optimization Components

| Component | File | Purpose |
|-----------|------|---------|
| **VaultCacheManager** | `vault_optimization_service.py` | Multi-level caching (L1 + L2) |
| **VaultQueryOptimizer** | `vault_optimization_service.py` | Query optimization with select_related |
| **VaultCompression** | `vault_optimization_service.py` | Gzip compression utilities |
| **AuthHashService** | `vault_optimization_service.py` | Zero-knowledge auth verification |
| **VaultCompressionMiddleware** | `compression_middleware.py` | Gzip/Brotli response compression |
| **Celery Tasks** | `vault/tasks.py` | Background processing |

### Multi-Level Caching

```python
# VaultCacheManager - L1 (Memory) + L2 (Redis/Django cache)
class VaultCacheManager:
    # Cache TTLs
    TTL_SALT = 300      # 5 minutes
    TTL_STATS = 60      # 1 minute
    TTL_FOLDERS = 300   # 5 minutes
    TTL_AUTH = 600      # 10 minutes
    
    # Cached (non-sensitive):
    # - User salt
    # - Item counts and statistics
    # - Folder structure
    # - Auth hash (double-hashed)
    
    # NOT cached (for security):
    # - Encrypted data blobs
    # - Authentication tokens
```

### Query Optimization

```python
# VaultQueryOptimizer - Optimized queries
def get_optimized_queryset(user, item_type=None, favorites_only=False):
    return EncryptedVaultItem.objects.filter(
        user=user,
        deleted=False
    ).select_related('folder')  # Reduces N+1 queries
     .only('id', 'item_id', 'item_type', ...)  # Selective fields
     .order_by('-updated_at')  # Uses index

def get_metadata_only_queryset(user):
    # Returns items WITHOUT encrypted_data for listing
    # Reduces payload size by ~90%
    return EncryptedVaultItem.objects.filter(
        user=user, deleted=False
    ).only('id', 'item_id', 'item_type', 'favorite', 
           'folder_id', 'created_at', 'updated_at')
```

### Response Compression Middleware

```python
# compression_middleware.py
class VaultCompressionMiddleware:
    MIN_SIZE_FOR_COMPRESSION = 1024  # Compress if > 1KB
    
    # Supports Brotli (better) and Gzip (fallback)
    # Automatically selects based on Accept-Encoding
    # Typical compression: 10-50% reduction
    
    COMPRESSIBLE_CONTENT_TYPES = [
        'application/json',
        'text/html',
        'text/plain',
        'application/javascript',
    ]
```

### Celery Background Tasks

| Task | Purpose | Schedule |
|------|---------|----------|
| `process_audit_log` | Async audit logging | On-demand |
| `warm_user_cache` | Pre-warm cache after login | On-demand |
| `invalidate_user_cache` | Clear cache on logout | On-demand |
| `cleanup_old_audit_logs` | Delete old logs | Daily 2 AM |
| `cleanup_deleted_items` | Purge soft-deleted items | Weekly Sunday 3 AM |
| `compute_user_statistics` | Generate vault stats | On-demand |
| `check_breach_status` | HIBP API check (k-anonymity) | Rate-limited |
| `prepare_export` | Prepare encrypted export | On-demand |

### Performance Improvements Summary

| Optimization | Before | After | Improvement |
|--------------|--------|-------|-------------|
| **Query Response** | ~200ms | ~20ms | **10x faster** |
| **API Payload Size** | 100KB | 55KB | **45% smaller** |
| **Cache Hit Rate** | 0% | ~85% | **Reduced DB load** |
| **List Items (metadata)** | ~500ms | ~50ms | **10x faster** |
| **Compression Ratio** | - | 10-50% | **Bandwidth savings** |

### Security Headers Middleware

```python
# SecurityHeadersMiddleware adds:
response['X-Content-Type-Options'] = 'nosniff'
response['X-Frame-Options'] = 'DENY'
response['X-XSS-Protection'] = '1; mode=block'
response['Referrer-Policy'] = 'strict-origin-when-cross-origin'
response['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains'
response['Permissions-Policy'] = 'geolocation=(), microphone=(), camera=()'
```

### Cache Control for Vault Endpoints

```python
# CacheControlMiddleware
NO_CACHE_PATHS = ['/api/vault/', '/api/auth/', '/api/kyber/']

# Sensitive endpoints get:
'Cache-Control': 'no-store, no-cache, must-revalidate, private'
'Pragma': 'no-cache'
'Expires': '0'

# Static files get:
'Cache-Control': 'public, max-age=31536000, immutable'
```

---

## ğŸ”‘ Authentication & Authorization

### Authentication Methods Supported

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AUTHENTICATION METHODS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   PASSWORD      â”‚      PASSKEY         â”‚         OAUTH 2.0          â”‚
â”‚   + MFA         â”‚    (WebAuthn)        â”‚       (Social Login)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Email + Pass  â”‚ â€¢ FIDO2 Compliant    â”‚ â€¢ Google                   â”‚
â”‚ â€¢ TOTP (6-dig)  â”‚ â€¢ Biometric          â”‚ â€¢ GitHub                   â”‚
â”‚ â€¢ SMS Code      â”‚ â€¢ Hardware Key       â”‚ â€¢ Apple                    â”‚
â”‚ â€¢ Email Code    â”‚ â€¢ Cross-Platform     â”‚ â€¢ Microsoft (coming)       â”‚
â”‚ â€¢ Push Notif    â”‚ â€¢ Passwordless       â”‚ â€¢ Auto-provision user      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### JWT Authentication Flow

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant A as Auth Server
    participant R as Resource Server

    U->>C: Login (email + password)
    C->>C: Hash password (Argon2id)
    C->>A: POST /api/auth/token/ {email, auth_hash}
    
    A->>A: Verify credentials
    A->>A: Check MFA requirement
    
    alt MFA Required
        A->>C: {requires_mfa: true, mfa_token}
        C->>U: Request MFA code
        U->>C: Enter TOTP code
        C->>A: POST /api/auth/mfa/verify/ {mfa_token, code}
        A->>A: Verify TOTP
    end
    
    A->>A: Generate JWT tokens
    A->>C: {access_token, refresh_token, expires_in}
    
    C->>C: Store tokens securely
    
    Note over C,R: Subsequent API Requests
    
    C->>R: GET /api/vault/items/ + Authorization: Bearer {access_token}
    R->>R: Verify JWT signature
    R->>R: Check token expiry
    R->>R: Extract user claims
    R->>C: Return protected resource
    
    Note over C,A: Token Refresh
    
    C->>A: POST /api/auth/token/refresh/ {refresh_token}
    A->>A: Verify refresh token
    A->>C: {access_token, expires_in}
```

### WebAuthn/Passkey Authentication Flow

```mermaid
sequenceDiagram
    participant U as User
    participant B as Browser
    participant S as Server
    participant A as Authenticator

    Note over U,A: Registration Flow
    
    U->>B: Click "Register Passkey"
    B->>S: POST /api/auth/passkey/register/begin/
    S->>S: Generate challenge
    S->>S: Create user handle
    S->>B: {challenge, rp, user, pubKeyCredParams}
    
    B->>A: navigator.credentials.create(options)
    A->>U: Biometric/PIN prompt
    U->>A: Verify identity
    A->>A: Generate key pair
    A->>B: PublicKeyCredential {id, rawId, attestationObject}
    
    B->>S: POST /api/auth/passkey/register/complete/
    S->>S: Verify attestation
    S->>S: Store public key + credential ID
    S->>B: {success: true, passkey_id}
    
    Note over U,A: Authentication Flow
    
    U->>B: Click "Login with Passkey"
    B->>S: POST /api/auth/passkey/authenticate/begin/
    S->>S: Generate challenge
    S->>B: {challenge, allowCredentials}
    
    B->>A: navigator.credentials.get(options)
    A->>U: Biometric/PIN prompt
    U->>A: Verify identity
    A->>A: Sign challenge with private key
    A->>B: PublicKeyCredential {authenticatorData, signature}
    
    B->>S: POST /api/auth/passkey/authenticate/complete/
    S->>S: Verify signature with stored public key
    S->>S: Generate JWT tokens
    S->>B: {access_token, refresh_token}
```

### Authorization (RBAC)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ROLE-BASED ACCESS CONTROL                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      ROLE       â”‚                  PERMISSIONS                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Owner          â”‚ Full control: create, read, update, delete,       â”‚
â”‚                 â”‚ share, manage members, transfer ownership         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Admin          â”‚ Manage: read, update, delete, share, add members  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Member         â”‚ Contribute: read, create, update own items        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Viewer         â”‚ Read-only: view items, no modifications           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Passkey Recovery System

SecureVault implements a **two-tier passkey recovery system** that balances security with usability.

### Recovery System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              USER LOSES PASSKEY                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  TRY PRIMARY    â”‚
              â”‚  RECOVERY       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> Has Recovery Key?
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
                       â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚             YES                        NO
                       â”‚              â”‚                         â”‚
                       â–¼              â”‚                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                         â”‚
          â”‚ Enter Recovery    â”‚<â”€â”€â”€â”€â”€â”€â”˜                         â”‚
          â”‚ Key & Decrypt     â”‚                                 â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
                    â”‚                                           â”‚
               Success?â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> NO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                  â”‚                                             â”‚
                 YES                                            â”‚
                  â”‚                                             â–¼
                  â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                  â”‚    FALLBACK TO SOCIAL MESH      â”‚
                  â”‚                  â”‚    (3-7 days verification)      â”‚
                  â”‚                  â”‚                                 â”‚
                  â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
                  â”‚                  â”‚  â”‚ Behavioral DNA Capture â”‚    â”‚
                  â”‚                  â”‚  â”‚ (247 dimensions)        â”‚    â”‚
                  â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                  â”‚                  â”‚              â”‚                  â”‚
                  â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
                  â”‚                  â”‚  â”‚ Temporal Challenges     â”‚    â”‚
                  â”‚                  â”‚  â”‚ (Distributed over days) â”‚    â”‚
                  â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                  â”‚                  â”‚              â”‚                  â”‚
                  â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
                  â”‚                  â”‚  â”‚ Guardian Approvals      â”‚    â”‚
                  â”‚                  â”‚  â”‚ (Threshold: 3 of 5)     â”‚    â”‚
                  â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                  â”‚                  â”‚              â”‚                  â”‚
                  â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
                  â”‚                  â”‚  â”‚ Trust Score â‰¥ 0.85      â”‚    â”‚
                  â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                  â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                                 â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚    PASSKEY      â”‚
                          â”‚    RESTORED     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Primary Recovery Flow (Instant)

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant S as Server
    participant K as KeyStore

    Note over U,K: Setup Phase (During Account Creation)
    
    U->>C: Register passkey
    C->>C: Generate passkey keypair
    C->>S: Store public key
    
    U->>C: Enable primary recovery
    S->>S: Generate 24-char recovery key
    S->>S: Hash recovery key (Argon2id)
    
    C->>C: Encrypt passkey private material
    C->>C: Key = KDF(recovery_key)
    
    C->>S: Store encrypted backup
    S->>K: {encrypted_passkey, key_hash, metadata}
    S->>C: Display recovery key (ONE TIME ONLY!)
    C->>U: "Write down your recovery key"
    
    Note over U,K: Recovery Phase
    
    U->>C: Lost passkey, initiate recovery
    C->>S: POST /api/auth/passkey-recovery/initiate/
    S->>S: Verify user identity (email)
    S->>C: {backup_exists: true, challenge}
    
    U->>C: Enter recovery key
    C->>S: POST /api/auth/passkey-recovery/complete/
    S->>S: Verify recovery key hash
    S->>K: Fetch encrypted backup
    K->>S: {encrypted_passkey_data}
    
    C->>C: Derive decryption key
    C->>C: Decrypt passkey material
    C->>C: Re-register passkey
    
    C->>S: Store new passkey credential
    S->>C: {success: true, new_passkey_id}
    C->>U: "Passkey restored!"
```

### Social Mesh Recovery Flow (Fallback)

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant S as Server
    participant G as Guardians
    participant B as Blockchain

    Note over U,B: Recovery Initiation
    
    U->>C: Initiate social mesh recovery
    C->>S: POST /api/behavioral-recovery/initiate/
    
    S->>S: Verify behavioral commitments exist
    S->>S: Create recovery attempt
    S->>B: Verify commitment on chain
    
    S->>C: {attempt_id, timeline, first_challenge}
    
    Note over U,B: Phase 1: Behavioral Verification (Days 1-3)
    
    loop Each Challenge (5 total)
        S->>C: Temporal challenge (randomized timing)
        C->>U: Display challenge
        
        Note over C: Capture behavioral biometrics
        C->>C: Keystroke dynamics
        C->>C: Mouse movement patterns
        C->>C: Cognitive patterns
        
        U->>C: Submit answer
        C->>S: {answer, behavioral_data}
        
        S->>S: Verify answer
        S->>S: Analyze behavioral match
        S->>S: Update trust score
    end
    
    Note over U,B: Phase 2: Guardian Verification (Days 3-7)
    
    S->>G: Send approval requests
    
    par Guardian 1
        G->>S: Approve + verification
    and Guardian 2
        G->>S: Approve + video call
    and Guardian 3
        G->>S: Approve
    end
    
    S->>S: Check threshold (3 of 5)
    
    Note over U,B: Phase 3: Secret Reconstruction
    
    S->>S: Calculate final trust score
    
    alt Trust Score â‰¥ 0.85
        S->>S: Collect recovery shards (Shamir SSS)
        S->>S: Reconstruct passkey secret
        S->>C: Return decrypted passkey material
        C->>C: Re-register passkey
        C->>U: "Passkey restored!"
    else Trust Score < 0.85
        S->>C: Recovery denied
        S->>S: Log security event
        S->>U: Alert: suspicious recovery attempt
    end
```

### Behavioral DNA Capture (247 Dimensions)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BEHAVIORAL DNA VECTORS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  TYPING DYNAMICS (60 dimensions)                                    â”‚
â”‚  â”œâ”€â”€ Key press duration (down-up time)                              â”‚
â”‚  â”œâ”€â”€ Inter-key latency (key-to-key timing)                          â”‚
â”‚  â”œâ”€â”€ Typing rhythm and cadence patterns                             â”‚
â”‚  â”œâ”€â”€ Error correction patterns                                      â”‚
â”‚  â”œâ”€â”€ Shift key usage timing                                         â”‚
â”‚  â”œâ”€â”€ Backspace frequency and timing                                 â”‚
â”‚  â””â”€â”€ Caps lock vs shift preference                                  â”‚
â”‚                                                                      â”‚
â”‚  MOUSE BIOMETRICS (50 dimensions)                                   â”‚
â”‚  â”œâ”€â”€ Velocity curves and acceleration                               â”‚
â”‚  â”œâ”€â”€ Movement trajectory characteristics                            â”‚
â”‚  â”œâ”€â”€ Click timing patterns                                          â”‚
â”‚  â”œâ”€â”€ Scroll wheel behavior                                          â”‚
â”‚  â”œâ”€â”€ Hover-before-click duration                                    â”‚
â”‚  â”œâ”€â”€ Mouse jitter patterns (micro-movements)                        â”‚
â”‚  â””â”€â”€ Directional preference (diagonal vs cardinal)                  â”‚
â”‚                                                                      â”‚
â”‚  COGNITIVE PATTERNS (45 dimensions)                                 â”‚
â”‚  â”œâ”€â”€ Decision-making speed                                          â”‚
â”‚  â”œâ”€â”€ UI navigation sequences                                        â”‚
â”‚  â”œâ”€â”€ Feature usage frequency                                        â”‚
â”‚  â”œâ”€â”€ Time-of-day activity patterns                                  â”‚
â”‚  â”œâ”€â”€ Session duration preferences                                   â”‚
â”‚  â””â”€â”€ Multi-tasking behavior                                         â”‚
â”‚                                                                      â”‚
â”‚  DEVICE INTERACTION (50 dimensions)                                 â”‚
â”‚  â”œâ”€â”€ Screen interaction patterns                                    â”‚
â”‚  â”œâ”€â”€ Swipe velocity and curve                                       â”‚
â”‚  â”œâ”€â”€ Device orientation preferences                                 â”‚
â”‚  â”œâ”€â”€ App switching patterns                                         â”‚
â”‚  â””â”€â”€ Notification interaction timing                                â”‚
â”‚                                                                      â”‚
â”‚  SEMANTIC BEHAVIORS (42 dimensions)                                 â”‚
â”‚  â”œâ”€â”€ Password creation patterns                                     â”‚
â”‚  â”œâ”€â”€ Vault organization methodology                                 â”‚
â”‚  â”œâ”€â”€ Search query formulation style                                 â”‚
â”‚  â”œâ”€â”€ Entry editing patterns                                         â”‚
â”‚  â””â”€â”€ Copy-paste behavior                                            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”“ Master Password Recovery

### Recovery Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               MASTER PASSWORD RECOVERY SYSTEM                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  RECOVERY KEY   â”‚          â”‚     EMERGENCY ACCESS            â”‚  â”‚
â”‚   â”‚  (Primary)      â”‚          â”‚     (Trusted Contacts)          â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ â€¢ 24-char key   â”‚          â”‚ â€¢ Designated trustees           â”‚  â”‚
â”‚   â”‚ â€¢ User-stored   â”‚          â”‚ â€¢ Waiting period (24-72h)       â”‚  â”‚
â”‚   â”‚ â€¢ Instant       â”‚          â”‚ â€¢ Owner can cancel              â”‚  â”‚
â”‚   â”‚ â€¢ One-time use  â”‚          â”‚ â€¢ Audit trail                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚            â”‚                                    â”‚                    â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                             â”‚                                        â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                    â”‚  VAULT ACCESS   â”‚                              â”‚
â”‚                    â”‚  RESTORED       â”‚                              â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Recovery Key Flow

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant S as Server
    participant V as Vault

    Note over U,V: Setup Phase
    
    U->>C: Enable recovery key
    C->>C: Generate recovery key (256-bit)
    C->>C: Derive vault key from master password
    C->>C: Re-encrypt vault key with recovery key
    
    C->>S: Store encrypted vault key backup
    S->>V: {user_id, encrypted_vault_key, recovery_key_hash}
    
    C->>U: Display recovery key (SAVE THIS!)
    
    Note over U,V: Recovery Phase
    
    U->>C: Forgot master password
    C->>S: POST /api/auth/validate-recovery-key/
    S->>S: Verify email ownership
    S->>C: {recovery_enabled: true}
    
    U->>C: Enter recovery key
    C->>S: POST /api/auth/reset-with-recovery-key/
    S->>S: Verify recovery key hash
    S->>V: Fetch encrypted vault key
    V->>S: {encrypted_vault_key}
    S->>C: Return encrypted vault key
    
    C->>C: Decrypt vault key with recovery key
    
    U->>C: Enter new master password
    C->>C: Re-encrypt vault key with new password
    C->>S: Update encrypted vault key
    
    C->>U: "Password reset successful!"
```

### Emergency Access Flow

```mermaid
sequenceDiagram
    participant O as Owner
    participant T as Trusted Contact
    participant S as Server
    participant V as Vault

    Note over O,V: Setup Phase
    
    O->>S: Add emergency contact
    S->>T: Send invitation email
    T->>S: Accept invitation
    S->>S: Store emergency contact relationship
    
    Note over O,V: Emergency Access Request
    
    T->>S: Request emergency access
    S->>S: Start waiting period timer
    S->>O: Send notification (email + push)
    
    Note over O,V: Waiting Period (24-72 hours)
    
    alt Owner Cancels
        O->>S: Cancel emergency access
        S->>T: Access denied notification
    else Waiting Period Expires
        S->>S: Auto-approve access
        S->>T: Access granted notification
        
        T->>S: GET /api/user/emergency-vault/{request_id}/
        S->>S: Verify access grant
        S->>V: Fetch vault items (read-only)
        V->>S: {encrypted_items}
        S->>T: Return vault data
        
        Note over T: Limited time access (24h default)
    end
```

---

## ğŸ”Œ API Documentation

### API Base URLs

```
Development:  http://localhost:8000/api/
Production:   https://api.securevault.com/api/
WebSocket:    wss://api.securevault.com/ws/
```

### Complete API Structure

```
/api/
â”œâ”€â”€ auth/                              # Authentication (25+ endpoints)
â”‚   â”œâ”€â”€ POST   register/               # User registration
â”‚   â”œâ”€â”€ POST   login/                  # User login
â”‚   â”œâ”€â”€ POST   logout/                 # User logout
â”‚   â”œâ”€â”€ token/
â”‚   â”‚   â”œâ”€â”€ POST   /                   # Obtain JWT tokens
â”‚   â”‚   â”œâ”€â”€ POST   refresh/            # Refresh access token
â”‚   â”‚   â””â”€â”€ POST   verify/             # Verify token validity
â”‚   â”œâ”€â”€ passkey/
â”‚   â”‚   â”œâ”€â”€ POST   register/begin/     # Start passkey registration
â”‚   â”‚   â”œâ”€â”€ POST   register/complete/  # Complete passkey registration
â”‚   â”‚   â”œâ”€â”€ POST   authenticate/begin/ # Start passkey auth
â”‚   â”‚   â””â”€â”€ POST   authenticate/complete/
â”‚   â”œâ”€â”€ passkeys/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # List user's passkeys
â”‚   â”‚   â”œâ”€â”€ DELETE {id}/               # Delete passkey
â”‚   â”‚   â”œâ”€â”€ PUT    {id}/rename/        # Rename passkey
â”‚   â”‚   â””â”€â”€ GET    status/             # Passkey status
â”‚   â”œâ”€â”€ oauth/
â”‚   â”‚   â”œâ”€â”€ GET    providers/          # List OAuth providers
â”‚   â”‚   â”œâ”€â”€ POST   google/             # Google OAuth
â”‚   â”‚   â”œâ”€â”€ POST   github/             # GitHub OAuth
â”‚   â”‚   â””â”€â”€ POST   apple/              # Apple OAuth
â”‚   â”œâ”€â”€ oidc/                          # OpenID Connect (Enterprise SSO) â­
â”‚   â”‚   â”œâ”€â”€ GET    .well-known/openid-configuration  # OIDC Discovery
â”‚   â”‚   â”œâ”€â”€ GET    .well-known/jwks.json             # JSON Web Key Set
â”‚   â”‚   â”œâ”€â”€ GET    providers/          # List OIDC providers (Okta/Azure/Auth0)
â”‚   â”‚   â”œâ”€â”€ POST   authorize/          # Initiate OIDC auth flow
â”‚   â”‚   â”œâ”€â”€ GET    callback/           # Handle OIDC callback
â”‚   â”‚   â”œâ”€â”€ POST   token/              # Exchange code for tokens
â”‚   â”‚   â”œâ”€â”€ GET    userinfo/           # Get authenticated user info
â”‚   â”‚   â””â”€â”€ POST   validate-token/     # Validate ID token
â”‚   â”œâ”€â”€ mfa/
â”‚   â”‚   â”œâ”€â”€ POST   biometric/face/register/
â”‚   â”‚   â”œâ”€â”€ POST   biometric/voice/register/
â”‚   â”‚   â”œâ”€â”€ POST   biometric/authenticate/
â”‚   â”‚   â”œâ”€â”€ POST   assess-risk/        # Adaptive MFA
â”‚   â”‚   â”œâ”€â”€ GET    factors/            # Available MFA factors
â”‚   â”‚   â””â”€â”€ POST   verify/             # Verify MFA code
â”‚   â”œâ”€â”€ passkey-recovery/
â”‚   â”‚   â”œâ”€â”€ POST   setup/              # Setup primary recovery
â”‚   â”‚   â”œâ”€â”€ GET    backups/            # List recovery backups
â”‚   â”‚   â”œâ”€â”€ POST   initiate/           # Start recovery
â”‚   â”‚   â”œâ”€â”€ POST   complete/           # Complete recovery
â”‚   â”‚   â””â”€â”€ GET    status/             # Recovery status
â”‚   â”œâ”€â”€ POST   setup-recovery-key/     # Setup master password recovery
â”‚   â”œâ”€â”€ POST   validate-recovery-key/  # Validate recovery key
â”‚   â””â”€â”€ POST   reset-with-recovery-key/# Reset password
â”‚
â”œâ”€â”€ vault/                             # Vault Management (20+ endpoints)
â”‚   â”œâ”€â”€ items/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # List items (?metadata_only=true)
â”‚   â”‚   â”œâ”€â”€ POST   /                   # Create item (encrypted blob)
â”‚   â”‚   â”œâ”€â”€ GET    {id}/               # Get item
â”‚   â”‚   â”œâ”€â”€ PUT    {id}/               # Update item (encrypted blob)
â”‚   â”‚   â””â”€â”€ DELETE {id}/               # Delete item
â”‚   â”œâ”€â”€ GET    get_salt/               # Get user's salt for key derivation â­
â”‚   â”œâ”€â”€ POST   verify_auth/            # Zero-knowledge auth hash verification â­
â”‚   â”œâ”€â”€ GET    statistics/             # Cached vault statistics â­
â”‚   â”œâ”€â”€ POST   sync/                   # Cross-device sync
â”‚   â”œâ”€â”€ GET    search/                 # Search vault
â”‚   â”œâ”€â”€ folders/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # List folders
â”‚   â”‚   â”œâ”€â”€ POST   /                   # Create folder
â”‚   â”‚   â”œâ”€â”€ PUT    {id}/               # Update folder
â”‚   â”‚   â””â”€â”€ DELETE {id}/               # Delete folder
â”‚   â”œâ”€â”€ backups/
â”‚   â”‚   â”œâ”€â”€ POST   create_backup/      # Create backup
â”‚   â”‚   â””â”€â”€ POST   restore_backup/{id}/# Restore backup
â”‚   â””â”€â”€ shared-folders/                # Shared folder endpoints
â”‚
â”œâ”€â”€ security/                          # Security Features (12+ endpoints)
â”‚   â”œâ”€â”€ GET    dashboard/              # Security dashboard
â”‚   â”œâ”€â”€ GET    score/                  # Security score
â”‚   â”œâ”€â”€ devices/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # List devices
â”‚   â”‚   â”œâ”€â”€ GET    {id}/               # Device details
â”‚   â”‚   â”œâ”€â”€ POST   {id}/trust/         # Trust device
â”‚   â”‚   â””â”€â”€ POST   {id}/untrust/       # Untrust device
â”‚   â”œâ”€â”€ dark-web/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # Breach monitoring
â”‚   â”‚   â””â”€â”€ POST   scan/               # Manual scan
â”‚   â”œâ”€â”€ social-accounts/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # List accounts
â”‚   â”‚   â”œâ”€â”€ POST   {id}/lock/          # Lock account
â”‚   â”‚   â””â”€â”€ POST   {id}/unlock/        # Unlock account
â”‚   â”œâ”€â”€ GET    health-check/           # Security health
â”‚   â””â”€â”€ GET    audit-log/              # Audit log
â”‚
â”œâ”€â”€ user/                              # User Management (10+ endpoints)
â”‚   â”œâ”€â”€ GET    profile/                # Get profile
â”‚   â”œâ”€â”€ PUT    profile/                # Update profile
â”‚   â”œâ”€â”€ GET    preferences/            # Get preferences
â”‚   â”œâ”€â”€ PUT    preferences/            # Update preferences
â”‚   â”œâ”€â”€ GET    emergency-access/       # Emergency access settings
â”‚   â”œâ”€â”€ emergency-contacts/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # List contacts
â”‚   â”‚   â”œâ”€â”€ POST   /                   # Add contact
â”‚   â”‚   â”œâ”€â”€ PUT    {id}/               # Update contact
â”‚   â”‚   â””â”€â”€ DELETE /                   # Remove contact
â”‚   â”œâ”€â”€ POST   emergency-request/      # Request emergency access
â”‚   â””â”€â”€ GET    emergency-vault/{id}/   # Access emergency vault
â”‚
â”œâ”€â”€ ml-security/                       # ML Security (10 endpoints) â­
â”‚   â”œâ”€â”€ password-strength/
â”‚   â”‚   â”œâ”€â”€ POST   predict/            # Predict strength (LSTM)
â”‚   â”‚   â”œâ”€â”€ POST   predict-fhe/        # FHE encrypted strength check
â”‚   â”‚   â””â”€â”€ GET    history/            # Prediction history
â”‚   â”œâ”€â”€ anomaly/
â”‚   â”‚   â””â”€â”€ POST   detect/             # Detect anomaly (Isolation Forest)
â”‚   â”œâ”€â”€ behavior/
â”‚   â”‚   â”œâ”€â”€ GET    profile/            # Get behavior profile
â”‚   â”‚   â””â”€â”€ PUT    profile/update/     # Update profile
â”‚   â”œâ”€â”€ threat/
â”‚   â”‚   â”œâ”€â”€ POST   analyze/            # Analyze threat (CNN-LSTM)
â”‚   â”‚   â””â”€â”€ GET    history/            # Threat history
â”‚   â”œâ”€â”€ POST   session/analyze/        # Batch session analysis
â”‚   â””â”€â”€ GET    models/info/            # ML model info
â”‚
â”œâ”€â”€ performance/                       # Performance Monitoring (16 endpoints)
â”‚   â”œâ”€â”€ GET    summary/                # Performance summary
â”‚   â”œâ”€â”€ GET    system-health/          # System health
â”‚   â”œâ”€â”€ GET    endpoints/              # Endpoint performance
â”‚   â”œâ”€â”€ GET    database/               # Database performance
â”‚   â”œâ”€â”€ GET    errors/                 # Error summary
â”‚   â”œâ”€â”€ alerts/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # List alerts
â”‚   â”‚   â”œâ”€â”€ POST   {id}/acknowledge/   # Acknowledge alert
â”‚   â”‚   â””â”€â”€ POST   {id}/resolve/       # Resolve alert
â”‚   â”œâ”€â”€ GET    dependencies/           # Dependencies status
â”‚   â”œâ”€â”€ GET    ml-predictions/         # ML predictions
â”‚   â”œâ”€â”€ POST   optimize/               # Optimize performance
â”‚   â”œâ”€â”€ POST   frontend/               # Frontend report
â”‚   â””â”€â”€ crypto/
â”‚       â”œâ”€â”€ POST   generate-key/       # Generate encryption key
â”‚       â”œâ”€â”€ POST   derive-key/         # Derive key
â”‚       â”œâ”€â”€ POST   test/               # Test encryption
â”‚       â””â”€â”€ GET    info/               # Crypto info
â”‚
â”œâ”€â”€ behavioral-recovery/               # Behavioral Recovery (12 endpoints)
â”‚   â”œâ”€â”€ POST   initiate/               # Initiate recovery
â”‚   â”œâ”€â”€ GET    status/{id}/            # Recovery status
â”‚   â”œâ”€â”€ POST   submit-challenge/       # Submit challenge answer
â”‚   â”œâ”€â”€ POST   complete/               # Complete recovery
â”‚   â”œâ”€â”€ POST   setup-commitments/      # Setup behavioral commitments
â”‚   â”œâ”€â”€ GET    commitments/status/     # Commitment status
â”‚   â”œâ”€â”€ GET    challenges/{id}/next/   # Get next challenge
â”‚   â”œâ”€â”€ metrics/
â”‚   â”‚   â”œâ”€â”€ GET    dashboard/          # Metrics dashboard
â”‚   â”‚   â””â”€â”€ GET    summary/            # Metrics summary
â”‚   â”œâ”€â”€ POST   feedback/               # Submit feedback
â”‚   â””â”€â”€ ab-tests/
â”‚       â”œâ”€â”€ GET    {name}/results/     # A/B test results
â”‚       â””â”€â”€ POST   create/             # Create experiments
â”‚
â”œâ”€â”€ blockchain/                        # Blockchain Integration (4 endpoints)
â”‚   â”œâ”€â”€ GET    verify-commitment/{id}/ # Verify commitment on chain
â”‚   â”œâ”€â”€ GET    anchor-status/          # Anchoring status
â”‚   â”œâ”€â”€ POST   trigger-anchor/         # Manual anchor (admin)
â”‚   â””â”€â”€ GET    user-commitments/       # User's commitments
â”‚
â”œâ”€â”€ kyber/                             # CRYSTALS-Kyber API (6 endpoints) â­
â”‚   â”œâ”€â”€ POST   keypair/                # Generate Kyber keypair (async)
â”‚   â”œâ”€â”€ POST   encrypt/                # Hybrid Kyber encryption
â”‚   â”œâ”€â”€ POST   decrypt/                # Hybrid Kyber decryption
â”‚   â”œâ”€â”€ POST   batch/                  # Batch encryption operations
â”‚   â”œâ”€â”€ GET    status/                 # Kyber algorithm status
â”‚   â””â”€â”€ GET    metrics/                # NTT performance metrics
â”‚
â”œâ”€â”€ fhe/                               # FHE Operations (8 endpoints) â­
â”‚   â”œâ”€â”€ POST   encrypt/                # Encrypt data with FHE
â”‚   â”œâ”€â”€ POST   strength-check/         # FHE password strength check
â”‚   â”œâ”€â”€ POST   batch-strength/         # Batch strength evaluation
â”‚   â”œâ”€â”€ POST   search/                 # Encrypted search
â”‚   â”œâ”€â”€ keys/
â”‚   â”‚   â”œâ”€â”€ POST   generate/           # Generate FHE keys
â”‚   â”‚   â””â”€â”€ GET    /                   # Get user's FHE keys
â”‚   â”œâ”€â”€ GET    status/                 # FHE service status
â”‚   â””â”€â”€ GET    metrics/                # FHE operation metrics
â”‚
â”œâ”€â”€ analytics/                         # Analytics (3 endpoints)
â”‚   â”œâ”€â”€ POST   events/                 # Track events
â”‚   â”œâ”€â”€ GET    dashboard/              # Analytics dashboard
â”‚   â””â”€â”€ GET    journey/                # User journey
â”‚
â”œâ”€â”€ ab-testing/                        # A/B Testing (5 endpoints)
â”‚   â”œâ”€â”€ GET    /                       # Get experiments & flags
â”‚   â”œâ”€â”€ POST   metrics/                # Track metric
â”‚   â”œâ”€â”€ GET    experiments/{name}/results/
â”‚   â””â”€â”€ user/
â”‚       â”œâ”€â”€ GET    experiments/        # User experiments
â”‚       â””â”€â”€ GET    flags/              # User feature flags
â”‚
â”œâ”€â”€ email-masking/                     # Email Masking (7 endpoints)
â”‚   â”œâ”€â”€ aliases/
â”‚   â”‚   â”œâ”€â”€ GET    /                   # List aliases
â”‚   â”‚   â”œâ”€â”€ POST   create/             # Create alias
â”‚   â”‚   â”œâ”€â”€ GET    {id}/               # Alias detail
â”‚   â”‚   â”œâ”€â”€ POST   {id}/toggle/        # Toggle alias
â”‚   â”‚   â””â”€â”€ GET    {id}/activity/      # Alias activity
â”‚   â””â”€â”€ providers/
â”‚       â”œâ”€â”€ GET    /                   # List providers
â”‚       â””â”€â”€ POST   configure/          # Configure provider
â”‚
â””â”€â”€ health/                            # Health Checks (3 endpoints)
    â”œâ”€â”€ GET    /                       # Health check
    â”œâ”€â”€ GET    /api/health/            # API health (Docker/K8s)
    â””â”€â”€ GET    /ready/                 # Readiness check

WebSocket Endpoints:
â””â”€â”€ /ws/breach-alerts/{user_id}/       # Real-time breach alerts
```

### Authentication Header

```http
Authorization: Bearer <access_token>
```

### Example API Requests

```bash
# Get JWT Token
curl -X POST http://localhost:8000/api/auth/token/ \
  -H "Content-Type: application/json" \
  -d '{"email": "user@example.com", "password": "secure_password"}'

# List Vault Items
curl http://localhost:8000/api/vault/items/ \
  -H "Authorization: Bearer <token>"

# Predict Password Strength
curl -X POST http://localhost:8000/api/ml-security/password-strength/predict/ \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"password": "MyP@ssw0rd123!"}'

# FHE Encrypted Strength Check (password never sent in plaintext)
curl -X POST http://localhost:8000/api/fhe/strength-check/ \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "encrypted_password": "<base64_fhe_ciphertext>",
    "password_length": 14,
    "budget": {"max_latency_ms": 1000, "min_accuracy": 0.9}
  }'

# Get FHE Service Status
curl http://localhost:8000/api/fhe/status/ \
  -H "Authorization: Bearer <token>"

# Zero-Knowledge Auth Verification
curl -X POST http://localhost:8000/api/vault/verify_auth/ \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"auth_hash": "<client-generated-argon2id-hash>"}'

# Get Vault Items (metadata only - faster)
curl http://localhost:8000/api/vault/?metadata_only=true \
  -H "Authorization: Bearer <token>"

# Generate Kyber Keypair
curl -X POST http://localhost:8000/api/kyber/keypair/ \
  -H "Authorization: Bearer <token>"

# Get Kyber Performance Metrics
curl http://localhost:8000/api/kyber/metrics/ \
  -H "Authorization: Bearer <token>"
```

---

## ğŸš€ Deployment

### Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRODUCTION DEPLOYMENT                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   GitHub    â”‚â”€â”€â”€>â”‚  GitHub     â”‚â”€â”€â”€>â”‚   Container Registry    â”‚  â”‚
â”‚  â”‚   Push      â”‚    â”‚  Actions    â”‚    â”‚   (ghcr.io)             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚                â”‚
â”‚                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                           â”‚                                          â”‚
â”‚                           â–¼                                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚         â”‚         KUBERNETES CLUSTER              â”‚                 â”‚
â”‚         â”‚                                         â”‚                 â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                 â”‚
â”‚         â”‚  â”‚           INGRESS                 â”‚  â”‚                 â”‚
â”‚         â”‚  â”‚   (nginx-ingress + cert-manager)  â”‚  â”‚                 â”‚
â”‚         â”‚  â”‚   SSL/TLS Termination             â”‚  â”‚                 â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                 â”‚
â”‚         â”‚                â”‚                        â”‚                 â”‚
â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚                 â”‚
â”‚         â”‚    â”‚           â”‚           â”‚           â”‚                 â”‚
â”‚         â”‚    â–¼           â–¼           â–¼           â”‚                 â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                 â”‚
â”‚         â”‚  â”‚Frontâ”‚   â”‚Backendâ”‚   â”‚WebSocketâ”‚     â”‚                 â”‚
â”‚         â”‚  â”‚ end â”‚   â”‚  API  â”‚   â”‚(Daphne)â”‚     â”‚                 â”‚
â”‚         â”‚  â”‚ x3  â”‚   â”‚  x4   â”‚   â”‚   x2   â”‚     â”‚                 â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                 â”‚
â”‚         â”‚                â”‚                       â”‚                 â”‚
â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                 â”‚
â”‚         â”‚    â”‚           â”‚           â”‚          â”‚                 â”‚
â”‚         â”‚    â–¼           â–¼           â–¼          â”‚                 â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                 â”‚
â”‚         â”‚  â”‚Celeryâ”‚   â”‚ Redis â”‚   â”‚Postgresâ”‚    â”‚                 â”‚
â”‚         â”‚  â”‚Workerâ”‚   â”‚ x1    â”‚   â”‚  x1    â”‚    â”‚                 â”‚
â”‚         â”‚  â”‚ x2  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                 â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”˜                              â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Docker Deployment

#### Full Stack Deployment (All Services)

```bash
# Production deployment (all services)
cd docker
cp env.example .env
# Edit .env with production values

# Start all services
docker-compose up -d

# View logs
docker-compose logs -f

# Scale services
docker-compose up -d --scale backend=4 --scale celery-worker=2
```

#### Backend-Only Deployment (Django API)

```bash
# Build backend image
docker build -t password-manager-backend:latest \
  -f docker/backend/Dockerfile .

# Run backend container
docker run -d \
  --name pm-backend \
  -p 8000:8000 \
  -e DEBUG=False \
  -e SECRET_KEY=your-secure-secret-key \
  -e DATABASE_URL=postgresql://user:pass@db-host:5432/dbname \
  -e REDIS_URL=redis://:password@redis-host:6379/0 \
  -e ALLOWED_HOSTS=api.yourdomain.com \
  -e CORS_ALLOWED_ORIGINS=https://yourdomain.com \
  -e OIDC_RP_CLIENT_ID=your-oidc-client-id \
  -e OIDC_RP_CLIENT_SECRET=your-oidc-secret \
  -e OIDC_OP_BASE_URL=https://accounts.google.com \
  password-manager-backend:latest

# Run WebSocket server (Daphne)
docker run -d \
  --name pm-websocket \
  -p 8001:8001 \
  -e DEBUG=False \
  -e SECRET_KEY=your-secure-secret-key \
  -e DATABASE_URL=postgresql://user:pass@db-host:5432/dbname \
  -e REDIS_URL=redis://:password@redis-host:6379/0 \
  password-manager-backend:latest \
  daphne -b 0.0.0.0 -p 8001 password_manager.asgi:application

# Run Celery worker
docker run -d \
  --name pm-celery-worker \
  -e DEBUG=False \
  -e SECRET_KEY=your-secure-secret-key \
  -e DATABASE_URL=postgresql://user:pass@db-host:5432/dbname \
  -e CELERY_BROKER_URL=redis://:password@redis-host:6379/0 \
  password-manager-backend:latest \
  celery -A password_manager worker -l info

# Health check
curl http://localhost:8000/api/health/
```

#### Frontend-Only Deployment (React + Nginx)

```bash
# Build frontend image (production)
docker build -t password-manager-frontend:latest \
  -f docker/frontend/Dockerfile \
  --build-arg VITE_API_BASE_URL=https://api.yourdomain.com \
  --build-arg VITE_WS_URL=wss://ws.yourdomain.com \
  --build-arg VITE_OIDC_ENABLED=true \
  .

# Run frontend container
docker run -d \
  --name pm-frontend \
  -p 80:80 \
  password-manager-frontend:latest

# For development (with hot reload)
docker build -t password-manager-frontend-dev:latest \
  -f docker/frontend/Dockerfile.dev .

docker run -d \
  --name pm-frontend-dev \
  -p 5173:5173 \
  -v $(pwd)/frontend/src:/app/src \
  -e VITE_API_URL=http://localhost:8000 \
  password-manager-frontend-dev:latest

# Health check
curl http://localhost/health
```

#### Docker Compose (Separate Profiles)

```yaml
# docker-compose.yml with profiles
version: '3.8'

services:
  # Backend profile
  backend:
    profiles: ["backend", "full"]
    build:
      context: .
      dockerfile: docker/backend/Dockerfile
    ports:
      - "8000:8000"
    environment:
      - OIDC_RP_CLIENT_ID=${OIDC_RP_CLIENT_ID}
      - OIDC_OP_BASE_URL=${OIDC_OP_BASE_URL}
    # ... other config

  # Frontend profile
  frontend:
    profiles: ["frontend", "full"]
    build:
      context: .
      dockerfile: docker/frontend/Dockerfile
    ports:
      - "80:80"
    # ... other config

# Usage:
# docker-compose --profile backend up -d    # Backend only
# docker-compose --profile frontend up -d   # Frontend only
# docker-compose --profile full up -d       # All services
```

#### Environment Variables for OIDC

```bash
# Required OIDC Configuration (add to .env)
OIDC_RP_CLIENT_ID=your-client-id           # From your IdP (Okta/Azure AD/Auth0)
OIDC_RP_CLIENT_SECRET=your-client-secret   # Keep secret!
OIDC_OP_BASE_URL=https://accounts.google.com  # OpenID Provider URL
OIDC_VERIFY_SSL=True                       # Always True in production
OIDC_USE_NONCE=True                        # Replay attack protection

# For Azure AD:
# OIDC_OP_BASE_URL=https://login.microsoftonline.com/{tenant-id}/v2.0

# For Okta:
# OIDC_OP_BASE_URL=https://{your-org}.okta.com

# For Auth0:
# OIDC_OP_BASE_URL=https://{your-tenant}.auth0.com
```

### FHE Configuration

```bash
# Environment variables for FHE (docker/env.example)
FHE_ENABLED=true                    # Enable/disable FHE operations
FHE_DEFAULT_TIER=hybrid             # Default tier: client_only, hybrid, full_fhe
FHE_MAX_LATENCY_MS=1000            # Max latency for FHE operations
FHE_CACHE_TTL=3600                 # Redis cache TTL for FHE results
VITE_FHE_ENABLED=true              # Frontend FHE toggle
```

### Kubernetes Deployment

```bash
# Create namespace
kubectl apply -f k8s/namespace.yaml

# Create secrets (edit secrets.yaml first!)
kubectl apply -f k8s/secrets.yaml

# Deploy all services
kubectl apply -f k8s/configmap.yaml
kubectl apply -f k8s/deployment.yaml
kubectl apply -f k8s/ingress.yaml
kubectl apply -f k8s/hpa.yaml

# Check status
kubectl get pods -n password-manager
kubectl get services -n password-manager
```

### CI/CD Pipeline

The GitHub Actions workflow (`.github/workflows/ci.yml`) includes:

1. **Testing Stage**
   - Backend tests (pytest + coverage)
   - Frontend tests (vitest)
   - Linting (flake8, ESLint)
   - Security scanning (bandit, safety)

2. **Build Stage**
   - Multi-arch Docker images (amd64, arm64)
   - Push to GitHub Container Registry

3. **Deploy Stage**
   - Staging deployment (automatic on develop branch)
   - Production deployment (manual approval)
   - Rollback capability

4. **Notifications**
   - Slack notifications on success/failure

---

## ğŸ“„ File Descriptions

### Backend Files (`password_manager/`)

| File | Description |
|------|-------------|
| `password_manager/settings.py` | Django settings (901 lines) - security configs, CORS, JWT, channels |
| `password_manager/urls.py` | Root URL routing - all API endpoints registered |
| `password_manager/asgi.py` | ASGI config for WebSocket support (Channels) |
| `password_manager/wsgi.py` | WSGI config for Gunicorn |
| `password_manager/throttling.py` | Rate limiting configurations |
| `password_manager/api_utils.py` | Standardized API response utilities |
| `auth_module/views.py` | Core auth endpoints (1403 lines) - register, login, logout |
| `auth_module/passkey_views.py` | WebAuthn/Passkey (587 lines) - FIDO2 implementation |
| `auth_module/mfa_views.py` | Multi-factor auth (790 lines) - TOTP, biometric, push |
| `auth_module/oauth_views.py` | OAuth 2.0 (427 lines) - Google, GitHub, Apple |
| `auth_module/oidc_views.py` | OpenID Connect (OIDC) - Enterprise SSO (Okta, Azure AD, Auth0) â­ |
| `auth_module/services/oidc_service.py` | OIDC service - Discovery, JWKS, Token validation â­ |
| `auth_module/passkey_primary_recovery_views.py` | Primary recovery (637 lines) |
| `auth_module/quantum_recovery_views.py` | Quantum recovery (1104 lines) - Social mesh |
| `auth_module/quantum_recovery_models.py` | Recovery models (536 lines) |
| `auth_module/quantum_recovery_tasks.py` | Celery tasks (476 lines) |
| `auth_module/services/quantum_crypto_service.py` | Post-quantum crypto service |
| `auth_module/services/kyber_crypto.py` | Kyber-768 implementation |
| `auth_module/services/optimized_ntt.py` | NumPy-optimized NTT (6-8x faster) - Cooley-Tukey FFT |
| `auth_module/services/parallel_kyber.py` | Parallel Kyber ops with ThreadPoolExecutor |
| `auth_module/services/kyber_cache.py` | Hybrid caching (L1 Memory + L2 Redis + L3 DB) |
| `auth_module/services/kyber_monitor.py` | Performance monitoring for Kyber operations |
| `auth_module/kyber_views.py` | Async Django API views for Kyber endpoints |
| `auth_module/services/passkey_primary_recovery_service.py` | Recovery key service |
| `auth_module/services/challenge_generator.py` | Temporal challenge generator |
| `auth_module/services/trust_scorer.py` | Trust scoring algorithm |
| `vault/views/crud_views.py` | Vault CRUD operations |
| `vault/views/api_views.py` | API views with metadata_only, verify_auth, statistics |
| `vault/services/vault_optimization_service.py` | VaultCacheManager, QueryOptimizer, AuthHashService |
| `vault/tasks.py` | Celery tasks (audit, cache, breach check, export) |
| `vault/views/backup_views.py` | Backup & restore functionality |
| `vault/views/folder_views.py` | Folder management |
| `vault/views/shared_folder_views.py` | Shared folders with RBAC |
| `security/views.py` | Security dashboard, device management |
| `security/api/darkWebEndpoints.py` | Dark web monitoring endpoints |
| `security/api/account_protection.py` | Social account protection |
| `ml_security/views.py` | ML security endpoints |
| `ml_security/ml_models/password_strength_model.py` | LSTM password strength |
| `ml_security/ml_models/anomaly_detector.py` | Isolation Forest anomaly detection |
| `ml_security/ml_models/threat_analyzer.py` | CNN-LSTM threat analysis |
| `ml_dark_web/ml_services.py` | BERT breach detection |
| `ml_dark_web/routing.py` | WebSocket routing for breach alerts |
| `behavioral_recovery/views.py` | Behavioral recovery endpoints (726 lines) |
| `behavioral_recovery/models.py` | Behavioral commitment models |
| `behavioral_recovery/services/recovery_orchestrator.py` | Recovery flow orchestration |
| `blockchain/views.py` | Blockchain anchoring endpoints (390 lines) |
| `blockchain/services/blockchain_anchor_service.py` | Merkle tree & Web3 integration |
| `fhe_service/views.py` | FHE API endpoints (663 lines) - encrypt, strength check, search |
| `fhe_service/models.py` | FHE models (287 lines) - keystore, cache, operation logs |
| `fhe_service/services/concrete_service.py` | Concrete-Python FHE operations |
| `fhe_service/services/seal_service.py` | TenSEAL batch SIMD operations |
| `fhe_service/services/fhe_router.py` | Intelligent tier routing (client/hybrid/full FHE) |
| `fhe_service/services/fhe_cache.py` | Redis-based FHE computation cache |
| `fhe_service/services/adaptive_manager.py` | Adaptive circuit depth management |
| `shared/performance_views.py` | Performance monitoring (426 lines) |
| `shared/performance_middleware.py` | Request timing middleware |
| `shared/crypto/` | Server-side cryptographic utilities |
| `analytics/views.py` | Event tracking & analytics |
| `ab_testing/views.py` | A/B testing experiments |
| `email_masking/views.py` | Email alias management |
| `user/views.py` | User profile & emergency access (586 lines) |
| `api/health.py` | Health check endpoints for Docker/K8s |
| `middleware.py` | Security middleware (CORS, headers) |
| `password_manager/compression_middleware.py` | VaultCompressionMiddleware (Gzip/Brotli), SecurityHeadersMiddleware |
| `requirements.txt` | Python dependencies (115+ packages) |

### Frontend Files (`frontend/src/`)

| File | Description |
|------|-------------|
| `App.jsx` | Main React application (1149 lines) - routing, providers |
| `App.css` | Global styles (638 lines) - themes, animations |
| `index.css` | Base CSS (59 lines) - CSS variables |
| `main.jsx` | React entry point (65 lines) |
| `services/api.js` | API client with JWT handling (209 lines) |
| `services/cryptoService.js` | Client-side AES-GCM encryption (454 lines) |
| `services/secureVaultCrypto.js` | **NEW** WebCrypto API encryption (717 lines) - Argon2id, AES-256-GCM |
| `services/secureVaultService.js` | **NEW** Zero-knowledge vault operations (709 lines) |
| `services/xchachaEncryption.js` | XChaCha20-Poly1305 encryption (413 lines) |
| `services/eccService.js` | ECC operations (367 lines) |
| `services/quantum/kyberService.js` | Kyber-768 + X25519 hybrid (1232 lines) |
| `services/quantum/index.js` | Quantum crypto exports |
| `services/fhe/fheService.js` | FHE client service (681 lines) - WASM TFHE, key gen, encryption |
| `services/fhe/fheKeys.js` | FHE key management (604 lines) - IndexedDB storage, rotation |
| `services/fhe/index.js` | FHE module exports |
| `services/vaultService.js` | Vault operations (438 lines) |
| `services/mfaService.js` | MFA client service (583 lines) |
| `services/oauthService.js` | OAuth client (235 lines) |
| `services/oidcService.js` | OpenID Connect service - Enterprise SSO (Okta, Azure AD, Auth0) â­ |
| `services/mlSecurityService.js` | ML security client (369 lines) |
| `services/darkWebService.js` | Dark web monitoring client (115 lines) |
| `services/analyticsService.js` | Analytics tracking (734 lines) |
| `services/abTestingService.js` | A/B testing client (639 lines) |
| `services/preferencesService.js` | User preferences (809 lines) |
| `services/performanceMonitor.js` | Frontend performance (528 lines) |
| `services/errorTracker.js` | Error tracking (475 lines) |
| `services/SecureBehavioralStorage.js` | Encrypted IndexedDB storage (373 lines) |
| `services/behavioralCapture/BehavioralCaptureEngine.js` | 247-dim behavioral capture |
| `services/blockchain/` | Web3 blockchain integration |
| `ml/behavioralDNA/index.js` | Behavioral DNA model exports |
| `ml/behavioralDNA/HybridModel.js` | Client/server behavioral switcher |
| `ml/behavioralDNA/BackendAPI.js` | Backend behavioral API client |
| `contexts/BehavioralContext.jsx` | Behavioral profile management |
| `hooks/useAuth.jsx` | Authentication hook |
| `hooks/useSecureVault.js` | **NEW** React hook for vault operations (466 lines) |
| `hooks/useKyber.js` | React hook for Kyber WASM/Web Worker integration |
| `utils/kyber-wasm-loader.js` | Kyber WebAssembly lazy loader |
| `utils/kyber-cache.js` | IndexedDB cache for Kyber keys |
| `workers/kyber-worker.js` | Web Worker for background Kyber ops |
| `Components/auth/Login.jsx` | Login component (174 lines) |
| `Components/auth/PasskeyAuth.jsx` | Passkey authentication (308 lines) |
| `Components/auth/PasskeyRegistration.jsx` | Passkey setup (179 lines) |
| `Components/auth/BiometricAuth.jsx` | Biometric auth (413 lines) |
| `Components/auth/BiometricSetup.jsx` | Biometric enrollment (437 lines) |
| `Components/auth/TwoFactorSetup.jsx` | 2FA configuration (417 lines) |
| `Components/auth/RecoveryKeySetup.jsx` | Recovery key setup (434 lines) |
| `Components/auth/PasswordRecovery.jsx` | Password recovery (636 lines) |
| `Components/auth/PasskeyPrimaryRecoverySetup.jsx` | Primary recovery setup (451 lines) |
| `Components/auth/PasskeyPrimaryRecoveryInitiate.jsx` | Recovery initiation (517 lines) |
| `Components/auth/QuantumRecoverySetup.jsx` | Quantum recovery UI (696 lines) |
| `Components/auth/OAuthCallback.jsx` | OAuth callback handler (334 lines) |
| `Components/auth/SocialLoginButtons.jsx` | Social login UI (98 lines) |
| `Components/sharedfolders/SharedFoldersDashboard.jsx` | Shared folders UI (376 lines) |
| `Components/sharedfolders/CreateFolderModal.jsx` | Create folder modal (368 lines) |
| `Components/sharedfolders/FolderDetailsModal.jsx` | Folder details (590 lines) |
| `Components/sharedfolders/InvitationsModal.jsx` | Invitation management (427 lines) |
| `Components/animations/ParticleBackground.jsx` | Particle animations |

### Mobile App Files (`mobile/`)

| File | Description |
|------|-------------|
| `App.js` | React Native entry point (43 lines) |
| `app.json` | Expo configuration (42 lines) |
| `package.json` | Mobile dependencies (58 packages) |
| `src/` | Mobile source code directory |
| `components/` | Reusable mobile components |
| `app/` | Expo Router app directory |
| `hooks/` | Custom React Native hooks |
| `constants/` | App constants and themes |
| `assets/` | Images, fonts, icons |

### Desktop App Files (`desktop/`)

| File | Description |
|------|-------------|
| `main.js` | Electron main process (557 lines) - window management, IPC |
| `package.json` | Desktop dependencies (78 lines) |
| `src/` | Desktop source code |
| `assets/` | Desktop icons and resources |

### Browser Extension Files (`browser-extension/`)

| File | Description |
|------|-------------|
| `manifest.json` | Extension manifest v3 (46 lines) |
| `webpack.config.js` | Build configuration (54 lines) |
| `package.json` | Extension dependencies (32 lines) |
| `src/` | Extension source code |
| `icons/` | Extension icons (16x16 to 128x128) |

### Smart Contract Files (`contracts/`)

| File | Description |
|------|-------------|
| `contracts/BehavioralCommitmentAnchor.sol` | Solidity contract for Merkle anchoring |
| `hardhat.config.js` | Hardhat configuration (48 lines) - Arbitrum Sepolia |
| `scripts/deploy.js` | Contract deployment script |
| `test/` | Contract test suite |
| `package.json` | Contract dependencies (23 lines) |

### DevOps Files (`docker/`, `k8s/`, `.github/`)

| File | Description |
|------|-------------|
| `docker/backend/Dockerfile` | Backend multi-stage build (115 lines) |
| `docker/backend/entrypoint.sh` | Container entrypoint with migrations |
| `docker/frontend/Dockerfile` | Frontend Nginx image (96 lines) |
| `docker/frontend/Dockerfile.dev` | Development image (27 lines) |
| `docker/frontend/nginx.conf` | Frontend Nginx configuration |
| `docker/frontend/entrypoint.sh` | Runtime env injection |
| `docker/nginx/nginx.conf` | Main reverse proxy config |
| `docker/docker-compose.yml` | Production stack (354 lines) |
| `docker/docker-compose.dev.yml` | Development stack (105 lines) |
| `docker/env.example` | Environment template (92 lines) |
| `k8s/namespace.yaml` | Kubernetes namespace (12 lines) |
| `k8s/configmap.yaml` | Application configuration (49 lines) |
| `k8s/secrets.yaml` | Sensitive credentials (57 lines) |
| `k8s/deployment.yaml` | All deployments (697 lines) |
| `k8s/ingress.yaml` | Ingress with SSL & WebSocket (178 lines) |
| `k8s/hpa.yaml` | Horizontal pod autoscalers (132 lines) |
| `.github/workflows/ci.yml` | CI/CD pipeline (536 lines) |

### Test Files (`tests/`)

| File | Description |
|------|-------------|
| `run_all_tests.py` | Test runner script (440 lines) |
| `fixtures.py` | Test fixtures (634 lines) |
| `utils.py` | Test utilities (665 lines) |
| `test_ml_apis.py` | ML API tests (232 lines) |
| `manual_security_tests.py` | Security tests (742 lines) |
| `behavioral_recovery/` | Behavioral recovery tests |
| `functional/` | Functional test suite |
| `fhe_service/test_concrete_service.py` | Concrete-Python FHE tests (287 lines) |
| `fhe_service/test_seal_service.py` | TenSEAL batch operations tests (375 lines) |
| `fhe_service/test_fhe_router.py` | FHE router tests (323 lines) |
| `fhe_service/test_fhe_cache.py` | Redis FHE cache tests (397 lines) |
| `fhe_service/benchmarks.py` | FHE performance benchmarks (355 lines) |
| `TESTING_GUIDE.md` | Testing documentation (873 lines) |
| `MANUAL_TESTING_GUIDE.md` | Manual test procedures (702 lines) |

### Utility Scripts (`scripts/`)

| File | Description |
|------|-------------|
| `setup_ml_training.bat` | Windows ML setup (78 lines) |
| `setup_ml_training.sh` | Linux/Mac ML setup (77 lines) |
| `setup_behavioral_recovery.bat` | Windows recovery setup |
| `setup_behavioral_recovery.sh` | Linux/Mac recovery setup |

---

## ğŸ“Š Implementation Summary (v2.3)

### Client-Side Encryption (Frontend)

| File | Features |
|------|----------|
| `secureVaultCrypto.js` | WebCrypto API for AES-256-GCM, Argon2id with adaptive parameters, hardware acceleration, secure memory clearing, batch operations, password generator |
| `secureVaultService.js` | Zero-knowledge vault ops, client-side encryption before API calls, local decryption cache with TTL, session management with auto-lock, import/export |
| `useSecureVault.js` | React hook for vault operations, state management, activity tracking for timeout, lazy decryption support |

### Backend Optimization (Django)

| File | Features |
|------|----------|
| `vault_optimization_service.py` | VaultCacheManager (L1 + L2), VaultQueryOptimizer (select_related), VaultCompression (Gzip), AuthHashService (zero-knowledge) |
| `vault/tasks.py` | Celery tasks: audit log processing, cache warming/cleanup, statistics computation, breach checking (HIBP API), export preparation |
| `vault/views/api_views.py` | `/verify_auth/` endpoint for zero-knowledge auth, `/statistics/` endpoint for cached vault stats |

### Compression & Caching

| File | Features |
|------|----------|
| `compression_middleware.py` | VaultCompressionMiddleware (Gzip/Brotli 10-50% reduction), SecurityHeadersMiddleware (CSP, HSTS), CacheControlMiddleware |
| `settings.py` | Compression middleware, Celery Beat schedule for vault maintenance, Redis cache backend |

### CRYSTALS-Kyber Optimizations

| File | Features |
|------|----------|
| `optimized_ntt.py` | NumPy-vectorized NTT (6-8x speedup), precomputed twiddle factors, Cooley-Tukey FFT, benchmark utilities |
| `parallel_kyber.py` | ThreadPoolExecutor for batch operations, async wrappers |
| `kyber_cache.py` | Hybrid caching (L1 Memory + L2 Redis + L3 DB), public key caching, session shared secrets |

### Performance Metrics

| Metric | Improvement |
|--------|-------------|
| NTT Transform | ~8x faster |
| Key Generation | ~6-7x faster |
| Encryption | ~7-8x faster |
| Batch Operations | ~10x faster |
| API Response | ~10x faster (with caching) |
| Payload Size | 45% smaller (compression) |
| Cache Hit Rate | ~85% |

---

## âš™ï¸ Backend Runtime Notes (Django & ML Security)

- **Timezone-aware metrics**: All performance and analytics timestamps now use Django's `timezone.now()`, eliminating naive-datetime warnings when `USE_TZ = True`.
- **Performance monitoring**: `shared/performance_middleware.py` records request and API metrics and may emit `SLOW REQUEST` warnings for genuinely slow endpoints.
- **ML warm-up**: The ML security module (`ml_security`) pre-loads and warms up core models at startup, so the very first call may log a slow request, but subsequent `/api/ml-security/...` requests should be much faster.

## ğŸ¤ Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details.

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit changes (`git commit -m 'Add amazing feature'`)
4. Push to branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## ğŸ“œ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ™ Acknowledgments

- [NIST](https://www.nist.gov/) for post-quantum cryptography standards
- [W3C WebAuthn](https://www.w3.org/TR/webauthn/) for passwordless authentication spec
- [Django](https://www.djangoproject.com/) and [React](https://reactjs.org/) communities
- All open-source contributors

---

<div align="center">

**Built with â¤ï¸ for a more secure digital world**

[Report Bug](https://github.com/yourusername/Password_manager/issues) â€¢ [Request Feature](https://github.com/yourusername/Password_manager/issues) â€¢ [Documentation](https://docs.securevault.com)

</div>
